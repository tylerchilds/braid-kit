/*
 focus-trap 7.0.0
 @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
 tabbable 6.0.1
 @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/
(()=>{function nk(e,h){if(h=h(e))e.innerHTML=h}function ok(e,h){Ff("create",e,a=>{a=nk.bind(null,a.target,h);Gf[e]=a;a()})}function pk(e,h){e=`
		<style type="text/css" data-module=${e}>
			${h.replaceAll("&",e)}
		</style>
	`;document.body.insertAdjacentHTML("beforeend",e)}function qk(e){return Hf.get(e)||{}}function If(e,h,a=(b,c)=>({...b,...c})){Hf.set(e,h,a)}function rk(e,h,a,b){Ff(h,`${e} ${a}`,b)}function Jf(e,h={}){If(e,h);return{selector:e,read:qk.bind(null,e),render:ok.bind(null,e),style:pk.bind(null,e),on:rk.bind(null,e),write:If.bind(null,e)}}function Ff(e,h,a=()=>null){const b=c=>{c.target&&c.target.matches&&c.target.matches(h)&&a.call(null,c)};document.addEventListener(e,b,!0);sk.includes(e)&&tk(h);return function(){if("create"===
e){const c=cb.indexOf(h);0<=c&&(cb=[...cb.slice(0,c),...cb.slice(c+1)])}document.removeEventListener(e,b,!0)}}function tk(e){cb=[...(new Set([...cb,e]))];Kf([...document.querySelectorAll(e)])}function Kf(e){e.filter(h=>!h.reactive).forEach(uk)}function vk({target:e}){return 0<cb.length?[...e.querySelectorAll(cb.join(", "))]:[]}function uk(e){e.id||(e.id=wk());e.dispatchEvent(new Event("create"));e.reactive=!0}function wk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const h=
16*Math.random()|0;return("x"==e?h:h&3|8).toString(16)})}function Lf(e,h){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);h&&(b=b.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable}));a.push.apply(a,b)}return a}function Mf(e){for(var h=1;h<arguments.length;h++){var a=null!=arguments[h]?arguments[h]:{};h%2?Lf(Object(a),!0).forEach(function(b){var c=a[b];b in e?Object.defineProperty(e,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):
e[b]=c}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Lf(Object(a)).forEach(function(b){Object.defineProperty(e,b,Object.getOwnPropertyDescriptor(a,b))})}return e}function xk(e){return()=>{e.classList.add("is-active");e.querySelector('[name="filter"]').focus()}}function yk(e){return()=>{e.classList.remove("is-active");Na.write({filter:""})}}function zk(e){let h=-1;for(let a of e)h+=a.length+1;return h}function Vb(e,h,a=0,b=1E9){for(let c=0,d=0,f=
!0;d<e.length&&c<=b;d++){let g=e[d],k=c+g.length;k>=a&&(k>b&&(g=g.slice(0,b-c)),c<a&&(g=g.slice(a-c)),f?(h[h.length-1]+=g,f=!1):h.push(g));c=k+1}return h}function Nf(e){return 127462<=e&&127487>=e}function ya(e,h,a=!0,b=!0){return(a?Of:Ak)(e,h,b)}function Of(e,h,a){if(h==e.length)return h;var b;if(b=h)b=e.charCodeAt(h),b=56320<=b&&57344>b;b&&(b=e.charCodeAt(h-1),b=55296<=b&&56320>b);b&&h--;b=ma(e,h);for(h+=Fa(b);h<e.length;){var c=ma(e,h),d;if(!(d=8205==b||8205==c)&&(d=a))a:{for(d=1;d<pb.length;d+=
2)if(pb[d]>c){d=pb[d-1]<=c;break a}d=!1}if(d)h+=Fa(c),b=c;else if(Nf(c)){c=0;for(d=h-2;0<=d&&Nf(ma(e,d));)c++,d-=2;if(0==c%2)break;else h+=2}else break}return h}function Ak(e,h,a){for(;0<h;){let b=Of(e,h-2,a);if(b<h)return b;h--}return 0}function ma(e,h){let a=e.charCodeAt(h);if(!(55296<=a&&56320>a)||h+1==e.length)return a;e=e.charCodeAt(h+1);return 56320<=e&&57344>e?(a-55296<<10)+(e-56320)+65536:a}function Kd(e){if(65535>=e)return String.fromCharCode(e);e-=65536;return String.fromCharCode((e>>10)+
55296,(e&1023)+56320)}function Fa(e){return 65536>e?1:2}function sa(e,h,a,b=!1){if(!(0==h&&0>=a)){var c=e.length-2;0<=c&&0>=a&&a==e[c+1]?e[c]+=h:0==h&&0==e[c]?e[c+1]+=a:b?(e[c]+=h,e[c+1]+=a):e.push(h,a)}}function qb(e,h,a){if(0!=a.length)if(h=h.length-2>>1,h<e.length)e[e.length-1]=e[e.length-1].append(a);else{for(;e.length<h;)e.push(V.empty);e.push(a)}}function Ld(e,h,a){let b=e.inserted;for(let c=0,d=0,f=0;f<e.sections.length;){let g=e.sections[f++],k=e.sections[f++];if(0>k)c+=g,d+=g;else{let l=
c,m=d,n=V.empty;for(;;){l+=g;m+=k;k&&b&&(n=n.append(b[f-2>>1]));if(a||f==e.sections.length||0>e.sections[f+1])break;g=e.sections[f++];k=e.sections[f++]}h(c,l,d,m,n);c=l;d=m}}}function Md(e,h,a,b=!1){let c=[];b=b?[]:null;e=new Wb(e);h=new Wb(h);for(let f=0,g=0;;)if(-1==e.ins)f+=e.len,e.next();else if(-1==h.ins&&g<f){var d=Math.min(h.len,f-g);h.forward(d);sa(c,d,-1);g+=d}else if(0<=h.ins&&(e.done||g<f||g==f&&(h.len<e.len||h.len==e.len&&!a))){for(sa(c,h.ins,-1);f>g&&!e.done&&f+e.len<g+h.len;)f+=e.len,
e.next();g+=h.len;h.next()}else if(0<=e.ins){d=0;let k=f+e.len;for(;;)if(0<=h.ins&&g>f&&g+h.len<k)d+=h.ins,g+=h.len,h.next();else if(-1==h.ins&&g<k){let l=Math.min(h.len,k-g);d+=l;h.forward(l);g+=l}else break;sa(c,d,e.ins);b&&qb(b,c,e.text);f=k;e.next()}else{if(e.done&&h.done)return b?ia.createSet(c,b):Va.create(c);throw Error("Mismatched change set lengths");}}function Pf(e,h,a=!1){let b=[];a=a?[]:null;e=new Wb(e);h=new Wb(h);for(let c=!1;;){if(e.done&&h.done)return a?ia.createSet(b,a):Va.create(b);
if(0==e.ins)sa(b,e.len,0,c),e.next();else if(0!=h.len||h.done){if(e.done||h.done)throw Error("Mismatched change set lengths");let d=Math.min(e.len2,h.len),f=b.length;if(-1==e.ins){let g=-1==h.ins?-1:h.off?0:h.ins;sa(b,d,g,c);a&&g&&qb(a,b,h.text)}else-1==h.ins?(sa(b,e.off?0:e.len,d,c),a&&qb(a,b,e.textBit(d))):(sa(b,e.off?0:e.len,h.off?0:h.ins,c),a&&!h.off&&qb(a,b,h.text));c=(e.ins>d||0<=h.ins&&h.len>d)&&(c||b.length>f);e.forward2(d);h.forward(d)}else sa(b,0,h.ins,c),a&&qb(a,b,h.text),h.next()}}function Qf(e,
h){for(let a of e.ranges)if(a.to>h)throw new RangeError("Selection points outside of document");}function Nd(e,h){return e==h||e.length==h.length&&e.every((a,b)=>a===h[b])}function Rf(e,h,a){if(e.length!=h.length)return!1;for(let b=0;b<e.length;b++)if(!a(e[b],h[b]))return!1;return!0}function Od(e,h){let a=!1;for(let b of h)Xb(e,b)&1&&(a=!0);return a}function Bk(e,h,a){function b(k){let l=[];for(let m=0;m<c.length;m++){let n=Bc(k,c[m]);if(2==d[m])for(let p of n)l.push(p);else l.push(n)}return h.combine(l)}
let c=a.map(k=>e[k.id]),d=a.map(k=>k.type),f=c.filter(k=>!(k&1)),g=e[h.id]>>1;return{create(k){for(let l of c)Xb(k,l);k.values[g]=b(k);return 1},update(k,l){if(!Od(k,f))return 0;l=b(k);if(h.compare(l,k.values[g]))return 0;k.values[g]=l;return 1},reconfigure(k,l){var m=Od(k,c);let n=l.config.facets[h.id];l=l.facet(h);if(n&&!m&&Nd(a,n))return k.values[g]=l,0;m=b(k);if(h.compare(m,l))return k.values[g]=l,0;k.values[g]=m;return 1}}}function Yb(e){return h=>new Sf(h,e)}function Ck(e,h,a){function b(f,
g){var k=d.get(f);if(null!=k){if(k<=g)return;let l=c[k].indexOf(f);-1<l&&c[k].splice(l,1);f instanceof Pd&&a.delete(f.compartment)}d.set(f,g);if(Array.isArray(f))for(let l of f)b(l,g);else if(f instanceof Pd){if(a.has(f.compartment))throw new RangeError("Duplicate use of compartment in extensions");k=h.get(f.compartment)||f.inner;a.set(f.compartment,k);b(k,g)}else if(f instanceof Sf)b(f.inner,f.prec);else if(f instanceof na)c[g].push(f),f.provides&&b(f.provides,g);else if(f instanceof Cc)c[g].push(f),
f.facet.extensions&&b(f.facet.extensions,g);else{k=f.extension;if(!k)throw Error(`Unrecognized extension value in extension set (${f}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);b(k,g)}}let c=[[],[],[],[],[]],d=new Map;b(e,Db.default);return c.reduce((f,g)=>f.concat(g))}function Xb(e,h){if(h&1)return 2;h>>=1;var a=e.status[h];if(4==a)throw Error("Cyclic dependency between fields and/or facets");if(a&2)return a;e.status[h]=4;a=
e.computeSlot(e,e.config.dynamicSlots[h]);return e.status[h]=2|a}function Bc(e,h){return h&1?e.config.staticValues[h>>1]:e.values[h>>1]}function Tf(e,h,a){var b;let c,d;a?(a=h.changes,c=ia.empty(h.changes.length),d=e.changes.compose(h.changes)):(a=h.changes.map(e.changes),c=e.changes.mapDesc(h.changes,!0),d=e.changes.compose(a));return{changes:d,selection:h.selection?h.selection.map(c):null===(b=e.selection)||void 0===b?void 0:b.map(a),effects:K.mapEffects(e.effects,a).concat(K.mapEffects(h.effects,
c)),annotations:e.annotations.length?e.annotations.concat(h.annotations):h.annotations,scrollIntoView:e.scrollIntoView||h.scrollIntoView}}function Qd(e,h,a){let b=h.selection,c=Eb(h.annotations);h.userEvent&&(c=c.concat(ja.userEvent.of(h.userEvent)));return{changes:h.changes instanceof ia?h.changes:ia.of(h.changes||[],a,e.facet(Uf)),selection:b&&(b instanceof u?b:u.single(b.anchor,b.head)),effects:Eb(h.effects),annotations:c,scrollIntoView:!!h.scrollIntoView}}function Vf(e,h,a){var b=Qd(e,h.length?
h[0]:{},e.doc.length);h.length&&!1===h[0].filter&&(a=!1);for(var c=1;c<h.length;c++){!1===h[c].filter&&(a=!1);var d=!!h[c].sequential;b=Tf(b,Qd(e,h[c],d?b.changes.newLength:e.doc.length),d)}e=ja.create(e,b.changes,b.selection,b.effects,b.annotations,b.scrollIntoView);if(a){a=e.startState;h=!0;for(f of a.facet(Wf)){b=f(e);if(!1===b){h=!1;break}if(Array.isArray(b))if(!0===h)h=b;else a:{c=[];for(let g=0,k=0;;){let l;if(g<h.length&&(k==b.length||b[k]>=h[g]))d=h[g++],l=h[g++];else if(k<b.length)d=b[k++],
l=b[k++];else{h=c;break a}!c.length||c[c.length-1]<d?c.push(d,l):c[c.length-1]<l&&(c[c.length-1]=l)}}}if(!0!==h){if(!1===h){h=e.changes.invertedDesc;var f=ia.empty(a.doc.length)}else h=e.changes.filter(h),f=h.changes,h=h.filtered.invertedDesc;e=ja.create(a,f,e.selection&&e.selection.map(h),K.mapEffects(e.effects,h),e.annotations,e.scrollIntoView)}f=a.facet(Xf);for(h=f.length-1;0<=h;h--)e=f[h](e),e=e instanceof ja?e:Array.isArray(e)&&1==e.length&&e[0]instanceof ja?e[0]:Vf(a,Eb(e),!1);f=e}else f=e;
a=f.startState;e=a.facet(Yf);h=f;for(b=e.length-1;0<=b;b--)(c=e[b](f))&&Object.keys(c).length&&(h=Tf(f,Qd(a,c,f.changes.newLength),!0));return h==f?f:ja.create(a,f.changes,f.selection,h.effects,h.annotations,h.scrollIntoView)}function Eb(e){return null==e?Dk:Array.isArray(e)?e:[e]}function Ek(e){return h=>{if(!/\S/.test(h))return va.Space;a:if(Zf)var a=Zf.test(h);else{for(a=0;a<h.length;a++){let b=h[a];if(/\w/.test(b)||"\u0080"<b&&(b.toUpperCase()!=b.toLowerCase()||Fk.test(b))){a=!0;break a}}a=!1}if(a)return va.Word;
for(a=0;a<e.length;a++)if(-1<h.indexOf(e[a]))return va.Word;return va.Other}}function Wa(e,h,a={}){let b={};for(let c of e)for(let d of Object.keys(c)){e=c[d];let f=b[d];if(void 0===f)b[d]=e;else if(f!==e&&void 0!==e)if(Object.hasOwnProperty.call(a,d))b[d]=a[d](f,e);else throw Error("Config merge conflict for field "+d);}for(let c in h)void 0===b[c]&&(b[c]=h[c]);return b}function Rd(e,h){return e.from-h.from||e.value.startSide-h.value.startSide}function Gk(e){if(1<e.length)for(let h=e[0],a=1;a<e.length;a++){let b=
e[a];if(0<Rd(h,b))return e.slice().sort(Rd);h=b}return e}function $f(e,h,a){let b=new Map;for(var c of e)for(e=0;e<c.chunk.length;e++)0>=c.chunk[e].maxPoint&&b.set(c.chunk[e],c.chunkPos[e]);c=new Set;for(let d of h)for(h=0;h<d.chunk.length;h++)e=b.get(d.chunk[h]),null==e||(a?a.mapPos(e):e)!=d.chunkPos[h]||(null===a||void 0===a?0:a.touchesRange(e,e+d.chunk[h].length))||c.add(d.chunk[h]);return c}function Sd(e,h){for(let a=e[h];;){let b=(h<<1)+1;if(b>=e.length)break;let c=e[b];b+1<e.length&&0<=c.compare(e[b+
1])&&(c=e[b+1],b++);if(0>a.compare(c))break;e[b]=a;e[h]=c;h=b}}function ag(e,h,a,b,c,d){e.goto(h);a.goto(b);c=b+c;let f=b;for(h=b-h;;){b=e.to+h-a.to||e.endSide-a.endSide;let g=0>b?e.to+h:a.to,k=Math.min(g,c);e.point||a.point?e.point&&a.point&&(e.point==a.point||e.point.eq(a.point))&&Td(e.activeForPoint(e.to+h),a.activeForPoint(a.to))||d.comparePoint(f,k,e.point,a.point):k>f&&!Td(e.active,a.active)&&d.compareRange(f,k,e.active,a.active);if(g>c)break;f=g;0>=b&&e.next();0<=b&&a.next()}}function Td(e,
h){if(e.length!=h.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!=h[a]&&!e[a].eq(h[a]))return!1;return!0}function Dc(e,h){for(let a=h,b=e.length-1;a<b;a++)e[a]=e[a+1];e.pop()}function Ec(e,h,a){for(let b=e.length-1;b>=h;b--)e[b+1]=e[b];e[h]=a}function bg(e,h){let a=-1,b=1E9;for(let c=0;c<h.length;c++)0>(h[c]-b||e[c].endSide-e[a].endSide)&&(a=c,b=h[c]);return a}function Zb(e,h,a=e.length){let b=0;for(let c=0;c<a;)9==e.charCodeAt(c)?(b+=h-b%h,c++):(b++,c=ya(e,c));return b}function Ud(e,h,a,b){for(let c=
0,d=0;;){if(d>=h)return c;if(c==e.length)break;d+=9==e.charCodeAt(c)?a-d%a:1;c=ya(e,c)}return!0===b?-1:e.length}function Hk(e){e=!(Ik&&(e.ctrlKey||e.altKey||e.metaKey)||Jk&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?Fc:db)[e.keyCode]||e.key||"Unidentified";"Esc"==e&&(e="Escape");"Del"==e&&(e="Delete");"Left"==e&&(e="ArrowLeft");"Up"==e&&(e="ArrowUp");"Right"==e&&(e="ArrowRight");"Down"==e&&(e="ArrowDown");return e}function Gc(e){return(11==e.nodeType?e.getSelection?
e:e.ownerDocument:e).getSelection()}function Fb(e,h){return h?e==h||e.contains(1!=h.nodeType?h.parentNode:h):!1}function Vd(e,h){if(!h.anchorNode)return!1;try{return Fb(e,h.anchorNode)}catch(a){return!1}}function $b(e){return 3==e.nodeType?ac(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function Hc(e,h,a,b){return a?cg(e,h,a,b,-1)||cg(e,h,a,b,1):!1}function Wd(e){for(var h=0;;h++)if(e=e.previousSibling,!e)return h}function cg(e,h,a,b,c){for(;;){if(e==a&&h==b)return!0;
if(h==(0>c?0:Ic(e))){if("DIV"==e.nodeName)return!1;let d=e.parentNode;if(!d||1!=d.nodeType)return!1;h=Wd(e)+(0>c?0:1);e=d}else if(1==e.nodeType){e=e.childNodes[h+(0>c?-1:0)];if(1==e.nodeType&&"false"==e.contentEditable)return!1;h=0>c?Ic(e):0}else return!1}}function Ic(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Jc(e,h){h=h?e.left:e.right;return{left:h,right:h,top:e.top,bottom:e.bottom}}function Kk(e,h,a,b,c,d,f,g){let k=e.ownerDocument,l=k.defaultView;for(;e;)if(1==e.nodeType){let v=
e==k.body;if(v){var m=0;var n=l.innerWidth;var p=0;var q=l.innerHeight}else{if(e.scrollHeight<=e.clientHeight&&e.scrollWidth<=e.clientWidth){e=e.parentNode;continue}var r=e.getBoundingClientRect();m=r.left;n=r.left+e.clientWidth;p=r.top;q=r.top+e.clientHeight}var t=r=0;"nearest"==c?h.top<p?(t=-(p-h.top+f),0<a&&h.bottom>q+t&&(t=h.bottom-q+t+f)):h.bottom>q&&(t=h.bottom-q+f,0>a&&h.top-t<p&&(t=-(p+t-h.top+f))):(t=h.bottom-h.top,q-=p,t=("center"==c&&t<=q?h.top+t/2-q/2:"start"==c||"center"==c&&0>a?h.top-
f:h.bottom-q+f)-p);"nearest"==b?h.left<m?(r=-(m-h.left+d),0<a&&h.right>n+r&&(r=h.right-n+r+d)):h.right>n&&(r=h.right-n+d,0>a&&h.left<m+r&&(r=-(m+r-h.left+d))):r=("center"==b?h.left+(h.right-h.left)/2-(n-m)/2:"start"==b==g?h.left-d:h.right-(n-m)+d)-m;if(r||t)v?l.scrollBy(r,t):(t&&(b=e.scrollTop,e.scrollTop+=t,t=e.scrollTop-b),r&&(b=e.scrollLeft,e.scrollLeft+=r,r=e.scrollLeft-b),h={left:h.left-r,top:h.top-t,right:h.right-r,bottom:h.bottom-t});if(v)break;e=e.assignedSlot||e.parentNode;b=c="nearest"}else if(11==
e.nodeType)e=e.host;else break}function dg(e){if(e.setActive)return e.setActive();if(Gb)return e.focus(Gb);let h=[];for(var a=e;a&&(h.push(a,a.scrollTop,a.scrollLeft),a!=a.ownerDocument);a=a.parentNode);e.focus(null==Gb?{get preventScroll(){Gb={preventScroll:!0};return!0}}:void 0);if(!Gb)for(Gb=!1,e=0;e<h.length;){a=h[e++];let b=h[e++],c=h[e++];a.scrollTop!=b&&(a.scrollTop=b);a.scrollLeft!=c&&(a.scrollLeft=c)}}function ac(e,h,a=h){let b=Lk||=document.createRange();b.setEnd(e,a);b.setStart(e,h);return b}
function bc(e,h,a){a={key:h,code:h,keyCode:a,which:a,cancelable:!0};h=new KeyboardEvent("keydown",a);h.synthetic=!0;e.dispatchEvent(h);a=new KeyboardEvent("keyup",a);a.synthetic=!0;e.dispatchEvent(a);return h.defaultPrevented||a.defaultPrevented}function Mk(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}function eg(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}function fg(e){let h=e.nextSibling;e.parentNode.removeChild(e);
return h}function gg(e,h,a,b,c,d,f,g,k){let {children:l}=e,m=l.length?l[h]:null,n=d.length?d[d.length-1]:null,p=n?n.breakAfter:f;if(!(h==b&&m&&!f&&!p&&2>d.length&&m.merge(a,c,d.length?n:null,0==a,g,k))){if(b<l.length){let q=l[b];if(q&&c<q.length)h==b&&(q=q.split(c),c=0),!p&&n&&q.merge(0,c,n,!0,0,k)?d[d.length-1]=q:(c&&q.merge(0,c,null,!1,0,k),d.push(q));else if(null===q||void 0===q?0:q.breakAfter)n?n.breakAfter=1:f=1;b++}m&&(m.breakAfter=f,0<a&&(!f&&d.length&&m.merge(a,m.length,d[0],!1,g,0)?m.breakAfter=
d.shift().breakAfter:(a<m.length||m.children.length&&0==m.children[m.children.length-1].length)&&m.merge(a,m.length,null,!1,g,0),h++));for(;h<b&&d.length;)if(l[b-1].become(d[d.length-1]))b--,d.pop(),k=d.length?0:g;else if(l[h].become(d[0]))h++,d.shift(),g=d.length?0:k;else break;!d.length&&h&&b<l.length&&!l[h-1].breakAfter&&l[b].merge(0,0,l[h-1],!1,g,k)&&h--;(h<b||d.length)&&e.replaceChildren(h,b,d)}}function hg(e,h,a,b,c,d){let f=e.childCursor(),{i:g,off:k}=f.findPos(a,1),{i:l,off:m}=f.findPos(h,
-1);h-=a;for(let n of b)h+=n.length;e.length+=h;gg(e,l,m,g,k,b,0,c,d)}function Xd(e,h,a){let b=e.nodeValue.length;h>b&&(h=b);let c=h,d=h,f=0;0==h&&0>a||h==b&&0<=a?D.chrome||D.gecko||(h?(c--,f=1):d<b&&(d++,f=-1)):0>a?c--:d<b&&d++;e=ac(e,c,d).getClientRects();if(!e.length)return ig;a=e[(f?0>f:0<=a)?0:e.length-1];D.safari&&!f&&0==a.width&&(a=Array.prototype.find.call(e,g=>g.width)||a);return f?Jc(a,0>f):a||null}function Yd(e,h,a,b,c,d){if(a instanceof Xa){for(let f of a.children){let g=Fb(f.dom,b),k=
g?b.nodeValue.length:f.length;if(e<k||e==k&&0>=f.getSide())return g?Yd(e,h,f,b,c,d):c(f,e,h);e-=k}return c(a,a.length,-1)}return a.dom==b?d(e,h):c(a,e,h)}function jg(e,h,a,b){if(a instanceof Xa)for(let c of a.children){let d=Fb(c.dom,b);if(Fb(c.dom,e))return 0+(d?jg(e,h,c,b):c.localPosFromDOM(e,h))}else if(a.dom==b)return Math.min(h,b.nodeValue.length);return a.localPosFromDOM(e,h)}function kg(e,h,a){let b=0;for(let c=0;b<h.length;b++){let d=h[b],f=c+d.length;if(!(f==c&&0>=d.getSide())){if(a>c&&a<
f&&d.dom.parentNode==e)return d.domAtPos(a-c);if(a<=c)break;c=f}}for(;0<b;b--)if(a=h[b-1].dom,a.parentNode==e)return oa.after(a);return new oa(e,0)}function lg(e,h,a){let b,{children:c}=e;0<a&&h instanceof Xa&&c.length&&(b=c[c.length-1])instanceof Xa&&b.mark.eq(h.mark)?lg(b,h.children[0],a-1):(c.push(h),h.setParent(e));e.length+=h.length}function mg(e,h,a){for(let b=0,c=0;c<e.children.length;c++){let d=e.children[c],f=b+d.length,g;if((0>=a||f==e.length||0<d.getSide()?f>=h:f>h)&&(h<f||c+1==e.children.length||
(g=e.children[c+1]).length||0<g.getSide())){let k=0;if(f==b){if(0>=d.getSide())continue;k=a=-d.getSide()}e=d.coordsAt(Math.max(0,h-b),a);return k&&e?Jc(e,0>a):e}b=f}a=e.dom.lastChild;if(!a)return e.dom.getBoundingClientRect();e=$b(a);return e[e.length-1]||null}function Zd(e,h){for(let a in e)"class"==a&&h.class?h.class+=" "+e.class:"style"==a&&h.style?h.style+=";"+e.style:h[a]=e[a];return h}function $d(e,h){if(e==h)return!0;if(!e||!h)return!1;let a=Object.keys(e),b=Object.keys(h);if(a.length!=b.length)return!1;
for(let c of a)if(-1==b.indexOf(c)||e[c]!==h[c])return!1;return!0}function ae(e,h,a){let b=null;if(h)for(let c in h)a&&c in a||e.removeAttribute(b=c);if(a)for(let c in a)h&&h[c]==a[c]||e.setAttribute(b=c,a[c]);return!!b}function ng(e,h=!1){let {inclusiveStart:a,inclusiveEnd:b}=e;null==a&&(a=e.inclusive);null==b&&(b=e.inclusive);return{start:null!==a&&void 0!==a?a:h,end:null!==b&&void 0!==b?b:h}}function be(e,h,a,b=0){let c=a.length-1;0<=c&&a[c]+b>=e?a[c]=Math.max(a[c],h):a.push(e,h)}function Kc(e,
h){for(let a of h)e=new Xa(a,[e],e.length);return e}function za(e,h,a){e=e.facet(og);if(e.length)e[0](h);else if(window.onerror)window.onerror(String(h),a,void 0,void 0,h);else a?console.error(a+":",h):console.error(h)}function pg(e){let h=[];for(let a=0;a<e.length;a++)h.push(1<<+e[a]);return h}function qg(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}function rg(e){var h=e.observer.selectionRange;h=h.focusNode&&sg(h.focusNode,h.focusOffset,0);if(!h)return null;
e=e.docView.nearest(h);if(!e)return null;if(e instanceof wa){for(var a=h;a.parentNode!=e.dom;)a=a.parentNode;let b=a.previousSibling;for(;b&&!da.get(b);)b=b.previousSibling;e=b?da.get(b).posAtEnd:e.posAtStart;return{from:e,to:e,node:a,text:h}}for(;;){({parent:a}=e);if(!a)return null;if(a instanceof wa)break;e=a}a=e.posAtStart;return{from:a,to:a+e.length,node:e.dom,text:h}}function Nk(e,h){var a=rg(e);if(!a)return H.none;let {from:b,to:c,node:d,text:f}=a;a=h.mapPos(b,1);h=Math.max(a,h.mapPos(c,-1));
({state:e}=e);let g=3==d.nodeType?d.nodeValue:(new tg([],e)).readRange(d.firstChild,null).text;if(h-a<g.length)if(e.doc.sliceString(a,Math.min(e.doc.length,a+g.length),"\uffff")==g)h=a+g.length;else if(e.doc.sliceString(Math.max(0,h-g.length),h,"\uffff")==g)a=h-g.length;else return H.none;else if(e.doc.sliceString(a,h,"\uffff")!=g)return H.none;e=da.get(d);e instanceof ug?e=e.widget.topView:e&&(e.parent=null);return H.set(H.replace({widget:new Ok(d,f,e),inclusive:!0}).range(a,h))}function sg(e,h,
a){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&0<h&&0>=a)e=e.childNodes[h-1],h=Ic(e);else if(1==e.nodeType&&h<e.childNodes.length&&0<=a)e=e.childNodes[h],h=0;else return null}}function Pk(e,h,a){let b=new Qk;W.compare(e,h,a,b);return b.changes}function Rk(e,h,a=1){let b=e.charCategorizer(h);e=e.doc.lineAt(h);var c=h-e.from;if(0==e.length)return u.cursor(h);0==c?a=1:c==e.length&&(a=-1);let d=h=c;0>a?h=ya(e.text,c,!1):d=ya(e.text,c);for(a=b(e.text.slice(h,d));0<h;){c=ya(e.text,h,!1);if(b(e.text.slice(c,
h))!=a)break;h=c}for(;d<e.length;){c=ya(e.text,d);if(b(e.text.slice(d,c))!=a)break;d=c}return u.range(h+e.from,d+e.from)}function ce(e,h){return e.top<h.bottom-1&&e.bottom>h.top+1}function vg(e,h){return h<e.top?{top:h,left:e.left,right:e.right,bottom:e.bottom}:e}function wg(e,h){return h>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:h}:e}function de(e,h,a){let b,c,d;let f,g,k,l;for(let n=e.firstChild;n;n=n.nextSibling){let p=$b(n);for(let q=0;q<p.length;q++){let r=p[q];c&&ce(c,r)&&(r=vg(wg(r,
c.bottom),c.top));let t=r.left>h?r.left-h:Math.max(0,h-r.right),v=r.top>a?r.top-a:Math.max(0,a-r.bottom);if(0==t&&0==v)return 3==n.nodeType?xg(n,h,a):de(n,h,a);if(!b||m>v||m==v&&d>t){b=n;c=r;d=t;var m=v}0==t?a>r.bottom&&(!k||k.bottom<r.bottom)?(f=n,k=r):a<r.top&&(!l||l.top>r.top)&&(g=n,l=r):k&&ce(k,r)?k=wg(k,r.bottom):l&&ce(l,r)&&(l=vg(l,r.top))}}k&&k.bottom>=a?(b=f,c=k):l&&l.top<=a&&(b=g,c=l);if(!b)return{node:e,offset:0};m=Math.max(c.left,Math.min(c.right,h));if(3==b.nodeType)return xg(b,m,a);if(!d&&
"true"==b.contentEditable)return de(b,m,a);h=Array.prototype.indexOf.call(e.childNodes,b)+(h>=(c.left+c.right)/2?1:0);return{node:e,offset:h}}function xg(e,h,a){let b=e.nodeValue.length;var c=-1,d=1E9;let f=0;for(let g=0;g<b;g++){let k=ac(e,g,g+1).getClientRects();for(let l=0;l<k.length;l++){let m=k[l];if(m.top==m.bottom)continue;f||=h-m.left;let n=(m.top>a?m.top-a:a-m.bottom)-1;if(m.left-1<=h&&m.right+1>=h&&n<d){d=c=h>=(m.left+m.right)/2;(D.chrome||D.gecko)&&ac(e,g).getBoundingClientRect().left==
m.right&&(d=!c);if(0>=n)return{node:e,offset:g+(d?1:0)};c=g+(d?1:0);d=n}}}return{node:e,offset:-1<c?c:0<f?e.nodeValue.length:0}}function yg(e,{x:h,y:a},b,c=-1){var d,f=e.contentDOM.getBoundingClientRect(),g=f.top+e.viewState.paddingTop;let k;var {docHeight:l}=e.viewState;let m=a-g;if(0>m)return 0;if(m>l)return e.state.doc.length;for(let q=e.defaultLineHeight/2,r=!1;;){k=e.elementAtHeight(m);if(k.type==X.Text)break;for(;;){m=0<c?k.bottom+q:k.top-q;if(0<=m&&m<=l)break;if(r)return b?null:0;r=!0;c=-c}}a=
g+m;c=k.from;if(c<e.viewport.from)return 0==e.viewport.from?0:b?null:zg(e,f,k,h,a);if(c>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:b?null:zg(e,f,k,h,a);b=e.dom.ownerDocument;l=e.root.elementFromPoint?e.root:b;(g=l.elementFromPoint(h,a))&&!e.contentDOM.contains(g)&&(g=null);g||(h=Math.max(f.left+1,Math.min(f.right-1,h)),(g=l.elementFromPoint(h,a))&&!e.contentDOM.contains(g)&&(g=null));var n;f=-1;if(g&&0!=(null===(d=e.docView.nearest(g))||void 0===d?void 0:d.isEditable))if(b.caretPositionFromPoint){var p=
b.caretPositionFromPoint(h,a);p&&({offsetNode:n,offset:f}=p)}else if(b.caretRangeFromPoint&&(d=b.caretRangeFromPoint(h,a))){({startContainer:n,startOffset:f}=d);if(d=D.safari)a:if(d=h,3!=n.nodeType||f!=(p=n.nodeValue.length))d=!1;else{for(b=n.nextSibling;b;b=b.nextSibling)if(1!=b.nodeType||"BR"!=b.nodeName){d=!1;break a}d=ac(n,p-1,p).getBoundingClientRect().left>d}d&&(n=void 0)}if(!n||!e.docView.dom.contains(n)){n=wa.find(e.docView,c);if(!n)return m>k.top+k.height/2?k.to:k.from;({node:n,offset:f}=
de(n.dom,h,a))}return e.docView.posFromDOM(n,f)}function zg(e,h,a,b,c){h=Math.round((b-h.left)*e.defaultCharacterWidth);e.lineWrapping&&a.height>1.5*e.defaultLineHeight&&(h+=Math.floor((c-a.top)/e.defaultLineHeight)*e.viewState.heightOracle.lineLength);c=e.state.sliceDoc(a.from,a.to);return a.from+Ud(c,h,e.state.tabSize)}function Ag(e,h,a,b){let c=e.state.doc.lineAt(h.head),d=e.bidiSpans(c),f=e.textDirectionAt(c.from);for(let q=h,r=null;;){a:{var g=void 0;h=c;var k=d,l=f,m=q,n=a;let t=m.head-h.from,
v=-1;if(0==t){if(!n||!h.length){h=null;break a}k[0].level!=l&&(t=k[0].side(!1,l),v=0)}else if(t==h.length){if(n){h=null;break a}var p=k[k.length-1];p.level!=l&&(t=p.side(!0,l),v=k.length-1)}0>v&&(v=rb.find(k,t,null!==(g=m.bidiLevel)&&void 0!==g?g:-1,m.assoc));g=k[v];t==g.side(n,l)&&(g=k[v+=n?1:-1],t=g.side(!n,l));p=n==(g.dir==l);m=ya(h.text,t,p);Bg=h.text.slice(Math.min(t,m),Math.max(t,m));h=m!=g.side(n,l)?u.cursor(m+h.from,p?-1:1,g.level):(k=v==(n?k.length-1:0)?null:k[v+(n?1:-1)])||g.level==l?k&&
k.level<g.level?u.cursor(k.side(!n,l)+h.from,n?1:-1,k.level):u.cursor(m+h.from,n?-1:1,g.level):u.cursor(n?h.to:h.from,n?-1:1,l)}l=Bg;if(!h){if(c.number==(a?e.state.doc.lines:1))return q;l="\n";c=e.state.doc.line(c.number+(a?1:-1));d=e.bidiSpans(c);h=u.cursor(a?c.from:c.to)}if(!r){if(!b)return h;r=b(l)}else if(!r(l))return q;q=h}}function Sk(e,h,a){let b=e.state.charCategorizer(h),c=b(a);return d=>{d=b(d);c==va.Space&&(c=d);return c==d}}function ee(e,h,a){let b=e.state.facet(Cg).map(c=>c(e));for(;;){let c=
!1;for(let d of b)d.between(a.from-1,a.from+1,(f,g,k)=>{a.from>f&&a.from<g&&(a=h.from>a.from?u.cursor(f,1):u.cursor(g,-1),c=!0)});if(!c)return a}}function Tk(e,h){var {main:a}=e.state.selection;if(a.empty)return!1;e=Gc(e.root);if(0==e.rangeCount)return!0;e=e.getRangeAt(0).getClientRects();for(a=0;a<e.length;a++){let b=e[a];if(b.left<=h.clientX&&b.right>=h.clientX&&b.top<=h.clientY&&b.bottom>=h.clientY)return!0}return!1}function Dg(e,h){if(!h.bubbles)return!0;if(h.defaultPrevented)return!1;for(let a=
h.target,b;a!=e.contentDOM;a=a.parentNode)if(!a||11==a.nodeType||(b=da.get(a))&&b.ignoreEvent(h))return!1;return!0}function Uk(e){let h=e.dom.parentNode;if(h){var a=h.appendChild(document.createElement("textarea"));a.style.cssText="position: fixed; left: -10000px; top: 10px";a.focus();setTimeout(()=>{e.focus();a.remove();Eg(e,a.value)},50)}}function Eg(e,h){let {state:a}=e,b,c=1,d=a.toText(h),f=d.lines==a.selection.ranges.length;if(null!=fe&&a.selection.ranges.every(g=>g.empty)&&fe==d.toString()){let g=
-1;b=a.changeByRange(k=>{let l=a.doc.lineAt(k.from);if(l.from==g)return{range:k};g=l.from;let m=a.toText((f?d.line(c++).text:h)+a.lineBreak);return{changes:{from:l.from,insert:m},range:u.cursor(k.from+m.length)}})}else b=f?a.changeByRange(g=>{let k=d.line(c++);return{changes:{from:g.from,to:g.to,insert:k.text},range:u.cursor(g.from+k.length)}}):a.replaceSelection(d);e.dispatch(b,{userEvent:"input.paste",scrollIntoView:!0})}function Fg(e,h,a,b){if(1==b)return u.cursor(h,a);if(2==b)return Rk(e.state,
h,a);a=wa.find(e.docView,h);h=e.state.doc.lineAt(a?a.posAtEnd:h);b=a?a.posAtStart:h.from;a=a?a.posAtEnd:h.to;a<e.state.doc.length&&a==h.to&&a++;return u.range(b,a)}function Gg(e,h){let a=e.posAtCoords({x:h.clientX,y:h.clientY},!1);{var b=h.clientX;h=h.clientY;let f=wa.find(e.docView,a);if(f){var c=a-f.posAtStart;if(0==c)b=1;else if(c==f.length)b=-1;else{e=f.coordsAt(c,-1);var d;if(d=e)d=h>=e.top&&h<=e.bottom&&b>=e.left&&b<=e.right;if(d)b=-1;else{if(d=c=f.coordsAt(c,1))d=h>=c.top&&h<=c.bottom&&b>=
c.left&&b<=c.right;b=d?1:e&&h>=e.top&&h<=e.bottom?-1:1}}}else b=1}return{pos:a,bias:b}}function ge(e){if(!Vk)return e.detail;let h=Hg,a=Ig;Hg=e;Ig=Date.now();return Jg=!h||a>Date.now()-400&&2>Math.abs(h.clientX-e.clientX)&&2>Math.abs(h.clientY-e.clientY)?(Jg+1)%3:1}function Wk(e,h){let a=Gg(e,h),b=ge(h),c=e.state.selection,d=a,f=h;return{update(g){g.docChanged&&(a&&(a.pos=g.changes.mapPos(a.pos)),c=c.map(g.changes),f=null)},get(g,k,l){if(f&&g.clientX==f.clientX&&g.clientY==f.clientY)var m=d;else m=
d=Gg(e,g),f=g;if(!m||!a)return c;g=Fg(e,m.pos,m.bias,b);if(a.pos!=m.pos&&!k){var n=Fg(e,a.pos,a.bias,b);m=Math.min(n.from,g.from);n=Math.max(n.to,g.to);g=m<g.from?u.range(m,n):u.range(n,m)}return k?c.replaceRange(c.main.extend(g.from,g.to)):l?c.addRange(g):u.create([g])}}}function Kg(e,h,a,b){if(a){var c=e.posAtCoords({x:h.clientX,y:h.clientY},!1);h.preventDefault();({mouseSelection:h}=e.inputState);b=b&&h&&h.dragging&&h.dragMove?{from:h.dragging.from,to:h.dragging.to}:null;a={from:c,insert:a};a=
e.state.changes(b?[b,a]:a);e.focus();e.dispatch({changes:a,selection:{anchor:a.mapPos(c,-1),head:a.mapPos(c,1)},userEvent:b?"move.drop":"input.drop"})}}function Xk(e,h){let a=e.dom.parentNode;if(a){var b=a.appendChild(document.createElement("textarea"));b.style.cssText="position: fixed; left: -10000px; top: 10px";b.value=h;b.focus();b.selectionEnd=h.length;b.selectionStart=0;setTimeout(()=>{b.remove();e.focus()},50)}}function Lg(e){setTimeout(()=>{e.hasFocus!=e.inputState.notifiedFocused&&e.update([])},
10)}function Mg(e,h){if(e.docView.compositionDeco.size){e.inputState.rapidCompositionStart=h;try{e.update([])}finally{e.inputState.rapidCompositionStart=!1}}}function Ng(e,h){let a,b;null==e[h]&&(a=e[h-1])instanceof pa&&(b=e[h+1])instanceof pa&&e.splice(h-1,3,new pa(a.length+1+b.length))}function Yk(e,h,a){let b=new Zk;W.compare(e,h,a,b,0);return b.changes}function $k(e,h){let a=e.getBoundingClientRect(),b=Math.max(0,a.left),c=Math.min(innerWidth,a.right),d=Math.max(0,a.top),f=Math.min(innerHeight,
a.bottom),g=e.ownerDocument.body;for(e=e.parentNode;e&&e!=g;)if(1==e.nodeType){let k=window.getComputedStyle(e);if((e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)&&"visible"!=k.overflow){let l=e.getBoundingClientRect();b=Math.max(b,l.left);c=Math.min(c,l.right);d=Math.max(d,l.top);f=Math.min(f,l.bottom)}e="absolute"==k.position||"fixed"==k.position?e.offsetParent:e.parentNode}else if(11==e.nodeType)e=e.host;else break;return{left:b-a.left,right:Math.max(b,c)-a.left,top:d-(a.top+h),bottom:Math.max(d,
f)-(a.top+h)}}function al(e,h){e=e.getBoundingClientRect();return{left:0,right:e.right-e.left,top:h,bottom:e.bottom-(e.top+h)}}function bl(e,h,a){let b=[],c=e,d=0;W.spans(a,e,h,{span(){},point(f,g){f>c&&(b.push({from:c,to:f}),d+=f-c);c=g}},20);c<h&&(b.push({from:c,to:h}),d+=h-c);return{total:d,ranges:b}}function Lc({total:e,ranges:h},a){if(0>=a)return h[0].from;if(1<=a)return h[h.length-1].to;e=Math.floor(e*a);for(a=0;;a++){let {from:b,to:c}=h[a],d=c-b;if(e<=d)return b+e;e-=d}}function Og(e,h){let a=
0;for(let {from:b,to:c}of e.ranges){if(h<=c){a+=h-b;break}a+=c-b}return a/e.total}function Pg(e,h,a){for(let b=0;b<e.length;b++){let c=e[b];if(c.from<a&&c.to>h){let d=[];c.from<h&&d.push({from:c.from,to:h});c.to>a&&d.push({from:a,to:c.to});e.splice(b,1,...d);b+=d.length-1}}}function cl(e,h){for(let a of e)if(h(a))return a}function cc(e,h){if(1==h.scale)return e;let a=h.toDOM(e.top),b=h.toDOM(e.bottom);return new sb(e.from,e.length,a,b-a,Array.isArray(e.type)?e.type.map(c=>cc(c,h)):e.type)}function he(e,
h,a){return new eb(h,{finish(b){return/&/.test(b)?b.replace(/&\w*/,c=>{if("&"==c)return e;if(!a||!a[c])throw new RangeError(`Unsupported selector: ${c}`);return a[c]}):e+" "+b}})}function Qg(e,h,a){for(;h;){var b=da.get(h);if(b&&b.parent==e)return b;b=h.parentNode;h=b!=e.dom?b:0<a?h.nextSibling:h.previousSibling}return null}function dl(e){function h(g){g.preventDefault();g.stopImmediatePropagation();a=g.getTargetRanges()[0]}let a=null;e.contentDOM.addEventListener("beforeinput",h,!0);document.execCommand("indent");
e.contentDOM.removeEventListener("beforeinput",h,!0);if(!a)return null;let b=a.startContainer,c=a.startOffset,d=a.endContainer,f=a.endOffset;e=e.docView.domAtPos(e.state.selection.main.anchor);Hc(e.node,e.offset,d,f)&&([b,c,d,f]=[d,f,b,c]);return{anchorNode:b,anchorOffset:c,focusNode:d,focusOffset:f}}function el(e,h,a,b){let c;let d=e.state.selection.main;if(-1<h){a=e.docView.domBoundsAround(h,a,0);if(!a||e.state.readOnly)return!1;let {from:g,to:k}=a;var f=e.docView.impreciseHead||e.docView.impreciseAnchor?
[]:fl(e);h=new tg(f,e.state);h.readRange(a.startDOM,a.endDOM);a=d.from;let l=null;if(8===e.inputState.lastKeyCode&&e.inputState.lastKeyTime>Date.now()-100||D.android&&h.text.length<k-g)a=d.to,l="end";if(a=gl(e.state.doc.sliceString(g,k,"\uffff"),h.text,a-g,l))D.chrome&&13==e.inputState.lastKeyCode&&a.toB==a.from+2&&"\uffff\uffff"==h.text.slice(a.from,a.toB)&&a.toB--,c={from:g+a.from,to:g+a.toA,insert:V.of(h.text.slice(a.from,a.toB).split("\uffff"))};f=hl(f,g)}else if(e.hasFocus||!e.state.facet(dc)){a=
e.observer.selectionRange;let {impreciseHead:g,impreciseAnchor:k}=e.docView;h=g&&g.node==a.focusNode&&g.offset==a.focusOffset||!Fb(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset);a=k&&k.node==a.anchorNode&&k.offset==a.anchorOffset||!Fb(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset);if(h!=d.head||a!=d.anchor)f=u.single(a,h)}if(!c&&!f)return!1;!c&&b&&!d.empty&&f&&f.main.empty?c={from:d.from,
to:d.to,insert:e.state.doc.slice(d.from,d.to)}:c&&c.from>=d.from&&c.to<=d.to&&(c.from!=d.from||c.to!=d.to)&&4>=d.to-d.from-(c.to-c.from)?c={from:d.from,to:d.to,insert:e.state.doc.slice(d.from,c.from).append(c.insert).append(e.state.doc.slice(c.to,d.to))}:(D.mac||D.android)&&c&&c.from==c.to&&c.from==d.head-1&&"."==c.insert.toString()&&(c={from:d.from,to:d.to,insert:V.of([" "])});if(c){let g=e.state;if(D.ios&&e.inputState.flushIOSKey(e)||D.android&&(c.from==d.from&&c.to==d.to&&1==c.insert.length&&2==
c.insert.lines&&bc(e.contentDOM,"Enter",13)||c.from==d.from-1&&c.to==d.to&&0==c.insert.length&&bc(e.contentDOM,"Backspace",8)||c.from==d.from&&c.to==d.to+1&&0==c.insert.length&&bc(e.contentDOM,"Delete",46)))return!0;let k=c.insert.toString();if(e.state.facet(Rg).some(l=>l(e,c.from,c.to,k)))return!0;0<=e.inputState.composing&&e.inputState.composing++;if(c.from>=d.from&&c.to<=d.to&&c.to-c.from>=(d.to-d.from)/3&&(!f||f.main.empty&&f.main.from==c.from+c.insert.length)&&0>e.inputState.composing)b=d.from<
c.from?g.sliceDoc(d.from,c.from):"",f=d.to>c.to?g.sliceDoc(c.to,d.to):"",b=g.replaceSelection(e.state.toText(b+c.insert.sliceString(0,void 0,e.state.lineBreak)+f));else{let l=g.changes(c),m=f&&!g.selection.main.eq(f.main)&&f.main.to<=l.newLength?f.main:void 0;if(1<g.selection.ranges.length&&0<=e.inputState.composing&&c.to<=d.to&&c.to>=d.to-10){let n=e.state.sliceDoc(c.from,c.to),p=rg(e)||e.state.doc.lineAt(d.head),q=d.to-c.to,r=d.to-d.from;b=g.changeByRange(t=>{if(t.from==d.from&&t.to==d.to)return{changes:l,
range:m||t.map(l)};var v=t.to-q,C=v-n.length;if(t.to-t.from!=r||e.state.sliceDoc(C,v)!=n||p&&t.to>=p.from&&t.from<=p.to)return{range:t};v=g.changes({from:C,to:v,insert:c.insert});C=t.to-d.to;return{changes:v,range:m?u.range(Math.max(0,m.anchor+C),Math.max(0,m.head+C)):t.map(v)}})}else b={changes:l,selection:m&&g.selection.replaceRange(m)}}f="input.type";e.composing&&(f+=".compose",e.inputState.compositionFirstChange&&(f+=".start",e.inputState.compositionFirstChange=!1));e.dispatch(b,{scrollIntoView:!0,
userEvent:f});return!0}return f&&!f.main.eq(d)?(b=!1,h="select",e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(b=!0),h=e.inputState.lastSelectionOrigin),e.dispatch({selection:f,scrollIntoView:b,userEvent:h}),!0):!1}function gl(e,h,a,b){var c=Math.min(e.length,h.length);let d=0;for(;d<c&&e.charCodeAt(d)==h.charCodeAt(d);)d++;if(d==c&&e.length==h.length)return null;c=e.length;let f=h.length;for(;0<c&&0<f&&e.charCodeAt(c-1)==h.charCodeAt(f-1);)c--,f--;"end"==
b&&(a-=c+Math.max(0,d-Math.min(c,f))-d);c<d&&e.length<h.length?(d-=a<=d&&a>=c?d-a:0,f=d+(f-c),c=d):f<d&&(d-=a<=d&&a>=f?d-a:0,c=d+(c-f),f=d);return{from:d,toA:c,toB:f}}function fl(e){let h=[];if(e.root.activeElement!=e.contentDOM)return h;let {anchorNode:a,anchorOffset:b,focusNode:c,focusOffset:d}=e.observer.selectionRange;a&&(h.push(new Sg(a,b)),c==a&&d==b||h.push(new Sg(c,d)));return h}function hl(e,h){if(0==e.length)return null;let a=e[0].pos;e=2==e.length?e[1].pos:a;return-1<a&&-1<e?u.single(a+
h,e+h):null}function Tg(e,h,a){for(let b=e.state.facet(h),c=b.length-1;0<=c;c--)h=b[c],(h="function"==typeof h?h(e):h)&&Zd(h,a);return a}function ie(e,h,a){h.altKey&&(e="Alt-"+e);h.ctrlKey&&(e="Ctrl-"+e);h.metaKey&&(e="Meta-"+e);!1!==a&&h.shiftKey&&(e="Shift-"+e);return e}function Ug(e){e=e.facet(je);let h=Vg.get(e);h||Vg.set(e,h=il(e.reduce((a,b)=>a.concat(b),[])));return h}function il(e,h=jl){let a=Object.create(null),b=Object.create(null),c=(f,g)=>{let k=b[f];if(null==k)b[f]=g;else if(k!=g)throw Error("Key binding "+
f+" is used both as a regular binding and as a multi-stroke prefix");},d=(f,g,k,l)=>{var m=a[f]||(a[f]=Object.create(null));g=g.split(/ (?!$)/).map(n=>{n=n.split(/-(?!$)/);let p=n[n.length-1];"Space"==p&&(p=" ");let q,r,t,v;for(let C=0;C<n.length-1;++C){const F=n[C];if(/^(cmd|meta|m)$/i.test(F))v=!0;else if(/^a(lt)?$/i.test(F))q=!0;else if(/^(c|ctrl|control)$/i.test(F))r=!0;else if(/^s(hift)?$/i.test(F))t=!0;else if(/^mod$/i.test(F))"mac"==h?v=!0:r=!0;else throw Error("Unrecognized modifier name: "+
F);}q&&(p="Alt-"+p);r&&(p="Ctrl-"+p);v&&(p="Meta-"+p);t&&(p="Shift-"+p);return p});for(let n=1;n<g.length;n++){let p=g.slice(0,n).join(" ");c(p,!0);m[p]||(m[p]={preventDefault:!0,commands:[q=>{let r=fb={view:q,prefix:p,scope:f};setTimeout(()=>{fb==r&&(fb=null)},kl);return!0}]})}g=g.join(" ");c(g,!1);m=m[g]||(m[g]={preventDefault:!1,commands:[]});m.commands.push(k);l&&(m.preventDefault=!0)};for(let f of e)if(e=f[h]||f.key)for(let g of f.scope?f.scope.split(" "):["editor"])d(g,e,f.run,f.preventDefault),
f.shift&&d(g,"Shift-"+e,f.shift,f.preventDefault);return a}function Wg(e,h,a,b){let c=Hk(h),d=1==c.length&&" "!=c,f="",g=!1;fb&&fb.view==a&&fb.scope==b&&(f=fb.prefix+" ",g=0>Xg.indexOf(h.keyCode))&&(fb=null);let k=m=>{if(m){for(let n of m.commands)if(n(a))return!0;m.preventDefault&&(g=!0)}return!1};e=e[b];let l;if(e){if(k(e[f+ie(c,h,!d)]))return!0;if(d&&(h.shiftKey||h.altKey||h.metaKey)&&(l=db[h.keyCode])&&l!=c){if(k(e[f+ie(l,h,!0)]))return!0}else if(d&&h.shiftKey&&k(e[f+ie(c,h,!0)]))return!0}return g}
function Yg(e){let h=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==ca.LTR?h.left:h.right-e.scrollDOM.clientWidth)-e.scrollDOM.scrollLeft,top:h.top-e.scrollDOM.scrollTop}}function Zg(e,h,a){h=u.cursor(h);return{from:Math.max(a.from,e.moveToLineBoundary(h,!1,!0).from),to:Math.min(a.to,e.moveToLineBoundary(h,!0,!0).from),type:X.Text}}function $g(e,h){e=e.lineBlockAt(h);if(Array.isArray(e.type))for(let a of e.type)if(a.to>h||a.to==h&&(a.to==e.to||a.type==X.Text))return a;return e}
function ll(e,h){function a(C,F,B,z){return new ah(C-n.left,F-n.top-.01,B-C,z-F+.01,"cm-selectionBackground")}function b({top:C,bottom:F,horizontal:B}){let z=[];for(let G=0;G<B.length;G+=2)z.push(a(B[G],C,B[G+1],F));return z}function c(C,F,B){function z(S,aa,O,J,w){S=e.coordsAtPos(S,S==B.to?-2:2);O=e.coordsAtPos(O,O==B.from?2:-2);G=Math.min(S.top,O.top,G);T=Math.max(S.bottom,O.bottom,T);w==ca.LTR?M.push(k&&aa?p:S.left,k&&J?q:O.right):M.push(!k&&J?p:O.left,!k&&aa?q:S.right)}let G=1E9,T=-1E9,M=[],Q=
null!==C&&void 0!==C?C:B.from,N=null!==F&&void 0!==F?F:B.to;for(let S of e.visibleRanges)if(S.to>Q&&S.from<N)for(let aa=Math.max(S.from,Q),O=Math.min(S.to,N);;){let J=e.state.doc.lineAt(aa);for(let w of e.bidiSpans(J)){let x=w.from+J.from,L=w.to+J.from;if(x>=O)break;L>aa&&z(Math.max(x,aa),null==C&&x<=Q,Math.min(L,O),null==F&&L>=N,w.dir)}aa=J.to+1;if(aa>=O)break}0==M.length&&z(Q,null==C,N,null==F,e.textDirection);return{top:G,bottom:T,horizontal:M}}function d(C,F){C=m.top+(F?C.top:C.bottom);return{top:C,
bottom:C,horizontal:[]}}if(h.to<=e.viewport.from||h.from>=e.viewport.to)return[];var f=Math.max(h.from,e.viewport.from),g=Math.min(h.to,e.viewport.to);let k=e.textDirection==ca.LTR;var l=e.contentDOM;let m=l.getBoundingClientRect(),n=Yg(e);l=window.getComputedStyle(l.firstChild);let p=m.left+parseInt(l.paddingLeft)+Math.min(0,parseInt(l.textIndent)),q=m.right-parseInt(l.paddingRight);l=$g(e,f);let r=$g(e,g),t=l.type==X.Text?l:null,v=r.type==X.Text?r:null;e.lineWrapping&&(t&&=Zg(e,f,t),v&&=Zg(e,g,
v));if(t&&v&&t.from==v.from)return b(c(h.from,h.to,t));f=t?c(h.from,null,t):d(l,!1);h=v?c(null,h.to,v):d(r,!0);g=[];(t||l).to<(v||r).from-1?g.push(a(p,f.bottom,q,h.top)):f.bottom<h.top&&e.elementAtHeight((f.bottom+h.top)/2).type==X.Text&&(f.bottom=h.top=(f.bottom+h.top)/2);return b(f).concat(g).concat(b(h))}function ml(e,h,a){h=e.coordsAtPos(h.head,h.assoc||1);if(!h)return null;e=Yg(e);return new ah(h.left-e.left,h.top-e.top,-1,h.bottom-h.top,a?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}
function bh(e,h,a,b,c){h.lastIndex=0;for(let d=e.iterRange(a,b),f=a,g;!d.next().done;f+=d.value.length)if(!d.lineBreak)for(;g=h.exec(d.value);)c(f+g.index,f+g.index+g[0].length,g)}function nl(e,h){let a=e.visibleRanges;if(1==a.length&&a[0].from==e.viewport.from&&a[0].to==e.viewport.to)return a;let b=[];for(let {from:c,to:d}of a)c=Math.max(e.state.doc.lineAt(c).from,c-h),d=Math.min(e.state.doc.lineAt(d).to,d+h),b.length&&b[b.length-1].to>=c?b[b.length-1].to=d:b.push({from:c,to:d});return b}function ol(){return pl||=
fa.fromClass(class{constructor(e){this.view=e;this.decorations=H.none;this.decorationCache=Object.create(null);this.decorator=this.makeDecorator(e.state.facet(Mc));this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new ql({regexp:e.specialChars,decoration:(h,a,b)=>{var {doc:c}=a.state;h=ma(h[0],0);return 9==h?(c=c.lineAt(b),a=a.state.tabSize,b=Zb(c.text,a,b-c.from),H.replace({widget:new rl((a-b%a)*this.view.defaultCharacterWidth)})):this.decorationCache[h]||(this.decorationCache[h]=
H.replace({widget:new sl(e,h)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let h=e.state.facet(Mc);e.startState.facet(Mc)!=h?(this.decorator=this.makeDecorator(h),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations})}function ch(e,h){var a=e.posAtCoords({x:h.clientX,y:h.clientY},!1);let b=e.state.doc.lineAt(a),c=a-b.from;2E3<c?e=-1:c==b.length?(h=h.clientX,e=(a=e.coordsAtPos(e.viewport.from))?Math.round(Math.abs((a.left-
h)/e.defaultCharacterWidth)):-1):e=Zb(b.text,e.state.tabSize,a-b.from);return{line:b.number,col:e,off:c}}function tl(e,h){let a=ch(e,h),b=e.state.selection;return a?{update(c){if(c.docChanged){var d=c.changes.mapPos(c.startState.doc.line(a.line).from);d=c.state.doc.lineAt(d);a={line:d.number,col:a.col,off:Math.min(a.off,d.length)};b=b.map(c.changes)}},get(c,d,f){var g=ch(e,c);if(!g)return b;c=e.state;var k=a,l=Math.min(k.line,g.line);d=Math.max(k.line,g.line);let m=[];if(2E3<k.off||2E3<g.off||0>k.col||
0>g.col){var n=Math.min(k.off,g.off);for(g=Math.max(k.off,g.off);l<=d;l++)k=c.doc.line(l),k.length<=g&&m.push(u.range(k.from+n,k.to+g))}else for(n=Math.min(k.col,g.col),g=Math.max(k.col,g.col);l<=d;l++){k=c.doc.line(l);let p=Ud(k.text,n,c.tabSize,!0);if(-1<p){let q=Ud(k.text,g,c.tabSize);m.push(u.range(k.from+p,k.from+q))}}return m.length?f?u.create(m.concat(b.ranges)):u.create(m):b}}:null}function ul(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}function vl(e,h={}){let a=K.define(),
b=na.define({create(){return null},update(c,d){if(c&&(h.hideOnChange&&(d.docChanged||d.selection)||h.hideOn&&h.hideOn(d,c)))return null;if(c&&d.docChanged){let f=d.changes.mapPos(c.pos,-1,xa.TrackDel);if(null==f)return null;let g=Object.assign(Object.create(null),c);g.pos=f;null!=c.end&&(g.end=d.changes.mapPos(c.end));c=g}for(let f of d.effects)f.is(a)&&(c=f.value),f.is(wl)&&(c=null);return c},provide:c=>Nc.from(c)});return[b,fa.define(c=>new xl(c,e,b,a,h.hoverTime||300)),yl]}function ec(e,h){h=(e=
e.plugin(dh))?e.specs.indexOf(h):-1;return-1<h?e.panels[h]:null}function eh(e){let h=e.nextSibling;e.remove();return h}function zl(e){return[fh(),fc.of(Object.assign(Object.assign({},Al),e))]}function fh(e){let h=[Bl];e&&!1===e.fixed&&h.push(ke.of(!0));return h}function gh(e){return Array.isArray(e)?e:[e]}function hh(e,h,a){for(;e.value&&e.from<=a;)e.from==a&&h.push(e.value),e.next()}function le(e,h){return e.state.facet(Hb).formatNumber(h,e.state)}function ih(e){let h=9;for(;h<e;)h=10*h+9;return h}
function jh(e,h,a,b){switch(e){case -2:return a<h;case -1:return b>=h&&a<h;case 0:return a<h&&b>h;case 1:return a<=h&&b>h;case 2:return b>h;case 4:return!0}}function kh(e,h){for(h=e.childBefore(h);h;){let a=h.lastChild;if(!a||a.to!=h.to)break;a.type.isError&&a.from==a.to?(e=h,h=a.prevSibling):h=a}return e}function Ib(e,h,a,b){for(var c;e.from==e.to||(1>a?e.from>=h:e.from>h)||(-1<a?e.to<=h:e.to<h);){var d=!b&&e instanceof gb&&0>e.index?null:e.parent;if(!d)return e;e=d}d=b?0:ta.IgnoreOverlays;if(b)for(let f=
e,g=f.parent;g;f=g,g=f.parent)f instanceof gb&&0>f.index&&(null===(c=g.enter(h,a,d))||void 0===c?void 0:c.from)!=f.from&&(e=g);for(;;){b=e.enter(h,a,d);if(!b)return e;e=b}}function Oc(e,h,a,b){e=e.cursor();let c=[];if(!e.firstChild())return c;if(null!=a)for(;!e.type.is(a);)if(!e.nextSibling())return c;for(;;){if(null!=b&&e.type.is(b))return c;e.type.is(h)&&c.push(e.node);if(!e.nextSibling())return null==b?c:[]}}function Pc(e,h,a=h.length-1){for(e=e.parent;0<=a;e=e.parent){if(!e)return!1;if(!e.type.isAnonymous){if(h[a]&&
h[a]!=e.name)return!1;a--}}return!0}function me(e){return e.children.some(h=>h instanceof Jb||!h.type.isAnonymous||me(h))}function Cl(e){function h(B,z,G,T,M){let {id:Q,start:N,end:S,size:aa}=p;for(var O=t;0>aa;){p.next();if(-1==aa){G.push(m[Q]);T.push(N-B);return}if(-3==aa){r=Q;return}if(-4==aa){t=Q;return}throw new RangeError(`Unrecognized record size: ${aa}`);}var J=q[Q],w=N-B,x;if(x=S-N<=l){var L=p.pos-z;z=p.fork();var U=x=0;let qa=0,ha=z.end-l,Ga={size:0,start:0,skip:0};a:for(let lh=z.pos-L;z.pos>
lh;){let Qc=z.size;if(z.id==M&&0<=Qc){Ga.size=x;Ga.start=U;Ga.skip=qa;qa+=4;x+=4;z.next();continue}let mh=z.pos-Qc;if(0>Qc||mh<lh||z.start<ha)break;let ne=z.id>=n?4:0,Dl=z.start;for(z.next();z.pos>mh;){if(0>z.size)if(-3==z.size)ne+=4;else break a;else z.id>=n&&(ne+=4);z.next()}U=Dl;x+=Qc;qa+=ne}if(0>M||x==L)Ga.size=x,Ga.start=U,Ga.skip=qa;x=L=4<Ga.size?Ga:void 0}if(x){w=new Uint16Array(L.size-L.skip);J=p.pos-L.size;for(O=w.length;p.pos>J;)O=d(L.start,w,O);J=new Jb(w,S-L.start,k);w=L.start-B}else{L=
p.pos-aa;p.next();B=[];M=[];z=Q>=n?Q:-1;x=0;for(U=S;p.pos>L;)0<=z&&p.id==z&&0<=p.size?(p.end<=U-l&&(b(B,M,N,x,p.end,U,z,O),x=B.length,U=p.end),p.next()):h(N,L,B,M,z);0<=z&&0<x&&x<B.length&&b(B,M,N,x,N,U,z,O);B.reverse();M.reverse();-1<z&&0<x?(O=a(J),J=oe(J,B,M,0,B.length,0,S-N,O,O)):J=c(J,B,M,S-N,O-S)}G.push(J);T.push(w)}function a(B){return(z,G,T)=>{let M=0,Q=z.length-1,N,S;if(0<=Q&&(N=z[Q])instanceof ua){if(!Q&&N.type==B&&N.length==T)return N;if(S=N.prop(P.lookAhead))M=G[Q]+N.length+S}return c(B,
z,G,T,M)}}function b(B,z,G,T,M,Q,N,S){let aa=[],O=[];for(;B.length>T;)aa.push(B.pop()),O.push(z.pop()+G-M);B.push(c(k.types[N],aa,O,Q-M,S-Q));z.push(M-G)}function c(B,z,G,T,M=0,Q){if(r){let N=[P.contextHash,r];Q=Q?[N].concat(Q):[N]}25<M&&(M=[P.lookAhead,M],Q=Q?[M].concat(Q):[M]);return new ua(B,z,G,T,Q)}function d(B,z,G){let {id:T,start:M,end:Q,size:N}=p;p.next();if(0<=N&&T<n){let S=G;if(4<N){let aa=p.pos-(N-4);for(;p.pos>aa;)G=d(B,z,G)}z[--G]=S;z[--G]=Q-B;z[--G]=M-B;z[--G]=T}else-3==N?r=T:-4==N&&
(t=T);return G}var f;let {buffer:g,nodeSet:k,maxBufferLength:l=1024,reused:m=[],minRepeatType:n=k.types.length}=e,p=Array.isArray(g)?new nh(g,g.length):g,q=k.types,r=0,t=0,v=[],C=[];for(;0<p.pos;)h(e.start||0,e.bufferStart||0,v,C,-1);let F=null!==(f=e.length)&&void 0!==f?f:v.length?C[0]+v[0].length:0;return new ua(q[e.topID],v.reverse(),C.reverse(),F)}function Rc(e,h){if(!e.isAnonymous||h instanceof Jb||h.type!=e)return 1;let a=oh.get(h);if(null==a){a=1;for(let b of h.children){if(b.type!=e||!(b instanceof
ua)){a=1;break}a+=Rc(e,b)}oh.set(h,a)}return a}function oe(e,h,a,b,c,d,f,g,k){function l(r,t,v,C,F){for(;v<C;){let z=v;var B=t[v];let G=Rc(e,r[v]);for(v++;v<C;v++){let T=Rc(e,r[v]);if(G+T>=n)break;G+=T}if(v==z+1){if(G>n){B=r[z];l(B.children,B.positions,0,B.children.length,t[z]+F);continue}p.push(r[z])}else p.push(oe(e,r,t,z,v,B,t[v-1]+r[v-1].length-B,null,k));q.push(B+F-d)}}let m=0;for(let r=b;r<c;r++)m+=Rc(e,h[r]);let n=Math.ceil(1.5*m/8),p=[],q=[];l(h,a,b,c,0);return(g||k)(p,q,f)}function El(e,
h){return e.length==h.length&&e.every((a,b)=>a==h[b])}function ph(e){let h=[e];for(let a=0;a<e.length;a++)for(let b of ph(e.slice(0,a).concat(e.slice(a+1))))h.push(b);return h}function qh(e,h){let a=Object.create(null);for(let d of e)if(Array.isArray(d.tag))for(let f of d.tag)a[f.id]=d.class;else a[d.tag.id]=d.class;let {scope:b,all:c=null}=h||{};return{style:d=>{let f=c;for(let g of d)for(let k of g.set)if(d=a[k.id]){f=f?f+" "+d:d;break}return f},scope:b}}function Fl(e,h){let a=null;for(let b of e)(e=
b.style(h))&&(a=a?a+" "+e:e);return a}function Gl(e,h,a,b=0,c=e.length){h=new Hl(b,Array.isArray(h)?h:[h],a);h.highlightRange(e.cursor(),b,c,"",h.highlighters);h.flush(c)}function rh(e,h,a){let b=e.facet(hb);if(!b)return null;let c=b.data;if(b.allowsNesting)for(e=ra(e).topNode;e;e=e.enter(h,a,ta.ExcludeBuffers))c=e.type.prop(Sc)||c;return c}function ra(e){return(e=e.field(Oa.state,!1))?e.tree:ua.empty}function sh(e,h,a){return Kb.applyChanges(e,[{fromA:h,toA:a,fromB:h,toB:a}])}function Tc(e){let h=
e.facet(pe);return 9==h.charCodeAt(0)?e.tabSize*h.length:h.length}function gc(e,h){let a="",b=e.tabSize;if(9==e.facet(pe).charCodeAt(0))for(;h>=b;)a+="\t",h-=b;for(e=0;e<h;e++)a+=" ";return a}function qe(e,h){e instanceof R&&(e=new Uc(e));for(var a of e.state.facet(Il)){let b=a(e,h);if(null!=b)return b}return h=(a=ra(e.state))?th(a.resolveInner(h).enterUnfinishedNodesBefore(h),h,e):null}function Jl(e){var h=e.type.prop(Kl);if(h)return h;h=e.firstChild;let a;if(h&&(a=h.type.prop(P.closedBy))){let b=
e.lastChild,c=b&&-1<a.indexOf(b.name);return d=>{var f=!c||d.pos==d.options.simulateBreak&&d.options.simulateDoubleBreak?void 0:b.from,g=d.textAfter.match(/^\s*/)[0].length;f=f==d.pos+g;b:{g=d.node;let m=g.childAfter(g.from),n=g.lastChild;if(m){var k=d.options.simulateBreak,l=d.state.doc.lineAt(m.from);k=null==k||k<=l.from?l.to:Math.min(l.to,k);for(l=m.to;;){l=g.childAfter(l);if(!l||l==n){g=null;break b}if(!l.type.isSkipped){g=l.from<k?m:null;break b}l=l.to}}else g=null}d=g?f?d.column(g.from):d.column(g.to):
d.baseIndent+(f?0:1*d.unit);return d}}return null==e.parent?Ll:null}function th(e,h,a){for(;e;e=e.parent){let b=Jl(e);if(b)return b(uh.create(a,h,e))}return null}function Ll(){return 0}function Vc(e,h,a){for(var b of e.facet(Ml)){var c=b(e,h,a);if(c)return c}c=ra(e);if(c.length<a)e=null;else{var d=c.resolveInner(a);for(b=null;d;d=d.parent)if(!(d.to<=a||d.from>a)){if(b&&d.from<h)break;var f=d.type.prop(Nl),g;(g=f)&&!(g=d.to<c.length-50||c.length==e.doc.length)&&(g=d.lastChild,g=!(g&&g.to==d.to&&g.type.isError));
g&&(f=f(d,e))&&f.from<=a&&f.from>=h&&f.to>a&&(b=f)}e=b}return e}function vh(e,h){let a=h.mapPos(e.from,1);e=h.mapPos(e.to,-1);return a>=e?void 0:{from:a,to:e}}function wh(e){let h=[];for(let {head:a}of e.state.selection.ranges)h.some(b=>b.from<=a&&b.to>=a)||h.push(e.lineBlockAt(a));return h}function Wc(e,h,a){var b;let c=null;null===(b=e.field(tb,!1))||void 0===b?void 0:b.between(h,a,(d,f)=>{if(!c||c.from>d)c={from:d,to:f}});return c}function Ol(e,h,a){let b=!1;e.between(h,h,(c,d)=>{c==h&&d==a&&(b=
!0)});return b}function xh(e,h){return e.field(tb,!1)?h:h.concat(K.appendConfig.of(yh()))}function zh(e,h,a=!0){let b=e.state.doc.lineAt(h.from).number;h=e.state.doc.lineAt(h.to).number;return I.announce.of(`${e.state.phrase(a?"Folded lines":"Unfolded lines")} ${b} ${e.state.phrase("to")} ${h}.`)}function yh(e){let h=[tb,Pl];e&&h.push(Ah.of(e));return h}function re(e){let h=e.facet(se);return h.length?h:e.facet(Bh)}function Ql(e){let h=[],a=e.matched?Rl:Sl;h.push(a.range(e.start.from,e.start.to));
e.end&&h.push(a.range(e.end.from,e.end.to));return h}function te(e,h,a){let b=e.prop(0>h?P.openedBy:P.closedBy);return b?b:1==e.name.length&&(e=a.indexOf(e.name),-1<e&&e%2==(0>h?1:0))?[a[e+h]]:null}function Pa(e,h,a,b={}){var c=b.maxScanDistance||1E4;b=b.brackets||"()[]{}";var d=ra(e),f=d.resolveInner(h,a);for(var g=f;g;g=g.parent){var k=te(g.type,a,b);if(k&&g.from<g.to){a:{h=a;a=g;c=k;g=a.parent;d={from:a.from,to:a.to};k=0;if((g=null===g||void 0===g?void 0:g.cursor())&&(0>h?g.childBefore(a.from):
g.childAfter(a.to))){do if(0>h?g.to<=a.from:g.from>=a.to)if(0==k&&-1<c.indexOf(g.type.name)&&g.from<g.to){b={start:d,end:{from:g.from,to:g.to},matched:!0};break a}else if(te(g.type,h,b))k++;else if(te(g.type,-h,b)&&(k--,0==k)){b={start:d,end:g.from==g.to?void 0:{from:g.from,to:g.to},matched:!1};break a}while(0>h?g.prevSibling():g.nextSibling())}b={start:d,matched:!1}}return b}}a:if(k=f.type,g=0>a?e.sliceDoc(h-1,h):e.sliceDoc(h,h+1),f=b.indexOf(g),0>f||0==f%2!=0<a)b=null;else{g={from:0>a?h-1:h,to:0<
a?h+1:h};e=e.doc.iterRange(h,0<a?e.doc.length:0);var l=0;for(let m=0;!e.next().done&&m<=c;){let n=e.value;0>a&&(m+=n.length);let p=h+m*a;for(let q=0<a?0:n.length-1,r=0<a?n.length:-1;q!=r;q+=a){let t=b.indexOf(n[q]);if(!(0>t||d.resolve(p+q,1).type!=k))if(0==t%2==0<a)l++;else if(1==l){b={start:g,end:{from:p+q,to:p+q+1},matched:t>>1==f>>1};break a}else l--}0<a&&(m+=n.length)}b=e.done?{start:g,matched:!1}:null}return b}function ue(e,h){-1<Ch.indexOf(e)||(Ch.push(e),console.warn(h))}function Tl(e,h){var a=
null;for(var b of h.split(".")){var c=e[b]||A[b];c?"function"==typeof c?a?a=c(a):ue(b,`Modifier ${b} used at start of tag`):a?ue(b,`Tag ${b} used as modifier`):a=c:ue(b,`Unknown highlighting tag ${b}`)}if(!a)return 0;e=h.replace(/ /g,"_");h=Ma;b=h.define;c=Dh.length;a={[e]:a};let d=Object.create(null);for(l in a){let m=a[l];Array.isArray(m)||(m=[m]);for(let n of l.split(" "))if(n){var f=[];let p=2;var g=n;for(var k=0;;){if("..."==g&&0<k&&k+3==n.length){p=1;break}g=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(g);
if(!g)throw new RangeError("Invalid path: "+n);f.push("*"==g[0]?"":'"'==g[0][0]?JSON.parse(g[0]):g[0]);k+=g[0].length;if(k==n.length)break;g=n[k++];if(k==n.length&&"!"==g){p=0;break}if("/"!=g)throw new RangeError("Invalid path: "+n);g=n.slice(k)}g=f.length-1;k=f[g];if(!k)throw new RangeError("Invalid path: "+n);f=new Ul(m,p,0<g?f.slice(0,g):null);d[k]=f.sort(d[k])}}var l=Eh.add(d);l=b.call(h,{id:c,name:e,props:[l]});Dh.push(l);return l.id}function ve(e,h){return({state:a,dispatch:b})=>{if(a.readOnly)return!1;
let c=e(h,a);if(!c)return!1;b(a.update(c));return!0}}function we(e,h=e.selection.main.head){e=e.languageDataAt("commentTokens",h);return e.length?e[0]:{}}function Vl(e,{open:h,close:a},b,c){var d=e.sliceDoc(b-hc,b),f=e.sliceDoc(c,c+hc),g=/\s*$/.exec(d)[0].length,k=/^\s*/.exec(f)[0].length;let l=d.length-g;if(d.slice(l-h.length,l)==h&&f.slice(k,k+a.length)==a)return{open:{pos:b-g,margin:g&&1},close:{pos:c+k,margin:k&&1}};c-b<=2*hc?d=e=e.sliceDoc(b,c):(d=e.sliceDoc(b,b+hc),e=e.sliceDoc(c-hc,c));f=/^\s*/.exec(d)[0].length;
g=/\s*$/.exec(e)[0].length;k=e.length-g-a.length;return d.slice(f,f+h.length)==h&&e.slice(k,k+a.length)==a?{open:{pos:b+f+h.length,margin:/\s/.test(d.charAt(f+h.length))?1:0},close:{pos:c-g-a.length,margin:/\s/.test(e.charAt(k-1))?1:0}}:null}function Fh(e,h,a=h.selection.ranges){let b=a.map(d=>we(h,d.from).block);if(!b.every(d=>d))return null;let c=a.map((d,f)=>Vl(h,b[f],d.from,d.to));if(2!=e&&!c.every(d=>d))return{changes:h.changes(a.map((d,f)=>c[f]?[]:[{from:d.from,insert:b[f].open+" "},{from:d.to,
insert:" "+b[f].close}]))};if(1!=e&&c.some(d=>d)){e=[];for(let d=0,f;d<c.length;d++)if(f=c[d]){a=b[d];let {open:g,close:k}=f;e.push({from:g.pos-a.open.length,to:g.pos+g.margin},{from:k.pos-k.margin,to:k.pos+a.close.length})}return{changes:e}}return null}function Wl(e){let h=0;e.iterChangedRanges((a,b)=>h=b);return h}function Xc(e,h){return function({state:a,dispatch:b}){if(!h&&a.readOnly)return!1;let c=a.field(Gh,!1);if(!c)return!1;a=c.pop(e,a,h);if(!a)return!1;b(a);return!0}}function Yc(e,h,a,b){e=
e.slice(h+1>a+20?h-a-1:0,h);e.push(b);return e}function Xl(e,h){let a=[],b=!1;e.iterChangedRanges((c,d)=>a.push(c,d));h.iterChangedRanges((c,d,f,g)=>{for(c=0;c<a.length;){d=a[c++];let k=a[c++];g>=d&&f<=k&&(b=!0)}});return b}function Yl(e,h){return e.ranges.length==h.ranges.length&&0===e.ranges.filter((a,b)=>a.empty!=h.ranges[b].empty).length}function Hh(e,h){return e.length?h.length?e.concat(h):e:h}function Ih(e,h){if(e.length){let a=e[e.length-1],b=a.selectionsAfter.slice(Math.max(0,a.selectionsAfter.length-
Zl));if(b.length&&b[b.length-1].eq(h))return e;b.push(h);return Yc(e,e.length-1,1E9,a.setSelAfter(b))}return[Aa.selection([h])]}function xe(e,h){if(!e.length)return e;let a=e.length;for(var b=Ha;a;){b=$l(e[a-1],h,b);if(b.changes&&!b.changes.empty||b.effects.length)return e=e.slice(0,a),e[a-1]=b,e;h=b.mapped;a--;b=b.selectionsAfter}return b.length?[Aa.selection(b)]:Ha}function $l(e,h,a){a=Hh(e.selectionsAfter.length?e.selectionsAfter.map(f=>f.map(h)):Ha,a);if(!e.changes)return Aa.selection(a);let b=
e.changes.map(h),c=h.mapDesc(e.changes,!0),d=e.mapped?e.mapped.composeDesc(c):c;return new Aa(b,K.mapEffects(e.effects,h),d,e.startSelection.map(c),a)}function Lb(e,h){return u.create(e.ranges.map(h),e.mainIndex)}function Qa(e,h){return e.update({selection:h,scrollIntoView:!0,userEvent:"select"})}function Ya({state:e,dispatch:h},a){a=Lb(e.selection,a);if(a.eq(e.selection))return!1;h(Qa(e,a));return!0}function Jh(e,h){return Ya(e,a=>a.empty?e.moveByChar(a,h):u.cursor(h?a.to:a.from))}function Ia(e){return e.textDirectionAt(e.state.selection.main.head)==
ca.LTR}function Kh(e,h){return Ya(e,a=>a.empty?e.moveByGroup(a,h):u.cursor(h?a.to:a.from))}function Zc(e,h,a){let b=ra(e).resolveInner(h.head),c=a?P.closedBy:P.openedBy;for(h=h.head;;){let k=a?b.childAfter(h):b.childBefore(h);if(!k)break;a:{var d=e;var f=k;if(f.type.prop(c)){d=!0;break a}let l=f.to-f.from;d=l&&(2<l||/[^\s,.;:]/.test(d.sliceDoc(f.from,f.to)))||f.firstChild}d?b=k:h=a?k.to:k.from}let g;e=b.type.prop(c)&&(g=a?Pa(e,b.from,1):Pa(e,b.to,-1))&&g.matched?a?g.end.to:g.end.from:a?b.to:b.from;
return u.cursor(e,a?-1:1)}function Lh(e,h){return Ya(e,a=>{if(!a.empty)return u.cursor(h?a.to:a.from);let b=e.moveVertically(a,h);return b.head!=a.head?b:e.moveToLineBoundary(a,h)})}function Mh(e,h){let {state:a}=e,b=Lb(a.selection,g=>g.empty?e.moveVertically(g,h,Math.min(e.dom.clientHeight,innerHeight)):u.cursor(h?g.to:g.from));if(b.eq(a.selection))return!1;let c=e.coordsAtPos(a.selection.main.head),d=e.scrollDOM.getBoundingClientRect(),f;c&&c.top>d.top&&c.bottom<d.bottom&&c.top-d.top<=e.scrollDOM.scrollHeight-
e.scrollDOM.scrollTop-e.scrollDOM.clientHeight&&(f=I.scrollIntoView(b.main.head,{y:"start",yMargin:c.top-d.top}));e.dispatch(Qa(a,b),{effects:f});return!0}function $c(e,h,a){let b=e.lineBlockAt(h.head),c=e.moveToLineBoundary(h,a);c.head==h.head&&c.head!=(a?b.to:b.from)&&(c=e.moveToLineBoundary(h,a,!1));!a&&c.head==b.from&&b.length&&(e=/^\s*/.exec(e.state.sliceDoc(b.from,Math.min(b.from+100,b.to)))[0].length)&&h.head!=b.from+e&&(c=u.cursor(b.from+e));return c}function am(e,h,a){let b=!1,c=Lb(e.selection,
d=>{var f=Pa(e,d.head,-1)||Pa(e,d.head,1)||0<d.head&&Pa(e,d.head-1,1)||d.head<e.doc.length&&Pa(e,d.head+1,-1);if(!f||!f.end)return d;b=!0;f=f.start.from==d.head?f.end.to:f.end.from;return a?u.range(d.anchor,f):u.cursor(f)});if(!b)return!1;h(Qa(e,c));return!0}function Ra(e,h){let a=Lb(e.state.selection,b=>{let c=h(b);return u.range(b.anchor,c.head,c.goalColumn)});if(a.eq(e.state.selection))return!1;e.dispatch(Qa(e.state,a));return!0}function Nh(e,h){return Ra(e,a=>e.moveByChar(a,h))}function Oh(e,
h){return Ra(e,a=>e.moveByGroup(a,h))}function Ph(e,h){return Ra(e,a=>e.moveVertically(a,h))}function Qh(e,h){return Ra(e,a=>e.moveVertically(a,h,Math.min(e.dom.clientHeight,innerHeight)))}function ad({state:e,dispatch:h},a){if(e.readOnly)return!1;let b="delete.selection",c=e.changeByRange(d=>{let {from:f,to:g}=d;if(f==g){let k=a(f);k<f?b="delete.backward":k>f&&(b="delete.forward");f=Math.min(f,k);g=Math.max(g,k)}return f==g?{range:d}:{changes:{from:f,to:g},range:u.cursor(f)}});if(c.changes.empty)return!1;
h(e.update(c,{scrollIntoView:!0,userEvent:b}));return!0}function bd(e,h,a){if(e instanceof I)for(let b of e.state.facet(I.atomicRanges).map(c=>c(e)))b.between(h,h,(c,d)=>{c<h&&d>h&&(h=a?d:c)});return h}function cd(e){let h=[];var a=-1;for(let b of e.selection.ranges){let c=e.doc.lineAt(b.from),d=e.doc.lineAt(b.to);b.empty||b.to!=d.from||(d=e.doc.lineAt(b.to-1));a>=c.number?(a=h[h.length-1],a.to=d.to,a.ranges.push(b)):h.push({from:c.from,to:d.to,ranges:[b]});a=d.number+1}return h}function Rh(e,h,a){if(e.readOnly)return!1;
let b=[],c=[];for(let d of cd(e)){if(a?d.to==e.doc.length:0==d.from)continue;let f=e.doc.lineAt(a?d.to+1:d.from-1),g=f.length+1;if(a){b.push({from:d.to,to:f.to},{from:d.from,insert:f.text+e.lineBreak});for(let k of d.ranges)c.push(u.range(Math.min(e.doc.length,k.anchor+g),Math.min(e.doc.length,k.head+g)))}else{b.push({from:f.from,to:d.from},{from:d.to,insert:e.lineBreak+f.text});for(let k of d.ranges)c.push(u.range(k.anchor-g,k.head-g))}}if(!b.length)return!1;h(e.update({changes:b,scrollIntoView:!0,
selection:u.create(c,e.selection.mainIndex),userEvent:"move.line"}));return!0}function Sh(e,h,a){if(e.readOnly)return!1;let b=[];for(let c of cd(e))a?b.push({from:c.from,insert:e.doc.slice(c.from,c.to)+e.lineBreak}):b.push({from:c.to,insert:e.lineBreak+e.doc.slice(c.from,c.to)});h(e.update({changes:b,scrollIntoView:!0,userEvent:"input.copyline"}));return!0}function Th(e){return({state:h,dispatch:a})=>{if(h.readOnly)return!1;let b=h.changeByRange(c=>{let {from:d,to:f}=c;c=h.doc.lineAt(d);var g;if(g=
!e&&d==f)if(g=d,/\(\)|\[\]|\{\}/.test(h.sliceDoc(g-1,g+1)))g={from:g,to:g};else{var k=ra(h).resolveInner(g),l=k.childBefore(g);k=k.childAfter(g);var m;g=l&&k&&l.to<=g&&k.from>=g&&(m=l.type.prop(P.closedBy))&&-1<m.indexOf(k.name)&&h.doc.lineAt(l.to).from==h.doc.lineAt(k.from).from?{from:l.to,to:k.from}:null}m=g;e&&(d=f=(f<=c.to?c:h.doc.lineAt(f)).to);l=new Uc(h,{simulateBreak:d,simulateDoubleBreak:!!m});g=qe(l,d);null==g&&(g=/^\s*/.exec(h.doc.lineAt(d).text)[0].length);for(;f<c.to&&/\s/.test(c.text[f-
c.from]);)f++;m?{from:d,to:f}=m:d>c.from&&d<c.from+100&&!/\S/.test(c.text.slice(0,d))&&(d=c.from);g=["",gc(h,g)];m&&g.push(gc(h,l.lineIndent(c.from,-1)));return{changes:{from:d,to:f,insert:V.of(g)},range:u.cursor(d+1+g[1].length)}});a(h.update(b,{scrollIntoView:!0,userEvent:"input"}));return!0}}function ye(e,h){let a=-1;return e.changeByRange(b=>{let c=[];for(var d=b.from;d<=b.to;)d=e.doc.lineAt(d),d.number>a&&(b.empty||b.to>d.from)&&(h(d,c,b),a=d.number),d=d.to+1;d=e.changes(c);return{changes:c,
range:u.range(d.mapPos(b.anchor,1),d.mapPos(b.head,1))}})}function Y(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var h=1,a=arguments[1];if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a)){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b)){var c=a[b];"string"==typeof c?e.setAttribute(b,c):null!=c&&(e[b]=c)}h++}for(;h<arguments.length;h++)Uh(e,arguments[h]);return e}function Uh(e,h){if("string"==typeof h)e.appendChild(document.createTextNode(h));else if(null!=
h)if(null!=h.nodeType)e.appendChild(h);else if(Array.isArray(h))for(var a=0;a<h.length;a++)Uh(e,h[a]);else throw new RangeError("Unsupported child node: "+h);}function ze(e){function h(){var b=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(a.value);if(b){var {state:c}=e,d=c.doc.lineAt(c.selection.main.head),[,f,g,k,l]=b;b=k?+k.slice(1):0;var m=g?+g:d.number;g&&l?(m/=100,f&&(m=m*("-"==f?-1:1)+d.number/c.doc.lines),m=Math.round(c.doc.lines*m)):g&&f&&(m=m*("-"==f?-1:1)+d.number);c=c.doc.line(Math.max(1,Math.min(c.doc.lines,
m)));e.dispatch({effects:dd.of(!1),selection:u.cursor(c.from+Math.max(0,Math.min(b,c.length))),scrollIntoView:!0});e.focus()}}let a=Y("input",{class:"cm-textfield",name:"line"});return{dom:Y("form",{class:"cm-gotoLine",onkeydown:b=>{27==b.keyCode?(b.preventDefault(),e.dispatch({effects:dd.of(!1)}),e.focus()):13==b.keyCode&&(b.preventDefault(),h())},onsubmit:b=>{b.preventDefault();h()}},Y("label",e.state.phrase("Go to line"),": ",a)," ",Y("button",{class:"cm-button",type:"submit"},e.state.phrase("go")))}}
function Vh(e,h,a,b){return(0==a||e(h.sliceDoc(a-1,a))!=va.Word)&&(b==h.doc.length||e(h.sliceDoc(b,b+1))!=va.Word)}function bm(e,h){let {main:a,ranges:b}=e.selection;var c=e.wordAt(a.head);c=c&&c.from==a.from&&c.to==a.to;for(let d=!1,f=new Mb(e.doc,h,b[b.length-1].to);;)if(f.next(),f.done){if(d)return null;f=new Mb(e.doc,h,0,Math.max(0,b[b.length-1].from-1));d=!0}else if(!d||!b.some(g=>g.from==f.value.from)){if(c){let g=e.wordAt(f.value.from);if(!g||g.from!=f.value.from||g.to!=f.value.to)continue}return f.value}}
function Nb(e,h,a,b){return new Mb(h,e.unquoted,a,b,e.caseSensitive?void 0:c=>c.toLowerCase())}function Ob(e,h,a,b){return new Wh(h,e.search,e.caseSensitive?void 0:{ignoreCase:!0},a,b)}function ic(e){return h=>{let a=h.state.field(ib,!1);return a&&a.query.spec.valid?e(h,a):Xh(h)}}function Ae(e){return e.state.facet(Be).createPanel(e)}function Ce(e,h){var a,b=e.selection.main;b=b.empty||b.to>b.from+100?"":e.sliceDoc(b.from,b.to);let c=null!==(a=null===h||void 0===h?void 0:h.caseSensitive)&&void 0!==
a?a:e.facet(Be).caseSensitive;return h&&!b?h:new Yh({search:b.replace(/\n/g,"\\n"),caseSensitive:c})}function De(e,{from:h,to:a}){var b=e.state.doc.lineAt(h).from,c=e.state.doc.lineAt(a).to;let d=Math.max(b,h-ed),f=Math.min(c,a+ed);a=e.state.sliceDoc(d,f);if(d!=b)for(b=0;b<ed;b++)if(!fd.test(a[b+1])&&fd.test(a[b])){a=a.slice(b);break}if(f!=c)for(c=a.length-1;c>a.length-ed;c--)if(!fd.test(a[c-1])&&fd.test(a[c])){a=a.slice(0,c);break}return I.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${e.state.doc.lineAt(h).number}`)}
function Zh(e){e=Object.keys(e).join("");let h=/\w/.test(e);h&&(e=e.replace(/\w/g,""));return`[${h?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function cm(e){var h=Object.create(null);let a=Object.create(null);for(let {label:b}of e)for(h[b[0]]=!0,e=1;e<b.length;e++)a[b[e]]=!0;h=Zh(h)+Zh(a)+"*$";return[new RegExp("^"+h),new RegExp(h)]}function dm(e){let h=e.map(c=>"string"==typeof c?{label:c}:c),[a,b]=h.every(c=>/^\w+$/.test(c.label))?[/\w*$/,/\w+$/]:cm(h);return c=>{let d=c.matchBefore(b);return d||
c.explicit?{from:d?d.from:c.pos,options:h,validFor:a}:null}}function jb(e){return e.selection.main.head}function $h(e,h){var a;let {source:b}=e;h=h&&"^"!=b[0];let c="$"!=b[b.length-1];return h||c?new RegExp(`${h?"^":""}(?:${b})${c?"$":""}`,null!==(a=e.flags)&&void 0!==a?a:e.ignoreCase?"i":""):e}function em(e,h,a,b){return Object.assign(Object.assign({},e.changeByRange(c=>{if(c==e.selection.main)return{changes:{from:a,to:b,insert:h},range:u.cursor(a+h.length)};let d=b-a;return!c.empty||d&&e.sliceDoc(c.from-
d,c.from)!=e.sliceDoc(a,b)?{range:c}:{changes:{from:c.from-d,to:c.from,insert:h},range:u.cursor(c.from-d+h.length)}})),{userEvent:"input.complete"})}function ai(e,h){const a=h.completion.apply||h.completion.label;let b=h.source;"string"==typeof a?e.dispatch(em(e.state,a,b.from,b.to)):a(e,h.completion,b.from,b.to)}function fm(e){if(!Array.isArray(e))return e;let h=bi.get(e);h||bi.set(e,h=dm(e));return h}function gm(e){let h=e.addToOptions.slice();e.icons&&h.push({render(a){let b=document.createElement("div");
b.classList.add("cm-completionIcon");a.type&&b.classList.add(...a.type.split(/\s+/g).map(c=>"cm-completionIcon-"+c));b.setAttribute("aria-hidden","true");return b},position:20});h.push({render(a,b,c){b=document.createElement("span");b.className="cm-completionLabel";({label:a}=a);var d=0;for(let f=1;f<c.length;){let g=c[f++],k=c[f++];g>d&&b.appendChild(document.createTextNode(a.slice(d,g)));d=b.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(a.slice(g,k)));d.className=
"cm-completionMatchedText";d=k}d<a.length&&b.appendChild(document.createTextNode(a.slice(d)));return b},position:50},{render(a){if(!a.detail)return null;let b=document.createElement("span");b.className="cm-completionDetail";b.textContent=a.detail;return b},position:80});return h.sort((a,b)=>a.position-b.position).map(a=>a.render)}function ci(e,h,a){if(e<=a)return{from:0,to:e};if(h<=e>>1)return e=Math.floor(h/a),{from:e*a,to:(e+1)*a};h=Math.floor((e-h)/a);return{from:e-(h+1)*a,to:e-h*a}}function hm(e){return h=>
new im(h,e)}function di(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}function jm(e,h){let a=[];var b=0;for(let d of e)if(d.hasResult())if(!1===d.result.filter){e=d.result.getMatch;for(let f of d.result.options){var c=[1E9-b++];if(e)for(let g of e(f))c.push(g);a.push(new ei(f,d,c))}}else{e=new km(h.sliceDoc(d.from,d.to));for(let f of d.result.options)if(c=e.match(f.label))null!=f.boost&&(c[0]+=f.boost),a.push(new ei(f,d,c))}h=[];b=null;for(let d of a.sort(lm))!b||b.label!=d.completion.label||
b.detail!=d.completion.detail||null!=b.type&&null!=d.completion.type&&b.type!=d.completion.type||b.apply!=d.completion.apply?h.push(d):di(d.completion)>di(b)&&(h[h.length-1]=d),b=d.completion;return h}function mm(e,h){if(e==h)return!0;for(let a=0,b=0;;){for(;a<e.length&&!e[a].hasResult;)a++;for(;b<h.length&&!h[b].hasResult;)b++;let c=a==e.length,d=b==h.length;if(c||d)return c==d;if(e[a++].result!=h[b++].result)return!1}}function fi(e,h){return{"aria-autocomplete":"list","aria-haspopup":"listbox",
"aria-activedescendant":e+"-"+h,"aria-controls":e}}function lm(e,h){let a=h.match[0]-e.match[0];return a?a:e.completion.label.localeCompare(h.completion.label)}function Ee(e){return e.isUserEvent("input.type")?"input":e.isUserEvent("delete.backward")?"delete":null}function gd(e,h="option"){return a=>{var b=a.state.field(Ja,!1);if(!b||!b.open||75>Date.now()-b.open.timestamp)return!1;var c=1,d,f;if(f="page"==h)f=b.open.tooltip,(d=a.plugin(gi))?(f=d.manager.tooltips.indexOf(f),d=0>f?null:d.manager.tooltipViews[f]):
d=null,f=d;f&&(c=Math.max(2,Math.floor(d.dom.offsetHeight/d.dom.querySelector("li").offsetHeight)-1));c=b.open.selected+c*(e?1:-1);({length:b}=b.open.options);0>c?c="page"==h?0:b-1:c>=b&&(c="page"==h?b-1:0);a.dispatch({effects:hi.of(c)});return!0}}function ii(e){for(let h=0;8>h;h+=2)if("()[]{}<>".charCodeAt(h)==e)return"()[]{}<>".charAt(h+1);return Kd(128>e?e:e+1)}function ji(e,h){let a=!1;e.field(ki).between(0,e.doc.length,b=>{b==h&&(a=!0)});return a}function hd(e,h){e=e.sliceString(h,h+2);return e.slice(0,
Fa(ma(e,0)))}function nm(e,h,a,b){let c=null,d=e.changeByRange(f=>{if(!f.empty)return{changes:[{insert:h,from:f.from},{insert:a,from:f.to}],effects:ub.of(f.to+h.length),range:u.range(f.anchor+h.length,f.head+h.length)};let g=hd(e.doc,f.head);return!g||/\s/.test(g)||-1<b.indexOf(g)?{changes:{insert:h+a,from:f.head},effects:ub.of(f.head+h.length),range:u.cursor(f.head+h.length)}:{range:c=f}});return c?null:e.update(d,{scrollIntoView:!0,userEvent:"input.type"})}function om(e,h,a){let b=null;h=e.selection.ranges.map(c=>
c.empty&&hd(e.doc,c.head)==a?u.cursor(c.head+a.length):b=c);return b?null:e.update({selection:u.create(h,e.selection.mainIndex),scrollIntoView:!0,effects:e.selection.ranges.map(({from:c})=>Fe.of(c))})}function pm(e,h,a){let b=null,c=e.changeByRange(d=>{if(!d.empty)return{changes:[{insert:h,from:d.from},{insert:h,from:d.to}],effects:ub.of(d.to+h.length),range:u.range(d.anchor+h.length,d.head+h.length)};let f=d.head;var g=hd(e.doc,f);if(g==h){if(li(e,f))return{changes:{insert:h+h,from:f},effects:ub.of(f+
h.length),range:u.cursor(f+h.length)};if(ji(e,f))return d=a&&e.sliceDoc(f,f+3*h.length)==h+h+h,{range:u.cursor(f+h.length*(d?3:1)),effects:Fe.of(f)}}else{if(a&&e.sliceDoc(f-2*h.length,f)==h+h&&li(e,f-2*h.length))return{changes:{insert:h+h+h+h,from:f},effects:ub.of(f+h.length),range:u.cursor(f+h.length)};if(e.charCategorizer(f)(g)!=va.Word){g=e.sliceDoc(f-1,f);if(g=g!=h&&e.charCategorizer(f)(g)!=va.Word){a:{var k=ra(e).resolveInner(f,-1);for(g=0;5>g;g++){if(e.sliceDoc(k.from,k.from+h.length)==h){g=
!0;break a}k=k.to==f&&k.parent;if(!k)break}g=!1}g=!g}if(g)return{changes:{insert:h+h,from:f},effects:ub.of(f+h.length),range:u.cursor(f+h.length)}}}return{range:b=d}});return b?null:e.update(c,{scrollIntoView:!0,userEvent:"input.type"})}function li(e,h){e=ra(e).resolveInner(h+1);return e.parent&&e.from==h}function Pb(e,h=null,a=0){let b=null;e.between(a,1E9,(c,d,{spec:f})=>{if(!h||f.diagnostic==h)return b=new qm(c,d,f.diagnostic),!1});return b}function rm(e,h){return!(!e.effects.some(a=>a.is(Ge))&&
!e.changes.touchesRange(h.pos))}function mi(e,h){return e.field(Ba,!1)?h:h.concat(K.appendConfig.of([Ba,I.decorations.compute([Ba],a=>{let {selected:b,panel:c}=a.field(Ba);return b&&c&&b.from!=b.to?H.set([sm.range(b.from,b.to)]):H.none}),vl(tm,{hideOn:rm}),um]))}function tm(e,h,a){var {diagnostics:b}=e.state.field(Ba);let c=[],d=2E8,f=0;b.between(h-(0>a?1:0),h+(0<a?1:0),(g,k,{spec:l})=>{h>=g&&h<=k&&(g==k||(h>g||0<a)&&(h<k||0>a))&&(c.push(l.diagnostic),d=Math.min(g,d),f=Math.max(k,f))});(b=e.state.facet(Qb).tooltipFilter)&&
(c=b(c));return c.length?{pos:d,end:f,above:e.state.doc.lineAt(d).to<f,create(){return{dom:vm(e,c)}}}:null}function vm(e,h){return Y("ul",{class:"cm-tooltip-lint"},h.map(a=>ni(e,a,!1)))}function oi(e){let h=[];if(e)a:for(let {name:a}of e){for(e=0;e<a.length;e++){let b=a[e];if(/[a-zA-Z]/.test(b)&&!h.some(c=>c.toLowerCase()==b.toLowerCase())){h.push(b);continue a}}h.push("")}return h}function ni(e,h,a){var b;let c=a?oi(h.actions):[];return Y("li",{class:"cm-diagnostic cm-diagnostic-"+h.severity},Y("span",
{class:"cm-diagnosticText"},h.renderMessage?h.renderMessage():h.message),null===(b=h.actions)||void 0===b?void 0:b.map((d,f)=>{let g=n=>{n.preventDefault();(n=Pb(e.state.field(Ba).diagnostics,h))&&d.apply(e,n.from,n.to)},{name:k}=d,l=c[f]?k.indexOf(c[f]):-1,m=0>l?k:[k.slice(0,l),Y("u",k.slice(l,l+1)),k.slice(l+1)];return Y("button",{type:"button",class:"cm-diagnosticAction",onclick:g,onmousedown:g,"aria-label":` Action: ${k}${0>l?"":` (access key "${c[f]})"`}.`},m)}),h.source&&Y("div",{class:"cm-diagnosticSource"},
h.source))}function wm(e,h='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${h}>${encodeURIComponent(e)}</svg>')`}function He(e){return wm(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}function xm(e,h,a){return b=>{0>b.changes.inserted.length||h.write({file:b.view.state.doc.toString()})}}var ym=()=>null,sk=["create"],Gf={},Hf=function(e={},h=()=>null){let a={...e};return{set:function(b,
c,d){c=d(a[b]||{},c);a={...a,[b]:c};h(b)},get:function(b){return a[b]}}}({},function(e){(Gf[e]||ym)()}),cb=[];(new MutationObserver(e=>{e=[...e].map(vk).flatMap(h=>h);Kf(e)})).observe(document.body,{childList:!0,subtree:!0});var pi='input select textarea a[href] button [tabindex]:not(slot) audio[controls] video[controls] [contenteditable]:not([contenteditable="false"]) details>summary:first-of-type details'.split(" "),id=pi.join(","),qi="undefined"===typeof Element,vb=qi?function(){}:Element.prototype.matches||
Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,jd=!qi&&Element.prototype.getRootNode?function(e){return e.getRootNode()}:function(e){return e.ownerDocument},ri=function(e,h,a){var b=Array.prototype.slice.apply(e.querySelectorAll(id));h&&vb.call(e,id)&&b.unshift(e);return b=b.filter(a)},si=function c(h,a,b){for(var d=[],f=Array.from(h);f.length;){var g=f.shift();if("SLOT"===g.tagName){var k=g.assignedElements();k=c(k.length?k:g.children,!0,b);b.flatten?d.push.apply(d,
k):d.push({scopeParent:g,candidates:k})}else{vb.call(g,id)&&b.filter(g)&&(a||!h.includes(g))&&d.push(g);k=g.shadowRoot||"function"===typeof b.getShadowRoot&&b.getShadowRoot(g);var l=!b.shadowRootFilter||b.shadowRootFilter(g);k&&l?(k=c(!0===k?g.children:k.children,!0,b),b.flatten?d.push.apply(d,k):d.push({scopeParent:g,candidates:k})):f.unshift.apply(f,g.children)}}return d},ti=function(h,a){return 0>h.tabIndex&&(a||/^(AUDIO|VIDEO|DETAILS)$/.test(h.tagName)||h.isContentEditable)&&isNaN(parseInt(h.getAttribute("tabindex"),
10))?0:h.tabIndex},zm=function(h,a){return h.tabIndex===a.tabIndex?h.documentOrder-a.documentOrder:h.tabIndex-a.tabIndex},Am=function(h){return"DETAILS"===h.tagName&&Array.prototype.slice.apply(h.children).some(function(a){return"SUMMARY"===a.tagName})},Bm=function(h,a){for(var b=0;b<h.length;b++)if(h[b].checked&&h[b].form===a)return h[b]},Cm=function(h){if(!h.name)return!0;var a=h.form||jd(h),b=function(d){return a.querySelectorAll('input[type="radio"][name="'+d+'"]')};if("undefined"!==typeof window&&
"undefined"!==typeof window.CSS&&"function"===typeof window.CSS.escape)var c=b(window.CSS.escape(h.name));else try{c=b(h.name)}catch(d){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",d.message),!1}b=Bm(c,h.form);return!b||b===h},ui=function(h){h=h.getBoundingClientRect();var a=h.height;return 0===h.width&&0===a},Dm=function(h,a){var b=a.displayCheck;a=a.getShadowRoot;if("hidden"===getComputedStyle(h).visibility)return!0;
var c=vb.call(h,"details>summary:first-of-type")?h.parentElement:h;if(vb.call(c,"details:not([open]) *"))return!0;if(!b||"full"===b||"legacy-full"===b){if("function"===typeof a){for(c=h;h;){var d=h.parentElement,f=jd(h);if(d&&!d.shadowRoot&&!0===a(d))return ui(h);h=h.assignedSlot?h.assignedSlot:d||f===h.ownerDocument?d:f.host}h=c}a=h;var g;c=jd(a).host;for(d=!!(null!==(g=c)&&void 0!==g&&g.ownerDocument.contains(c)||a.ownerDocument.contains(a));!d&&c;){var k;c=jd(c).host;d=!(null===(k=c)||void 0===
k||!k.ownerDocument.contains(c))}if(d)return!h.getClientRects().length;if("legacy-full"!==b)return!0}else if("non-zero-area"===b)return ui(h);return!1},kd=function(h,a){var b;(b=a.disabled)||(b="INPUT"===a.tagName&&"hidden"===a.type);if(!(h=b||Dm(a,h)||Am(a)))a:{if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(a.tagName))for(h=a.parentElement;h;){if("FIELDSET"===h.tagName&&h.disabled){for(b=0;b<h.children.length;b++){var c=h.children.item(b);if("LEGEND"===c.tagName){h=vb.call(h,"fieldset[disabled] *")?
!0:!c.contains(a);break a}}h=!0;break a}h=h.parentElement}h=!1}return h?!1:!0},Ie=function(h,a){return"INPUT"===a.tagName&&"radio"===a.type&&!Cm(a)||0>ti(a)||!kd(h,a)?!1:!0},Em=function(h){h=parseInt(h.getAttribute("tabindex"),10);return isNaN(h)||0<=h?!0:!1},Fm=function b(a){var c=[],d=[];a.forEach(function(f,g){var k=!!f.scopeParent,l=k?f.scopeParent:f,m=ti(l,k),n=k?b(f.candidates):l;0===m?k?c.push.apply(c,n):c.push(l):d.push({documentOrder:g,tabIndex:m,item:f,isScope:k,content:n})});return d.sort(zm).reduce(function(f,
g){g.isScope?f.push.apply(f,g.content):f.push(g.content);return f},[]).concat(c)},Gm=function(a,b){b=b||{};a=b.getShadowRoot?si([a],b.includeContainer,{filter:Ie.bind(null,b),flatten:!1,getShadowRoot:b.getShadowRoot,shadowRootFilter:Em}):ri(a,b.includeContainer,Ie.bind(null,b));return Fm(a)},Hm=function(a,b){b=b||{};return b.getShadowRoot?si([a],b.includeContainer,{filter:kd.bind(null,b),flatten:!0,getShadowRoot:b.getShadowRoot}):ri(a,b.includeContainer,kd.bind(null,b))},ld=function(a,b){b=b||{};
if(!a)throw Error("No node provided");return!1===vb.call(a,id)?!1:Ie(b,a)},Im=pi.concat("iframe").join(","),Je=function(a,b){b=b||{};if(!a)throw Error("No node provided");return!1===vb.call(a,Im)?!1:kd(b,a)},vi=function(){var a=[];return{activateTrap:function(b){if(0<a.length){var c=a[a.length-1];c!==b&&c.pause()}c=a.indexOf(b);-1!==c&&a.splice(c,1);a.push(b)},deactivateTrap:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1);0<a.length&&a[a.length-1].unpause()}}}(),wi=function(a,b){var c=-1;a.every(function(d,
f){return b(d)?(c=f,!1):!0});return c},jc=function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return"function"===typeof a?a.apply(void 0,c):a},md=function(a){return a.target.shadowRoot&&"function"===typeof a.composedPath?a.composedPath()[0]:a.target},Jm=function(a,b){var c=(null===b||void 0===b?void 0:b.document)||document,d=Mf({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},b),f=[],g=[],k=[],l=null,m=null,n=!1,p=!1,q=void 0,r=function(J,
w,x){return J&&void 0!==J[w]?J[w]:d[x||w]},t=function(J){return g.findIndex(function(w){var x=w.tabbableNodes;return w.container.contains(J)||x.find(function(L){return L===J})})},v=function(J){var w=d[J];if("function"===typeof w){for(var x=arguments.length,L=Array(1<x?x-1:0),U=1;U<x;U++)L[U-1]=arguments[U];w=w.apply(void 0,L)}!0===w&&(w=void 0);if(!w){if(void 0===w||!1===w)return w;throw Error("`".concat(J,"` was specified but was not a node, or did not return a node"));}x=w;if("string"===typeof w&&
(x=c.querySelector(w),!x))throw Error("`".concat(J,"` as selector refers to no known node"));return x},C=function(){var J=v("initialFocus");if(!1===J)return!1;void 0===J&&(J=0<=t(c.activeElement)?c.activeElement:(J=k[0])&&J.firstTabbableNode||v("fallbackFocus"));if(!J)throw Error("Your focus-trap needs to have at least one focusable element");return J},F=function(){g=f.map(function(J){var w=Gm(J,d.tabbableOptions),x=Hm(J,d.tabbableOptions);return{container:J,tabbableNodes:w,focusableNodes:x,firstTabbableNode:0<
w.length?w[0]:null,lastTabbableNode:0<w.length?w[w.length-1]:null,nextTabbableNode:function(L){var U=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,qa=x.findIndex(function(ha){return ha===L});if(!(0>qa))return U?x.slice(qa+1).find(function(ha){return ld(ha,d.tabbableOptions)}):x.slice(0,qa).reverse().find(function(ha){return ld(ha,d.tabbableOptions)})}}});k=g.filter(function(J){return 0<J.tabbableNodes.length});if(0>=k.length&&!v("fallbackFocus"))throw Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");
},B=function x(w){!1!==w&&w!==c.activeElement&&(w&&w.focus?(w.focus({preventScroll:!!d.preventScroll}),m=w,w.tagName&&"input"===w.tagName.toLowerCase()&&"function"===typeof w.select&&w.select()):x(C()))},z=function(w){var x=v("setReturnFocus",w);return x?x:!1===x?!1:w},G=function(w){var x=md(w);0<=t(x)||(jc(d.clickOutsideDeactivates,w)?O.deactivate({returnFocus:d.returnFocusOnDeactivate&&!Je(x,d.tabbableOptions)}):jc(d.allowOutsideClick,w)||w.preventDefault())},T=function(w){var x=md(w),L=0<=t(x);
L||x instanceof Document?L&&(m=x):(w.stopImmediatePropagation(),B(m||C()))},M=function(w){var x=md(w);F();var L=null;if(0<k.length){var U=t(x),qa=0<=U?g[U]:void 0;if(0>U)L=w.shiftKey?k[k.length-1].lastTabbableNode:k[0].firstTabbableNode;else if(w.shiftKey){var ha=wi(k,function(Ga){return x===Ga.firstTabbableNode});0>ha&&(qa.container===x||Je(x,d.tabbableOptions)&&!ld(x,d.tabbableOptions)&&!qa.nextTabbableNode(x,!1))&&(ha=U);0<=ha&&(L=k[0===ha?k.length-1:ha-1].lastTabbableNode)}else ha=wi(k,function(Ga){return x===
Ga.lastTabbableNode}),0>ha&&(qa.container===x||Je(x,d.tabbableOptions)&&!ld(x,d.tabbableOptions)&&!qa.nextTabbableNode(x))&&(ha=U),0<=ha&&(L=k[ha===k.length-1?0:ha+1].firstTabbableNode)}else L=v("fallbackFocus");L&&(w.preventDefault(),B(L))},Q=function(w){"Escape"!==w.key&&"Esc"!==w.key&&27!==w.keyCode||!1===jc(d.escapeDeactivates,w)?"Tab"!==w.key&&9!==w.keyCode||M(w):(w.preventDefault(),O.deactivate())},N=function(w){var x=md(w);0<=t(x)||jc(d.clickOutsideDeactivates,w)||jc(d.allowOutsideClick,w)||
(w.preventDefault(),w.stopImmediatePropagation())},S=function(){if(n)return vi.activateTrap(O),q=d.delayInitialFocus?setTimeout(function(){B(C())},0):B(C()),c.addEventListener("focusin",T,!0),c.addEventListener("mousedown",G,{capture:!0,passive:!1}),c.addEventListener("touchstart",G,{capture:!0,passive:!1}),c.addEventListener("click",N,{capture:!0,passive:!1}),c.addEventListener("keydown",Q,{capture:!0,passive:!1}),O},aa=function(){if(n)return c.removeEventListener("focusin",T,!0),c.removeEventListener("mousedown",
G,!0),c.removeEventListener("touchstart",G,!0),c.removeEventListener("click",N,!0),c.removeEventListener("keydown",Q,!0),O};var O={get active(){return n},get paused(){return p},activate:function(w){if(n)return this;var x=r(w,"onActivate"),L=r(w,"onPostActivate"),U=r(w,"checkCanFocusTrap");U||F();n=!0;p=!1;l=c.activeElement;x&&x();w=function(){U&&F();S();L&&L()};if(U)return U(f.concat()).then(w,w),this;w();return this},deactivate:function(w){if(!n)return this;var x=Mf({onDeactivate:d.onDeactivate,
onPostDeactivate:d.onPostDeactivate,checkCanReturnFocus:d.checkCanReturnFocus},w);clearTimeout(q);q=void 0;aa();p=n=!1;vi.deactivateTrap(O);var L=r(x,"onDeactivate"),U=r(x,"onPostDeactivate");w=r(x,"checkCanReturnFocus");var qa=r(x,"returnFocus","returnFocusOnDeactivate");L&&L();x=function(){setTimeout(function(){qa&&B(z(l));U&&U()},0)};if(qa&&w)return w(z(l)).then(x,x),this;x();return this},pause:function(){if(p||!n)return this;p=!0;aa();return this},unpause:function(){if(!p||!n)return this;p=!1;
F();S();return this},updateContainerElements:function(w){f=[].concat(w).filter(Boolean).map(function(x){return"string"===typeof x?c.querySelector(x):x});n&&F();return this}};O.updateContainerElements(a);return O},Km=[{command:"escape"},{command:"download"},{command:"upload"}],Na=Jf("console-module",{filter:""});Na.on("click",".item",function(a){a.preventDefault();var b=a.target.closest(Na.selector);({command:a}=a.target.dataset);alert(`executed ${a}`);b.trap.deactivate()});Na.on("click",".bar",function(a){a=
a.target.closest(Na.selector);a.matches(".is-active")?a.trap.deactivate():a.trap.activate()});Na.on("keyup",'[name="filter"]',function(a){({value:a}=a.target);Na.write({filter:a})});Na.render(a=>{a.trap||(a.trap=Jm(a,{onActivate:xk(a),onDeactivate:yk(a),clickOutsideDeactivates:!0}));const {filter:b}=Na.read();a=Km.filter(d=>-1<d.command.toLowerCase().indexOf(b.toLowerCase())).map(d=>`
      <button class="item" data-command="${d.command}">
        ${d.command}
      </button>
    `).join("");const c=`
    <button class="item" data-id="${b}">
      ${b}
    </button>
  `;return`
    <button class="bar">
      'run: ' ${[].map(d=>d.command).join(", ")}
    </button>

    <div class="filterable-list">
      <div class="filter-area">
        <input type="text" name="filter" placeholder="Search" value="${b}" />
      </div>
      <div class="list">
        ${a}
        ${c}
      </div>
    </div>
  `});Na.style('\n\t& {\n\t\tdisplay: block;\n\t\tposition: relative;\n\t\tz-index: 3;\n    width: 100%;\n\t}\n\n\t& .filter-area {\n    margin: .5rem;\n\t}\n\n\t& .bar {\n\t\twhite-space: nowrap;\n\t\tbackground: rgba(255,255,255,.85);\n    width: 100%;\n\t}\n\n\t&.is-active .bar {\n\t}\n\t& .bar:hover,\n\t& .bar:focus {\n\t}\n\n\t& [name="filter"] {\n\t\tbackground: white;\n\t\tborder: none;\n\t\twidth: 100%;\n    display: block;\n\t}\n\n\t& .filterable-list {\n    background: white;\n\t\tdisplay: none;\n\t\tposition: absolute;\n    width: 100%;\n\t}\n\n\t&.is-active .filterable-list {\n\t\tdisplay: flex;\n    flex-direction: column;\n\t}\n\n  & .filterable-list.above {\n    top: 0;\n    transform: translateY(-100%);\n    flex-direction: column-reverse;\n  }\n\n\t& .item {\n\t\tbackground: transparent;\n\t\tborder: none;\n\t\tdisplay: grid;\n\t\tgrid-template-columns: auto 1fr;\n\t\talign-items: center;\n\t\tmin-height: 40px;\n\t\tmargin: 0;\n\t\ttext-align: left;\n\t\twidth: 100%;\n\t}\n\n\t& .item * {\n\t\tpointer-events: none;\n\t}\n\n\t& .list {\n\t\tmax-height: 80vh;\n\t\toverflow-y: auto;\n\t}\n\n\t& .item:hover,\n\t& .item:focus {\n\t\tbackground: linear-gradient(rgba(0,0,0,0) 75%, rgba(0,0,0,.25));\n\t}\n');
var V=class{constructor(){}lineAt(a){if(0>a||a>this.length)throw new RangeError(`Invalid position ${a} in document of length ${this.length}`);return this.lineInner(a,!1,1,0)}line(a){if(1>a||a>this.lines)throw new RangeError(`Invalid line number ${a} in ${this.lines}-line document`);return this.lineInner(a,!0,1,0)}replace(a,b,c){let d=[];this.decompose(0,a,d,2);c.length&&c.decompose(0,c.length,d,3);this.decompose(b,this.length,d,1);return Za.from(d,this.length-(b-a)+c.length)}append(a){return this.replace(this.length,
this.length,a)}slice(a,b=this.length){let c=[];this.decompose(a,b,c,0);return Za.from(c,b-a)}eq(a){if(a==this)return!0;if(a.length!=this.length||a.lines!=this.lines)return!1;let b=this.scanIdentical(a,1),c=this.length-this.scanIdentical(a,-1),d=new kc(this);a=new kc(a);for(let f=b,g=b;;){d.next(f);a.next(f);f=0;if(d.lineBreak!=a.lineBreak||d.done!=a.done||d.value!=a.value)return!1;g+=d.value.length;if(d.done||g>=c)return!0}}iter(a=1){return new kc(this,a)}iterRange(a,b=this.length){return new xi(this,
a,b)}iterLines(a,b){null==a?b=this.iter():(null==b&&(b=this.lines+1),a=this.line(a).from,b=this.iterRange(a,Math.max(a,b==this.lines+1?this.length:1>=b?0:this.line(b-1).to)));return new yi(b)}toString(){return this.sliceString(0)}toJSON(){let a=[];this.flatten(a);return a}static of(a){if(0==a.length)throw new RangeError("A document must have at least one line");return 1!=a.length||a[0]?32>=a.length?new ea(a):Za.from(ea.split(a,[])):V.empty}},ea=class extends V{constructor(a,b=zk(a)){super();this.text=
a;this.length=b}get lines(){return this.text.length}get children(){return null}lineInner(a,b,c,d){for(let f=0;;f++){let g=this.text[f],k=d+g.length;if((b?c:k)>=a)return new Lm(d,k,c,g);d=k+1;c++}}decompose(a,b,c,d){a=0>=a&&b>=this.length?this:new ea(Vb(this.text,[""],a,b),Math.min(b,this.length)-Math.max(0,a));d&1?(b=c.pop(),d=Vb(a.text,b.text.slice(),0,a.length),32>=d.length?c.push(new ea(d,b.length+a.length)):(a=d.length>>1,c.push(new ea(d.slice(0,a)),new ea(d.slice(a))))):c.push(a)}replace(a,b,
c){if(!(c instanceof ea))return super.replace(a,b,c);let d=Vb(this.text,Vb(c.text,Vb(this.text,[""],0,a)),b);a=this.length+c.length-(b-a);return 32>=d.length?new ea(d,a):Za.from(ea.split(d,[]),a)}sliceString(a,b=this.length,c="\n"){let d="";for(let f=0,g=0;f<=b&&g<this.text.length;g++){let k=this.text[g],l=f+k.length;f>a&&g&&(d+=c);a<l&&b>f&&(d+=k.slice(Math.max(0,a-f),b-f));f=l+1}return d}flatten(a){for(let b of this.text)a.push(b)}scanIdentical(){return 0}static split(a,b){let c=[],d=-1;for(let f of a)c.push(f),
d+=f.length+1,32==c.length&&(b.push(new ea(c,d)),c=[],d=-1);-1<d&&b.push(new ea(c,d));return b}},Za=class extends V{constructor(a,b){super();this.children=a;this.length=b;this.lines=0;for(let c of a)this.lines+=c.lines}lineInner(a,b,c,d){for(let f=0;;f++){let g=this.children[f],k=d+g.length,l=c+g.lines-1;if((b?l:k)>=a)return g.lineInner(a,b,c,d);d=k+1;c=l+1}}decompose(a,b,c,d){for(let f=0,g=0;g<=b&&f<this.children.length;f++){let k=this.children[f],l=g+k.length;if(a<=l&&b>=g){let m=d&((g<=a?1:0)|
(l>=b?2:0));g>=a&&l<=b&&!m?c.push(k):k.decompose(a-g,b-g,c,m)}g=l+1}}replace(a,b,c){if(c.lines<this.lines)for(let g=0,k=0;g<this.children.length;g++){var d=this.children[g],f=k+d.length;if(a>=k&&b<=f){let l=d.replace(a-k,b-k,c);d=this.lines-d.lines+l.lines;return l.lines<d>>4&&l.lines>d>>6?(f=this.children.slice(),f[g]=l,new Za(f,this.length-(b-a)+c.length)):super.replace(k,f,l)}k=f+1}return super.replace(a,b,c)}sliceString(a,b=this.length,c="\n"){let d="";for(let f=0,g=0;f<this.children.length&&
g<=b;f++){let k=this.children[f],l=g+k.length;g>a&&f&&(d+=c);a<l&&b>g&&(d+=k.sliceString(a-g,b-g,c));g=l+1}return d}flatten(a){for(let b of this.children)b.flatten(a)}scanIdentical(a,b){if(!(a instanceof Za))return 0;let c=0,[d,f,g,k]=0<b?[0,0,this.children.length,a.children.length]:[this.children.length-1,a.children.length-1,-1,-1];for(;;d+=b,f+=b){if(d==g||f==k)return c;let l=this.children[d],m=a.children[f];if(l!=m)return c+l.scanIdentical(m,b);c+=l.length+1}}static from(a,b=a.reduce((c,d)=>c+
d.length+1,-1)){function c(r){let t;if(r.lines>k&&r instanceof Za)for(let v of r.children)c(v);else r.lines>l&&(n>l||!n)?(d(),m.push(r)):r instanceof ea&&n&&(t=q[q.length-1])instanceof ea&&32>=r.lines+t.lines?(n+=r.lines,p+=r.length+1,q[q.length-1]=new ea(t.text.concat(r.text),t.length+1+r.length)):(n+r.lines>g&&d(),n+=r.lines,p+=r.length+1,q.push(r))}function d(){0!=n&&(m.push(1==q.length?q[0]:Za.from(q,p)),p=-1,n=q.length=0)}var f=0;for(let r of a)f+=r.lines;if(32>f){f=[];for(let r of a)r.flatten(f);
return new ea(f,b)}let g=Math.max(32,f>>5),k=g<<1,l=g>>1,m=[],n=0,p=-1,q=[];for(let r of a)c(r);d();return 1==m.length?m[0]:new Za(m,b)}};V.empty=new ea([""],0);var kc=class{constructor(a,b=1){this.dir=b;this.lineBreak=this.done=!1;this.value="";this.nodes=[a];this.offsets=[0<b?1:(a instanceof ea?a.text.length:a.children.length)<<1]}nextInner(a,b){for(this.done=this.lineBreak=!1;;){let d=this.nodes.length-1;var c=this.nodes[d];let f=this.offsets[d],g=f>>1,k=c instanceof ea?c.text.length:c.children.length;
if(g==(0<b?k:0)){if(0==d)return this.done=!0,this.value="",this;0<b&&this.offsets[d-1]++;this.nodes.pop();this.offsets.pop()}else if((f&1)==(0<b?0:1)){this.offsets[d]+=b;if(0==a)return this.lineBreak=!0,this.value="\n",this;a--}else if(c instanceof ea){c=c.text[g+(0>b?-1:0)];this.offsets[d]+=b;if(c.length>Math.max(0,a))return this.value=0==a?c:0<b?c.slice(a):c.slice(0,c.length-a),this;a-=c.length}else c=c.children[g+(0>b?-1:0)],a>c.length?(a-=c.length,this.offsets[d]+=b):(0>b&&this.offsets[d]--,this.nodes.push(c),
this.offsets.push(0<b?1:(c instanceof ea?c.text.length:c.children.length)<<1))}}next(a=0){0>a&&(this.nextInner(-a,-this.dir),a=this.value.length);return this.nextInner(a,this.dir)}},xi=class{constructor(a,b,c){this.value="";this.done=!1;this.cursor=new kc(a,b>c?-1:1);this.pos=b>c?a.length:0;this.from=Math.min(b,c);this.to=Math.max(b,c)}nextInner(a,b){if(0>b?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;a+=Math.max(0,0>b?this.pos-this.to:this.from-this.pos);let c=0>b?
this.pos-this.from:this.to-this.pos;a>c&&(a=c);c-=a;let {value:d}=this.cursor.next(a);this.pos+=(d.length+a)*b;this.value=d.length<=c?d:0>b?d.slice(d.length-c):d.slice(0,c);this.done=!this.value;return this}next(a=0){0>a?a=Math.max(a,this.from-this.pos):0<a&&(a=Math.min(a,this.to-this.pos));return this.nextInner(a,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}},yi=class{constructor(a){this.inner=a;this.afterBreak=!0;this.value="";this.done=!1}next(a=0){let {done:b,
lineBreak:c,value:d}=this.inner.next(a);b?(this.done=!0,this.value=""):c?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=d,this.afterBreak=!1);return this}get lineBreak(){return!1}};"undefined"!=typeof Symbol&&(V.prototype[Symbol.iterator]=function(){return this.iter()},kc.prototype[Symbol.iterator]=xi.prototype[Symbol.iterator]=yi.prototype[Symbol.iterator]=function(){return this});var Lm=class{constructor(a,b,c,d){this.from=a;this.to=b;this.number=c;this.text=d}get length(){return this.to-
this.from}},pb="lc 34 7n 7 7b 19    2  2   20 b 1c l g  2t 7 2 6 2 2  4 z  u r 2j b 1m 9 9  o 4  9  3  5 17 3 3b f  w 1j    4 8 4  3 7 a 2 t  1m    2 4 8  9  a 2 q  2 2 1l  4 2 4 2 2 3 3  u 2 3  b 2 1l  4 5  2 4  k 2 m 6   1m   2  4 8  7 3 a 2 u  1n    c  9  14  3  1l 3 5 3  4 7 2 b 2 t  1m  2  2  3  5 2 7 2 b 2 s 2 1l 2   2 4 8  9  a 2 t  20  4  2 3   8  29  2 7 c 8 2q  2 9 b 6 22 2 r      1j e  5  2 5 b  10 9  2u 4  6  2 2 2 p 2 4 3 g 4 d  2 2 6  f  jj 3 qa 3 t 3 t 2 u 2 1s 2  7 8  2 b 9  19 3 3b 2 y  3a 3 4 2 9  6 3 63 2 2  1m   7     2 8 6 a 2  1c h 1r 4 1c 7   5  14 9 c 2 w 4 2 2  3 1k   2 3   3 1m 8 2 2 48 3  d  7 4  6  3 2 5i 1m  5 ek  5f x 2da 3 3x  2o w fe 6 2x 2 n9w 4  a w 2 28 2 7k  3  4  p 2 5  47 2 q i d  12 8 p b 1a 3 1c  2 4 2 2 13  1v 6 2 2 2 2 c  8  1b  1f   3 2 2 5 2   16 2 8  6m  2  4  fn4  kh g g g a6 2 gt  6a  45 5 1ae 3  2 5 4 14 3 4  4l 2 fx 4 ar 2 49 b 4w  1i f 1k 3 1d 4 2 2 1x 3 10 5  8 1q  c 2 1g 9 a 4 2  2n 3 2   2 6  4g  3 8 l 2 1l 2     m  e 7 3 5 5f 8 2 3   n  29  2 6   2   2  2 6j  2 4 6 2  2 r 2 2d 8 2   2 2y    2 6   2t 3 2 4  5 77 9  2 6t  a 2   4  40 4 2 2 4  w a 14 6 2 4 8  9 6 2 3 1a d  2 ba 7  6   2a m 2 7  2  2 3e 6 3   2  7   20 2 3    9n 2 f0b 5 1n 7 t4  1r 4 29  f5k 2 43q   3 4 5 8 8 2 7 u 4 44 3 1iz 1j 4 1e 8  e  m 5  f 11s 7  h 2 7  2  5 79 7 c5 4 15s 7 31 7 240 5 gx7k 2o 3k 6o".split(" ").map(a=>
a?parseInt(a,36):1);for(let a=1;a<pb.length;a++)pb[a]+=pb[a-1];var Ke=/\r\n?|\n/,xa=function(a){a[a.Simple=0]="Simple";a[a.TrackDel=1]="TrackDel";a[a.TrackBefore=2]="TrackBefore";a[a.TrackAfter=3]="TrackAfter";return a}(xa||={}),Va=class{constructor(a){this.sections=a}get length(){let a=0;for(let b=0;b<this.sections.length;b+=2)a+=this.sections[b];return a}get newLength(){let a=0;for(let b=0;b<this.sections.length;b+=2){let c=this.sections[b+1];a+=0>c?this.sections[b]:c}return a}get empty(){return 0==
this.sections.length||2==this.sections.length&&0>this.sections[1]}iterGaps(a){for(let b=0,c=0,d=0;b<this.sections.length;){let f=this.sections[b++],g=this.sections[b++];0>g?(a(c,d,f),d+=f):d+=g;c+=f}}iterChangedRanges(a,b=!1){Ld(this,a,b)}get invertedDesc(){let a=[];for(let b=0;b<this.sections.length;){let c=this.sections[b++],d=this.sections[b++];0>d?a.push(c,d):a.push(d,c)}return new Va(a)}composeDesc(a){return this.empty?a:a.empty?this:Pf(this,a)}mapDesc(a,b=!1){return a.empty?this:Md(this,a,b)}mapPos(a,
b=-1,c=xa.Simple){let d=0,f=0;for(let g=0;g<this.sections.length;){let k=this.sections[g++],l=this.sections[g++],m=d+k;if(0>l){if(m>a)return f+(a-d);f+=k}else{if(c!=xa.Simple&&m>=a&&(c==xa.TrackDel&&d<a&&m>a||c==xa.TrackBefore&&d<a||c==xa.TrackAfter&&m>a))return null;if(m>a||m==a&&0>b&&!k)return a==d||0>b?f:f+l;f+=l}d=m}if(a>d)throw new RangeError(`Position ${a} is out of range for changeset of length ${d}`);return f}touchesRange(a,b=a){for(let d=0,f=0;d<this.sections.length&&f<=b;){var c=this.sections[d++];
let g=this.sections[d++];c=f+c;if(0<=g&&f<=b&&c>=a)return f<a&&c>b?"cover":!0;f=c}return!1}toString(){let a="";for(let b=0;b<this.sections.length;){let c=this.sections[b++],d=this.sections[b++];a+=(a?" ":"")+c+(0<=d?":"+d:"")}return a}toJSON(){return this.sections}static fromJSON(a){if(!Array.isArray(a)||a.length%2||a.some(b=>"number"!=typeof b))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Va(a)}static create(a){return new Va(a)}},ia=class extends Va{constructor(a,
b){super(a);this.inserted=b}apply(a){if(this.length!=a.length)throw new RangeError("Applying change set to a document with the wrong length");Ld(this,(b,c,d,f,g)=>a=a.replace(d,d+(c-b),g),!1);return a}mapDesc(a,b=!1){return Md(this,a,b,!0)}invert(a){let b=this.sections.slice(),c=[];for(let f=0,g=0;f<b.length;f+=2){let k=b[f];var d=b[f+1];if(0<=d){b[f]=d;b[f+1]=k;for(d=f>>1;c.length<d;)c.push(V.empty);c.push(k?a.slice(g,g+k):V.empty)}g+=k}return new ia(b,c)}compose(a){return this.empty?a:a.empty?this:
Pf(this,a,!0)}map(a,b=!1){return a.empty?this:Md(this,a,b,!0)}iterChanges(a,b=!1){Ld(this,a,b)}get desc(){return Va.create(this.sections)}filter(a){let b=[],c=[],d=[],f=new Wb(this);a:for(let l=0,m=0;;){for(var g=l==a.length?1E9:a[l++];m<g||m==g&&0==f.len;){if(f.done)break a;var k=Math.min(f.len,g-m);sa(d,k,-1);let n=-1==f.ins?-1:0==f.off?f.ins:0;sa(b,k,n);0<n&&qb(c,b,f.text);f.forward(k);m+=k}for(g=a[l++];m<g;){if(f.done)break a;k=Math.min(f.len,g-m);sa(b,k,-1);sa(d,k,-1==f.ins?-1:0==f.off?f.ins:
0);f.forward(k);m+=k}}return{changes:new ia(b,c),filtered:Va.create(d)}}toJSON(){let a=[];for(let b=0;b<this.sections.length;b+=2){let c=this.sections[b],d=this.sections[b+1];0>d?a.push(c):0==d?a.push([c]):a.push([c].concat(this.inserted[b>>1].toJSON()))}return a}static of(a,b,c){function d(n=!1){if(n||g.length)l<b&&sa(g,b-l,-1),n=new ia(g,k),m=m?m.compose(n.map(m)):n,g=[],k=[],l=0}function f(n){if(Array.isArray(n))for(var p of n)f(p);else if(n instanceof ia){if(n.length!=b)throw new RangeError(`Mismatched change set length (got ${n.length}, expected ${b})`);
d();m=m?m.compose(n.map(m)):n}else{let {from:q,to:r=q,insert:t}=n;if(q>r||0>q||r>b)throw new RangeError(`Invalid change range ${q} to ${r} (in doc of length ${b})`);n=t?"string"==typeof t?V.of(t.split(c||Ke)):t:V.empty;p=n.length;if(q!=r||0!=p)q<l&&d(),q>l&&sa(g,q-l,-1),sa(g,r-q,p),qb(k,g,n),l=r}}let g=[],k=[],l=0,m=null;f(a);d(!m);return m}static empty(a){return new ia(a?[a,-1]:[],[])}static fromJSON(a){if(!Array.isArray(a))throw new RangeError("Invalid JSON representation of ChangeSet");let b=[],
c=[];for(let d=0;d<a.length;d++){let f=a[d];if("number"==typeof f)b.push(f,-1);else{if(!Array.isArray(f)||"number"!=typeof f[0]||f.some((g,k)=>k&&"string"!=typeof g))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==f.length)b.push(f[0],0);else{for(;c.length<d;)c.push(V.empty);c[d]=V.of(f.slice(1));b.push(f[0],c[d].length)}}}return new ia(b,c)}static createSet(a,b){return new ia(a,b)}},Wb=class{constructor(a){this.set=a;this.i=0;this.next()}next(){let {sections:a}=this.set;this.i<
a.length?(this.len=a[this.i++],this.ins=a[this.i++]):(this.len=0,this.ins=-2);this.off=0}get done(){return-2==this.ins}get len2(){return 0>this.ins?this.len:this.ins}get text(){let {inserted:a}=this.set,b=this.i-2>>1;return b>=a.length?V.empty:a[b]}textBit(a){let {inserted:b}=this.set,c=this.i-2>>1;return c>=b.length&&!a?V.empty:b[c].slice(this.off,null==a?void 0:this.off+a)}forward(a){a==this.len?this.next():(this.len-=a,this.off+=a)}forward2(a){-1==this.ins?this.forward(a):a==this.ins?this.next():
(this.ins-=a,this.off+=a)}},Rb=class{constructor(a,b,c){this.from=a;this.to=b;this.flags=c}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let a=this.flags&3;return 3==a?null:a}get goalColumn(){let a=this.flags>>5;return 33554431==a?void 0:a}map(a,b=-1){this.empty?b=a=a.mapPos(this.from,b):(b=a.mapPos(this.from,1),a=a.mapPos(this.to,-1));return b==
this.from&&a==this.to?this:new Rb(b,a,this.flags)}extend(a,b=a){return a<=this.anchor&&b>=this.anchor?u.range(a,b):u.range(this.anchor,Math.abs(a-this.anchor)>Math.abs(b-this.anchor)?a:b)}eq(a){return this.anchor==a.anchor&&this.head==a.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(a){if(!a||"number"!=typeof a.anchor||"number"!=typeof a.head)throw new RangeError("Invalid JSON representation for SelectionRange");return u.range(a.anchor,a.head)}static create(a,b,c){return new Rb(a,
b,c)}},u=class{constructor(a,b){this.ranges=a;this.mainIndex=b}map(a,b=-1){return a.empty?this:u.create(this.ranges.map(c=>c.map(a,b)),this.mainIndex)}eq(a){if(this.ranges.length!=a.ranges.length||this.mainIndex!=a.mainIndex)return!1;for(let b=0;b<this.ranges.length;b++)if(!this.ranges[b].eq(a.ranges[b]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new u([this.main],0)}addRange(a,b=!0){return u.create([a].concat(this.ranges),b?0:this.mainIndex+
1)}replaceRange(a,b=this.mainIndex){let c=this.ranges.slice();c[b]=a;return u.create(c,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(a=>a.toJSON()),main:this.mainIndex}}static fromJSON(a){if(!a||!Array.isArray(a.ranges)||"number"!=typeof a.main||a.main>=a.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new u(a.ranges.map(b=>Rb.fromJSON(b)),a.main)}static single(a,b=a){return new u([u.range(a,b)],0)}static create(a,b=0){if(0==a.length)throw new RangeError("A selection needs at least one range");
for(let c=0,d=0;d<a.length;d++){let f=a[d];if(f.empty?f.from<=c:f.from<c)return u.normalized(a.slice(),b);c=f.to}return new u(a,b)}static cursor(a,b=0,c,d){return Rb.create(a,a,(0==b?0:0>b?4:8)|(null==c?3:Math.min(2,c))|(null!==d&&void 0!==d?d:33554431)<<5)}static range(a,b,c){c=(null!==c&&void 0!==c?c:33554431)<<5;return b<a?Rb.create(b,a,c|24):Rb.create(a,b,c|(b>a?4:0))}static normalized(a,b=0){b=a[b];a.sort((d,f)=>d.from-f.from);b=a.indexOf(b);for(let d=1;d<a.length;d++){let f=a[d];var c=a[d-1];
if(f.empty?f.from<=c.to:f.from<c.to){let g=c.from;c=Math.max(f.to,c.to);d<=b&&b--;a.splice(--d,2,f.anchor>f.head?u.range(c,g):u.range(g,c))}}return new u(a,b)}},Le=0,E=class{constructor(a,b,c,d,f){this.combine=a;this.compareInput=b;this.compare=c;this.isStatic=d;this.extensions=f;this.id=Le++;this.default=a([])}static define(a={}){return new E(a.combine||(b=>b),a.compareInput||((b,c)=>b===c),a.compare||(a.combine?(b,c)=>b===c:Nd),!!a.static,a.enables)}of(a){return new Cc([],this,0,a)}compute(a,b){if(this.isStatic)throw Error("Can't compute a static facet");
return new Cc(a,this,1,b)}computeN(a,b){if(this.isStatic)throw Error("Can't compute a static facet");return new Cc(a,this,2,b)}from(a,b){b||=c=>c;return this.compute([a],c=>b(c.field(a)))}},Cc=class{constructor(a,b,c,d){this.dependencies=a;this.facet=b;this.type=c;this.value=d;this.id=Le++}dynamicSlot(a){var b;let c=this.value,d=this.facet.compareInput,f=this.id,g=a[f]>>1,k=2==this.type,l=!1,m=!1,n=[];for(let p of this.dependencies)"doc"==p?l=!0:"selection"==p?m=!0:0==((null!==(b=a[p.id])&&void 0!==
b?b:1)&1)&&n.push(a[p.id]);return{create(p){p.values[g]=c(p);return 1},update(p,q){if(l&&q.docChanged||m&&(q.docChanged||q.selection)||Od(p,n))if(q=c(p),k?!Rf(q,p.values[g],d):!d(q,p.values[g]))return p.values[g]=q,1;return 0},reconfigure:(p,q)=>{let r=c(p);var t=q.config.address[f];if(null!=t&&(t=Bc(q,t),this.dependencies.every(v=>v instanceof E?q.facet(v)===p.facet(v):v instanceof na?q.field(v,!1)==p.field(v,!1):!0)||(k?Rf(r,t,d):d(r,t))))return p.values[g]=t,0;p.values[g]=r;return 1}}}},zi=E.define({static:!0}),
na=class{constructor(a,b,c,d,f){this.id=a;this.createF=b;this.updateF=c;this.compareF=d;this.spec=f;this.provides=void 0}static define(a){let b=new na(Le++,a.create,a.update,a.compare||((c,d)=>c===d),a);a.provide&&(b.provides=a.provide(b));return b}create(a){let b=a.facet(zi).find(c=>c.field==this);return((null===b||void 0===b?void 0:b.create)||this.createF)(a)}slot(a){let b=a[this.id]>>1;return{create:c=>{c.values[b]=this.create(c);return 1},update:(c,d)=>{let f=c.values[b];d=this.updateF(f,d);if(this.compareF(f,
d))return 0;c.values[b]=d;return 1},reconfigure:(c,d)=>{if(null!=d.config.address[this.id])return c.values[b]=d.field(this),0;c.values[b]=this.create(c);return 1}}}init(a){return[this,zi.of({field:this,create:a})]}get extension(){return this}},Db={lowest:4,low:3,default:2,high:1,highest:0},lc={highest:Yb(Db.highest),high:Yb(Db.high),default:Yb(Db.default),low:Yb(Db.low),lowest:Yb(Db.lowest)},Sf=class{constructor(a,b){this.inner=a;this.prec=b}},Me=class{of(a){return new Pd(this,a)}reconfigure(a){return Me.reconfigure.of({compartment:this,
extension:a})}get(a){return a.config.compartments.get(this)}},Pd=class{constructor(a,b){this.compartment=a;this.inner=b}},Ne=class{constructor(a,b,c,d,f,g){this.base=a;this.compartments=b;this.dynamicSlots=c;this.address=d;this.staticValues=f;this.facets=g;for(this.statusTemplate=[];this.statusTemplate.length<c.length;)this.statusTemplate.push(0)}staticFacet(a){let b=this.address[a.id];return null==b?a.default:this.staticValues[b>>1]}static resolve(a,b,c){var d=[];let f=Object.create(null),g=new Map;
for(var k of Ck(a,b,g))k instanceof na?d.push(k):(f[k.facet.id]||(f[k.facet.id]=[])).push(k);let l=Object.create(null);b=[];k=[];for(let n of d)l[n.id]=k.length<<1,k.push(p=>n.slot(p));d=null===c||void 0===c?void 0:c.config.facets;for(let n in f){let p=f[n],q=p[0].facet;var m=d&&d[n]||[];if(p.every(r=>0==r.type))l[q.id]=b.length<<1|1,Nd(m,p)?b.push(c.facet(q)):(m=q.combine(p.map(r=>r.value)),b.push(c&&q.compare(m,c.facet(q))?c.facet(q):m));else{for(let r of p)0==r.type?(l[r.id]=b.length<<1|1,b.push(r.value)):
(l[r.id]=k.length<<1,k.push(t=>r.dynamicSlot(t)));l[q.id]=k.length<<1;k.push(r=>Bk(r,q,p))}}c=k.map(n=>n(l));return new Ne(a,g,c,l,b,f)}},Ai=E.define(),Bi=E.define({combine:a=>a.some(b=>b),static:!0}),Uf=E.define({combine:a=>a.length?a[0]:void 0,static:!0}),Wf=E.define(),Xf=E.define(),Yf=E.define(),Ci=E.define({combine:a=>a.length?a[0]:!1}),wb=class{constructor(a,b){this.type=a;this.value=b}static define(){return new Mm}},Mm=class{of(a){return new wb(this,a)}},Nm=class{constructor(a){this.map=a}of(a){return new K(this,
a)}},K=class{constructor(a,b){this.type=a;this.value=b}map(a){a=this.type.map(this.value,a);return void 0===a?void 0:a==this.value?this:new K(this.type,a)}is(a){return this.type==a}static define(a={}){return new Nm(a.map||(b=>b))}static mapEffects(a,b){if(!a.length)return a;let c=[];for(let d of a)(a=d.map(b))&&c.push(a);return c}};K.reconfigure=K.define();K.appendConfig=K.define();var ja=class{constructor(a,b,c,d,f,g){this.startState=a;this.changes=b;this.selection=c;this.effects=d;this.annotations=
f;this.scrollIntoView=g;this._state=this._doc=null;c&&Qf(c,b.newLength);f.some(k=>k.type==ja.time)||(this.annotations=f.concat(ja.time.of(Date.now())))}static create(a,b,c,d,f,g){return new ja(a,b,c,d,f,g)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){this._state||this.startState.applyTransaction(this);return this._state}annotation(a){for(let b of this.annotations)if(b.type==
a)return b.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(a){let b=this.annotation(ja.userEvent);return!(!b||!(b==a||b.length>a.length&&b.slice(0,a.length)==a&&"."==b[a.length]))}};ja.time=wb.define();ja.userEvent=wb.define();ja.addToHistory=wb.define();ja.remote=wb.define();var Dk=[],va=function(a){a[a.Word=0]="Word";a[a.Space=1]="Space";a[a.Other=2]="Other";return a}(va||={}),Fk=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;
try{var Zf=RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(a){}var R=class{constructor(a,b,c,d,f,g){this.config=a;this.doc=b;this.selection=c;this.values=d;this.status=a.statusTemplate.slice();this.computeSlot=f;g&&(g._state=this);for(a=0;a<this.config.dynamicSlots.length;a++)Xb(this,a<<1);this.computeSlot=null}field(a,b=!0){a=this.config.address[a.id];if(null==a){if(b)throw new RangeError("Field is not present in this state");}else return Xb(this,a),Bc(this,a)}update(...a){return Vf(this,a,!0)}applyTransaction(a){let b=
this.config,{base:c,compartments:d}=b;for(var f of a.effects)f.is(Me.reconfigure)?(b&&(d=new Map,b.compartments.forEach((g,k)=>d.set(k,g)),b=null),d.set(f.value.compartment,f.value.extension)):f.is(K.reconfigure)?(b=null,c=f.value):f.is(K.appendConfig)&&(b=null,c=Eb(c).concat(f.value));b?f=a.startState.values.slice():(b=Ne.resolve(c,d,this),f=(new R(b,this.doc,this.selection,b.dynamicSlots.map(()=>null),(g,k)=>k.reconfigure(g,this),null)).values);new R(b,a.newDoc,a.newSelection,f,(g,k)=>k.update(g,
a),a)}replaceSelection(a){"string"==typeof a&&(a=this.toText(a));return this.changeByRange(b=>({changes:{from:b.from,to:b.to,insert:a},range:u.cursor(b.from+a.length)}))}changeByRange(a){let b=this.selection;var c=a(b.ranges[0]);let d=this.changes(c.changes),f=[c.range];c=Eb(c.effects);for(let k=1;k<b.ranges.length;k++){let l=a(b.ranges[k]);var g=this.changes(l.changes);let m=g.map(d);for(let n=0;n<k;n++)f[n]=f[n].map(m);g=d.mapDesc(g,!0);f.push(l.range.map(g));d=d.compose(m);c=K.mapEffects(c,m).concat(K.mapEffects(Eb(l.effects),
g))}return{changes:d,selection:u.create(f,b.mainIndex),effects:c}}changes(a=[]){return a instanceof ia?a:ia.of(a,this.doc.length,this.facet(R.lineSeparator))}toText(a){return V.of(a.split(this.facet(R.lineSeparator)||Ke))}sliceDoc(a=0,b=this.doc.length){return this.doc.sliceString(a,b,this.lineBreak)}facet(a){let b=this.config.address[a.id];if(null==b)return a.default;Xb(this,b);return Bc(this,b)}toJSON(a){let b={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(a)for(let c in a){let d=a[c];
d instanceof na&&(b[c]=d.spec.toJSON(this.field(a[c]),this))}return b}static fromJSON(a,b={},c){if(!a||"string"!=typeof a.doc)throw new RangeError("Invalid JSON representation for EditorState");let d=[];if(c)for(let f in c){let g=c[f],k=a[f];d.push(g.init(l=>g.spec.fromJSON(k,l)))}return R.create({doc:a.doc,selection:u.fromJSON(a.selection),extensions:b.extensions?d.concat([b.extensions]):d})}static create(a={}){let b=Ne.resolve(a.extensions||[],new Map),c=a.doc instanceof V?a.doc:V.of((a.doc||"").split(b.staticFacet(R.lineSeparator)||
Ke));a=a.selection?a.selection instanceof u?a.selection:u.single(a.selection.anchor,a.selection.head):u.single(0);Qf(a,c.length);b.staticFacet(Bi)||(a=a.asSingle());return new R(b,c,a,b.dynamicSlots.map(()=>null),(d,f)=>f.create(d),null)}get tabSize(){return this.facet(R.tabSize)}get lineBreak(){return this.facet(R.lineSeparator)||"\n"}get readOnly(){return this.facet(Ci)}phrase(a,...b){for(let c of this.facet(R.phrases))if(Object.prototype.hasOwnProperty.call(c,a)){a=c[a];break}b.length&&(a=a.replace(/\$(\$|\d*)/g,
(c,d)=>{if("$"==d)return"$";d=+(d||1);return d>b.length?c:b[d-1]}));return a}languageDataAt(a,b,c=-1){let d=[];for(let f of this.facet(Ai))for(let g of f(this,b,c))Object.prototype.hasOwnProperty.call(g,a)&&d.push(g[a]);return d}charCategorizer(a){return Ek(this.languageDataAt("wordChars",a).join(""))}wordAt(a){let {text:b,from:c,length:d}=this.doc.lineAt(a),f=this.charCategorizer(a),g=a-c;for(a-=c;0<g;){var k=ya(b,g,!1);if(f(b.slice(k,g))!=va.Word)break;g=k}for(;a<d;){k=ya(b,a);if(f(b.slice(a,k))!=
va.Word)break;a=k}return g==a?null:u.range(g+c,a+c)}};R.allowMultipleSelections=Bi;R.tabSize=E.define({combine:a=>a.length?a[0]:4});R.lineSeparator=Uf;R.readOnly=Ci;R.phrases=E.define({compare(a,b){let c=Object.keys(a),d=Object.keys(b);return c.length==d.length&&c.every(f=>a[f]==b[f])}});R.languageData=Ai;R.changeFilter=Wf;R.transactionFilter=Xf;R.transactionExtender=Yf;Me.reconfigure=K.define();var xb=class{eq(a){return this==a}range(a,b=a){return nd.create(a,b,this)}};xb.prototype.startSide=xb.prototype.endSide=
0;xb.prototype.point=!1;xb.prototype.mapMode=xa.TrackDel;var nd=class{constructor(a,b,c){this.from=a;this.to=b;this.value=c}static create(a,b,c){return new nd(a,b,c)}},Di=class{constructor(a,b,c,d){this.from=a;this.to=b;this.value=c;this.maxPoint=d}get length(){return this.to[this.to.length-1]}findIndex(a,b,c,d=0){let f=c?this.to:this.from;for(let g=d,k=f.length;;){if(g==k)return g;d=g+k>>1;let l=f[d]-a||(c?this.value[d].endSide:this.value[d].startSide)-b;if(d==g)return 0<=l?g:k;0<=l?k=d:g=d+1}}between(a,
b,c,d){for(let f=this.findIndex(b,-1E9,!0),g=this.findIndex(c,1E9,!1,f);f<g;f++)if(!1===d(this.from[f]+a,this.to[f]+a,this.value[f]))return!1}map(a,b){let c=[],d=[],f=[],g=-1,k=-1;for(let n=0;n<this.value.length;n++){let p=this.value[n],q=this.from[n]+a;var l=this.to[n]+a,m=void 0;if(q==l){m=b.mapPos(q,p.startSide,p.mapMode);if(null==m)continue;m=l=m;if(p.startSide!=p.endSide&&(l=b.mapPos(q,p.endSide),l<m))continue}else if(m=b.mapPos(q,p.startSide),l=b.mapPos(l,p.endSide),m>l||m==l&&0<p.startSide&&
0>=p.endSide)continue;0>(l-m||p.endSide-p.startSide)||(0>g&&(g=m),p.point&&(k=Math.max(k,l-m)),c.push(p),d.push(m-g),f.push(l-g))}return{mapped:c.length?new Di(d,f,c,k):null,pos:g}}},W=class{constructor(a,b,c,d){this.chunkPos=a;this.chunk=b;this.nextLayer=c;this.maxPoint=d}static create(a,b,c,d){return new W(a,b,c,d)}get length(){let a=this.chunk.length-1;return 0>a?0:Math.max(this.chunkEnd(a),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let a=this.nextLayer.size;for(let b of this.chunk)a+=
b.value.length;return a}chunkEnd(a){return this.chunkPos[a]+this.chunk[a].length}update(a){let {add:b=[],sort:c=!1,filterFrom:d=0,filterTo:f=this.length}=a;a=a.filter;if(0==b.length&&!a)return this;c&&(b=b.slice().sort(Rd));if(this.isEmpty)return b.length?W.of(b):this;let g=(new Ei(this,null,-1)).goto(0),k=0,l=[],m=new yb;for(;g.value||k<b.length;)if(k<b.length&&0<=(g.from-b[k].from||g.startSide-b[k].value.startSide)){let n=b[k++];m.addInner(n.from,n.to,n.value)||l.push(n)}else if(1==g.rangeIndex&&
g.chunkIndex<this.chunk.length&&(k==b.length||this.chunkEnd(g.chunkIndex)<b[k].from)&&(!a||d>this.chunkEnd(g.chunkIndex)||f<this.chunkPos[g.chunkIndex])&&m.addChunk(this.chunkPos[g.chunkIndex],this.chunk[g.chunkIndex]))g.nextChunk();else{if(!a||d>g.to||f<g.from||a(g.from,g.to,g.value))m.addInner(g.from,g.to,g.value)||l.push(nd.create(g.from,g.to,g.value));g.next()}return m.finishInner(this.nextLayer.isEmpty&&!l.length?W.empty:this.nextLayer.update({add:l,filter:a,filterFrom:d,filterTo:f}))}map(a){if(a.empty||
this.isEmpty)return this;let b=[],c=[],d=-1;for(let f=0;f<this.chunk.length;f++){let g=this.chunkPos[f],k=this.chunk[f],l=a.touchesRange(g,g+k.length);if(!1===l)d=Math.max(d,k.maxPoint),b.push(k),c.push(a.mapPos(g));else if(!0===l){let {mapped:m,pos:n}=k.map(g,a);m&&(d=Math.max(d,m.maxPoint),b.push(m),c.push(n))}}a=this.nextLayer.map(a);return 0==b.length?a:new W(c,b,a||W.empty,d)}between(a,b,c){if(!this.isEmpty){for(let d=0;d<this.chunk.length;d++){let f=this.chunkPos[d],g=this.chunk[d];if(b>=f&&
a<=f+g.length&&!1===g.between(f,a-f,b-f,c))return}this.nextLayer.between(a,b,c)}}iter(a=0){return od.from([this]).goto(a)}get isEmpty(){return this.nextLayer==this}static iter(a,b=0){return od.from(a).goto(b)}static compare(a,b,c,d,f=-1){a=a.filter(m=>0<m.maxPoint||!m.isEmpty&&m.maxPoint>=f);b=b.filter(m=>0<m.maxPoint||!m.isEmpty&&m.maxPoint>=f);let g=$f(a,b,c),k=new mc(a,g,f),l=new mc(b,g,f);c.iterGaps((m,n,p)=>ag(k,m,l,n,p,d));c.empty&&0==c.length&&ag(k,0,l,0,0,d)}static eq(a,b,c=0,d){null==d&&
(d=1E9);var f=a.filter(l=>!l.isEmpty&&0>b.indexOf(l));let g=b.filter(l=>!l.isEmpty&&0>a.indexOf(l));if(f.length!=g.length)return!1;if(!f.length)return!0;let k=$f(f,g);f=(new mc(f,k,0)).goto(c);for(c=(new mc(g,k,0)).goto(c);;){if(f.to!=c.to||!Td(f.active,c.active)||f.point&&(!c.point||!f.point.eq(c.point)))return!1;if(f.to>d)return!0;f.next();c.next()}}static spans(a,b,c,d,f=-1){a=(new mc(a,null,f)).goto(b);for(f=a.openStart;;){let g=Math.min(a.to,c);a.point?(d.point(b,g,a.point,a.activeForPoint(a.to),
f,a.pointRank),f=a.openEnd(g)+(a.to>g?1:0)):g>b&&(d.span(b,g,a.active,f),f=a.openEnd(g));if(a.to>c)break;b=a.to;a.next()}return f}static of(a,b=!1){let c=new yb;for(let d of a instanceof nd?[a]:b?Gk(a):a)c.add(d.from,d.to,d.value);return c.finish()}};W.empty=new W([],[],null,-1);W.empty.nextLayer=W.empty;var yb=class{constructor(){this.chunks=[];this.chunkPos=[];this.chunkStart=-1;this.last=null;this.lastTo=this.lastFrom=-1E9;this.from=[];this.to=[];this.value=[];this.setMaxPoint=this.maxPoint=-1;
this.nextLayer=null}finishChunk(a){this.chunks.push(new Di(this.from,this.to,this.value,this.maxPoint));this.chunkPos.push(this.chunkStart);this.chunkStart=-1;this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint);this.maxPoint=-1;a&&(this.from=[],this.to=[],this.value=[])}add(a,b,c){this.addInner(a,b,c)||(this.nextLayer||(this.nextLayer=new yb)).add(a,b,c)}addInner(a,b,c){let d=a-this.lastTo||c.startSide-this.last.endSide;if(0>=d&&0>(a-this.lastFrom||c.startSide-this.last.startSide))throw Error("Ranges must be added sorted by `from` position and `startSide`");
if(0>d)return!1;250==this.from.length&&this.finishChunk(!0);0>this.chunkStart&&(this.chunkStart=a);this.from.push(a-this.chunkStart);this.to.push(b-this.chunkStart);this.last=c;this.lastFrom=a;this.lastTo=b;this.value.push(c);c.point&&(this.maxPoint=Math.max(this.maxPoint,b-a));return!0}addChunk(a,b){if(0>(a-this.lastTo||b.value[0].startSide-this.last.endSide))return!1;this.from.length&&this.finishChunk(!0);this.setMaxPoint=Math.max(this.setMaxPoint,b.maxPoint);this.chunks.push(b);this.chunkPos.push(a);
let c=b.value.length-1;this.last=b.value[c];this.lastFrom=b.from[c]+a;this.lastTo=b.to[c]+a;return!0}finish(){return this.finishInner(W.empty)}finishInner(a){this.from.length&&this.finishChunk(!1);if(0==this.chunks.length)return a;a=W.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(a):a,this.setMaxPoint);this.from=null;return a}},Ei=class{constructor(a,b,c,d=0){this.layer=a;this.skip=b;this.minPoint=c;this.rank=d}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?
this.value.endSide:0}goto(a,b=-1E9){this.chunkIndex=this.rangeIndex=0;this.gotoInner(a,b,!1);return this}gotoInner(a,b,c){for(;this.chunkIndex<this.layer.chunk.length;){let d=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(d)||this.layer.chunkEnd(this.chunkIndex)<a||d.maxPoint<this.minPoint))break;this.chunkIndex++;c=!1}this.chunkIndex<this.layer.chunk.length&&(a=this.layer.chunk[this.chunkIndex].findIndex(a-this.layer.chunkPos[this.chunkIndex],b,!0),(!c||this.rangeIndex<a)&&this.setRangeIndex(a));
this.next()}forward(a,b){0>(this.to-a||this.endSide-b)&&this.gotoInner(a,b,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1E9;this.value=null;break}else{let a=this.layer.chunkPos[this.chunkIndex],b=this.layer.chunk[this.chunkIndex];this.from=a+b.from[this.rangeIndex];this.to=a+b.to[this.rangeIndex];this.value=b.value[this.rangeIndex];this.setRangeIndex(this.rangeIndex+1);if(0>this.minPoint||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(a){if(a==
this.layer.chunk[this.chunkIndex].value.length){this.chunkIndex++;if(this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=a}nextChunk(){this.chunkIndex++;this.rangeIndex=0;this.next()}compare(a){return this.from-a.from||this.startSide-a.startSide||this.rank-a.rank||this.to-a.to||this.endSide-a.endSide}},od=class{constructor(a){this.heap=a}static from(a,b=null,c=-1){let d=[];for(let f=0;f<
a.length;f++)for(let g=a[f];!g.isEmpty;g=g.nextLayer)g.maxPoint>=c&&d.push(new Ei(g,b,c,f));return 1==d.length?d[0]:new od(d)}get startSide(){return this.value?this.value.startSide:0}goto(a,b=-1E9){for(let c of this.heap)c.goto(a,b);for(a=this.heap.length>>1;0<=a;a--)Sd(this.heap,a);this.next();return this}forward(a,b){for(var c of this.heap)c.forward(a,b);for(c=this.heap.length>>1;0<=c;c--)Sd(this.heap,c);0>(this.to-a||this.value.endSide-b)&&this.next()}next(){if(0==this.heap.length)this.from=this.to=
1E9,this.value=null,this.rank=-1;else{let a=this.heap[0];this.from=a.from;this.to=a.to;this.value=a.value;this.rank=a.rank;a.value&&a.next();Sd(this.heap,0)}}},mc=class{constructor(a,b,c){this.minPoint=c;this.active=[];this.activeTo=[];this.activeRank=[];this.minActive=-1;this.point=null;this.pointRank=this.pointFrom=0;this.to=-1E9;this.endSide=0;this.openStart=-1;this.cursor=od.from(a,b,c)}goto(a,b=-1E9){this.cursor.goto(a,b);this.active.length=this.activeTo.length=this.activeRank.length=0;this.minActive=
-1;this.to=a;this.endSide=b;this.openStart=-1;this.next();return this}forward(a,b){for(;-1<this.minActive&&0>(this.activeTo[this.minActive]-a||this.active[this.minActive].endSide-b);)this.removeActive(this.minActive);this.cursor.forward(a,b)}removeActive(a){Dc(this.active,a);Dc(this.activeTo,a);Dc(this.activeRank,a);this.minActive=bg(this.active,this.activeTo)}addActive(a){let b=0,{value:c,to:d,rank:f}=this.cursor;for(;b<this.activeRank.length&&this.activeRank[b]<=f;)b++;Ec(this.active,b,c);Ec(this.activeTo,
b,d);Ec(this.activeRank,b,f);a&&Ec(a,b,this.cursor.from);this.minActive=bg(this.active,this.activeTo)}next(){let a=this.to;var b=this.point;this.point=null;let c=0>this.openStart?[]:null,d=0;for(;;){var f=this.minActive;if(-1<f&&0>(this.activeTo[f]-this.cursor.from||this.active[f].endSide-this.cursor.startSide)){if(this.activeTo[f]>a){this.to=this.activeTo[f];this.endSide=this.active[f].endSide;break}this.removeActive(f);c&&Dc(c,f)}else if(this.cursor.value)if(this.cursor.from>a){this.to=this.cursor.from;
this.endSide=this.cursor.startSide;break}else if(f=this.cursor.value,f.point)if(b&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=f;this.pointFrom=this.cursor.from;this.pointRank=this.cursor.rank;this.to=this.cursor.to;this.endSide=f.endSide;this.cursor.from<a&&(d=1);this.cursor.next();this.forward(this.to,this.endSide);break}else this.addActive(c),this.cursor.next();else{this.to=this.endSide=1E9;break}}if(c){for(b=0;b<c.length&&c[b]<a;)b++;this.openStart=
b+d}}activeForPoint(a){if(!this.active.length)return this.active;let b=[];for(let c=this.active.length-1;0<=c&&!(this.activeRank[c]<this.pointRank);c--)(this.activeTo[c]>a||this.activeTo[c]==a&&this.active[c].endSide>=this.point.endSide)&&b.push(this.active[c]);return b.reverse()}openEnd(a){let b=0;for(let c=this.activeTo.length-1;0<=c&&this.activeTo[c]>a;c--)b++;return b}},Fi="undefined"==typeof Symbol?"__\u037c":Symbol.for("\u037c"),Oe="undefined"==typeof Symbol?"__styleSet"+Math.floor(1E8*Math.random()):
Symbol("styleSet"),Gi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{},eb=class{constructor(a,b){function c(g){return/^@/.test(g)?[g]:g.split(/,\s*/)}function d(g,k,l,m){let n=[],p=/^@(\w+)\b/.exec(g[0]),q=p&&"keyframes"==p[1];if(p&&null==k)return l.push(g[0]+";");for(let r in k){let t=k[r];if(/&/.test(r))d(r.split(/,\s*/).map(v=>g.map(C=>v.replace(/&/,C))).reduce((v,C)=>v.concat(C)),t,l);else if(t&&"object"==typeof t){if(!p)throw new RangeError("The value of a property ("+
r+") should be a primitive value.");d(c(r),t,n,q)}else null!=t&&n.push(r.replace(/_.*/,"").replace(/[A-Z]/g,v=>"-"+v.toLowerCase())+": "+t+";")}(n.length||q)&&l.push((!f||p||m?g:g.map(f)).join(", ")+" {"+n.join(" ")+"}")}this.rules=[];let {finish:f}=b||{};for(let g in a)d(c(g),a[g],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let a=Gi[Fi]||1;Gi[Fi]=a+1;return"\u037c"+a.toString(36)}static mount(a,b){(a[Oe]||new Om(a)).mount(Array.isArray(b)?b:[b])}},pd=null,Om=class{constructor(a){if(!a.head&&
a.adoptedStyleSheets&&"undefined"!=typeof CSSStyleSheet){if(pd)return a.adoptedStyleSheets=[pd.sheet].concat(a.adoptedStyleSheets),a[Oe]=pd;this.sheet=new CSSStyleSheet;a.adoptedStyleSheets=[this.sheet].concat(a.adoptedStyleSheets);pd=this}else{this.styleTag=(a.ownerDocument||a).createElement("style");let b=a.head||a;b.insertBefore(this.styleTag,b.firstChild)}this.modules=[];a[Oe]=this}mount(a){var b=this.sheet;let c=0,d=0;for(let g=0;g<a.length;g++){let k=a[g];var f=this.modules.indexOf(k);f<d&&
-1<f&&(this.modules.splice(f,1),d--,f=-1);if(-1==f){if(this.modules.splice(d++,0,k),b)for(f=0;f<k.rules.length;f++)b.insertRule(k.rules[f],c++)}else{for(;d<f;)c+=this.modules[d++].rules.length;c+=k.rules.length;d++}}if(!b){a="";for(b=0;b<this.modules.length;b++)a+=this.modules[b].getRules()+"\n";this.styleTag.textContent=a}}},db={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",
38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Fc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",
191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Hi="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent);"undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent);var Pm="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Jk="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ik=Pm||Hi&&57>+Hi[1];for(ka=0;10>ka;ka++)db[48+ka]=db[96+ka]=String(ka);var ka;for(ka=1;24>=ka;ka++)db[ka+111]="F"+ka;for(ka=65;90>=
ka;ka++)db[ka]=String.fromCharCode(ka+32),Fc[ka]=String.fromCharCode(ka);for(qd in db)Fc.hasOwnProperty(qd)||(Fc[qd]=db[qd]);var qd,ig={left:0,right:0,top:0,bottom:0},Qm=class{constructor(){this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=0}eq(a){return this.anchorNode==a.anchorNode&&this.anchorOffset==a.anchorOffset&&this.focusNode==a.focusNode&&this.focusOffset==a.focusOffset}setRange(a){this.set(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)}set(a,b,c,d){this.anchorNode=
a;this.anchorOffset=b;this.focusNode=c;this.focusOffset=d}},Gb=null,Lk,oa=class{constructor(a,b,c=!0){this.node=a;this.offset=b;this.precise=c}static before(a,b){return new oa(a.parentNode,Wd(a),b)}static after(a,b){return new oa(a.parentNode,Wd(a)+1,b)}},Pe=[],da=class{constructor(){this.dom=this.parent=null;this.dirty=2}get editorView(){if(!this.parent)throw Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?
this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(a){let b=this.posAtStart;for(let c of this.children){if(c==a)return b;b+=c.length+c.breakAfter}throw new RangeError("Invalid child in posBefore");}posAfter(a){return this.posBefore(a)+a.length}coordsAt(a,b){return null}sync(a){if(this.dirty&2){var b=this.dom;let c=null,d;for(let f of this.children){if(f.dirty){if(!f.dom&&(d=c?c.nextSibling:b.firstChild)){let g=da.get(d);g&&(g.parent||g.constructor!=f.constructor)||
f.reuseDOM(d)}f.sync(a);f.dirty=0}d=c?c.nextSibling:b.firstChild;a&&!a.written&&a.node==b&&d!=f.dom&&(a.written=!0);if(f.dom.parentNode==b)for(;d&&d!=f.dom;)d=fg(d);else b.insertBefore(f.dom,d);c=f.dom}(d=c?c.nextSibling:b.firstChild)&&a&&a.node==b&&(a.written=!0);for(;d;)d=fg(d)}else if(this.dirty&1)for(b of this.children)b.dirty&&(b.sync(a),b.dirty=0)}reuseDOM(a){}localPosFromDOM(a,b){if(a==this.dom)a=this.dom.childNodes[b];else{for(b=0==Ic(a)?0:0==b?-1:1;;){let c=a.parentNode;if(c==this.dom)break;
0==b&&c.firstChild!=c.lastChild&&(b=a==c.firstChild?-1:1);a=c}a=0>b?a:a.nextSibling}if(a==this.dom.firstChild)return 0;for(;a&&!da.get(a);)a=a.nextSibling;if(!a)return this.length;for(let c=0,d=0;;c++){b=this.children[c];if(b.dom==a)return d;d+=b.length+b.breakAfter}}domBoundsAround(a,b,c=0){let d=-1,f=-1,g=-1,k=-1;for(let l=0,m=c,n=c;l<this.children.length;l++){let p=this.children[l],q=m+p.length;if(m<a&&q>b)return p.domBoundsAround(a,b,m);q>=a&&-1==d&&(d=l,f=m);if(m>b&&p.dom.parentNode==this.dom){g=
l;k=n;break}n=q;m=q+p.breakAfter}return{from:f,to:0>k?c+this.length:k,startDOM:(d?this.children[d-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:g<this.children.length&&0<=g?this.children[g].dom:null}}markDirty(a=!1){this.dirty|=2;this.markParentsDirty(a)}markParentsDirty(a){for(let b=this.parent;b;b=b.parent){a&&(b.dirty|=2);if(b.dirty&1)break;b.dirty|=1;a=!1}}setParent(a){this.parent!=a&&(this.parent=a,this.dirty&&this.markParentsDirty(!0))}setDOM(a){this.dom&&(this.dom.cmView=null);this.dom=
a;a.cmView=this}get rootView(){for(let a=this;;){let b=a.parent;if(!b)return a;a=b}}replaceChildren(a,b,c=Pe){this.markDirty();for(let d=a;d<b;d++){let f=this.children[d];f.parent==this&&f.destroy()}this.children.splice(a,b-a,...c);for(a=0;a<c.length;a++)c[a].setParent(this)}ignoreMutation(a){return!1}ignoreEvent(a){return!1}childCursor(a=this.length){return new Ii(this.children,a,this.children.length)}childPos(a,b=1){return this.childCursor().findPos(a,b)}toString(){let a=this.constructor.name.replace("View",
"");return a+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==a?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(a){return a.cmView}get isEditable(){return!0}merge(a,b,c,d,f,g){return!1}become(a){return!1}getSide(){return 0}destroy(){this.parent=null}};da.prototype.breakAfter=0;var Ii=class{constructor(a,b,c){this.children=a;this.pos=b;this.i=c;this.off=0}findPos(a,b=1){for(;;){if(a>this.pos||a==this.pos&&(0<b||0==this.i||this.children[this.i-1].breakAfter))return this.off=
a-this.pos,this;let c=this.children[--this.i];this.pos-=c.length+c.breakAfter}}},Ca="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Qe="undefined"!=typeof document?document:{documentElement:{style:{}}},Re=/Edge\/(\d+)/.exec(Ca.userAgent),Ji=/MSIE \d/.test(Ca.userAgent),Se=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ca.userAgent),rd=!!(Ji||Se||Re),Ki=!rd&&/gecko\/(\d+)/i.test(Ca.userAgent),Te=!rd&&/Chrome\/(\d+)/.exec(Ca.userAgent),Li="webkitFontSmoothing"in Qe.documentElement.style,
Mi=!rd&&/Apple Computer/.test(Ca.vendor),Ni=Mi&&(/Mobile\/\w+/.test(Ca.userAgent)||2<Ca.maxTouchPoints),D={mac:Ni||/Mac/.test(Ca.platform),windows:/Win/.test(Ca.platform),linux:/Linux|X11/.test(Ca.platform),ie:rd,ie_version:Ji?Qe.documentMode||6:Se?+Se[1]:Re?+Re[1]:0,gecko:Ki,gecko_version:Ki?+(/Firefox\/(\d+)/.exec(Ca.userAgent)||[0,0])[1]:0,chrome:!!Te,chrome_version:Te?+Te[1]:0,ios:Ni,android:/Android\b/.test(Ca.userAgent),webkit:Li,safari:Mi,webkit_version:Li?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||
[0,0])[1]:0,tabSize:null!=Qe.documentElement.style.tabSize?"tab-size":"-moz-tab-size"},zb=class extends da{constructor(a){super();this.text=a}get length(){return this.text.length}createDOM(a){this.setDOM(a||document.createTextNode(this.text))}sync(a){this.dom||this.createDOM();this.dom.nodeValue!=this.text&&(a&&a.node==this.dom&&(a.written=!0),this.dom.nodeValue=this.text)}reuseDOM(a){3==a.nodeType&&this.createDOM(a)}merge(a,b,c){if(c&&(!(c instanceof zb)||256<this.length-(b-a)+c.length))return!1;
this.text=this.text.slice(0,a)+(c?c.text:"")+this.text.slice(b);this.markDirty();return!0}split(a){let b=new zb(this.text.slice(a));this.text=this.text.slice(0,a);this.markDirty();return b}localPosFromDOM(a,b){return a==this.dom?b:b?this.text.length:0}domAtPos(a){return new oa(this.dom,a)}domBoundsAround(a,b,c){return{from:c,to:c+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(a,b){return Xd(this.dom,a,b)}},Xa=class extends da{constructor(a,b=[],c=0){super();this.mark=a;this.children=
b;this.length=c;for(let d of b)d.setParent(this)}setAttrs(a){eg(a);this.mark.class&&(a.className=this.mark.class);if(this.mark.attrs)for(let b in this.mark.attrs)a.setAttribute(b,this.mark.attrs[b]);return a}reuseDOM(a){a.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(a),this.dirty|=6)}sync(a){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName)));super.sync(a)}merge(a,b,c,d,f,g){if(c&&(!(c instanceof Xa&&c.mark.eq(this.mark))||
a&&0>=f||b<this.length&&0>=g))return!1;hg(this,a,b,c?c.children:[],f-1,g-1);this.markDirty();return!0}split(a){let b=[];var c=0;let d=-1,f=0;for(let g of this.children){let k=c+g.length;k>a&&b.push(c<a?g.split(a-c):g);0>d&&c>=a&&(d=f);c=k;f++}c=this.length-a;this.length=a;-1<d&&(this.children.length=d,this.markDirty());return new Xa(this.mark,b,c)}domAtPos(a){return kg(this.dom,this.children,a)}coordsAt(a,b){return mg(this,a,b)}},Ab=class extends da{constructor(a,b,c){super();this.widget=a;this.length=
b;this.side=c;this.prevWidget=null}static create(a,b,c){return new (a.customView||Ab)(a,b,c)}split(a){let b=Ab.create(this.widget,this.length-a,this.side);this.length-=a;return b}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(a,b,c,d,f,g){if(c&&(!(c instanceof Ab&&this.widget.compare(c.widget))||0<a&&
0>=f||b<this.length&&0>=g))return!1;this.length=a+(c?c.length:0)+(this.length-b);return!0}become(a){return a.length==this.length&&a instanceof Ab&&a.side==this.side&&this.widget.constructor==a.widget.constructor?(this.widget.eq(a.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=a.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(a){return this.widget.ignoreEvent(a)}get overrideDOMText(){if(0==this.length)return V.empty;for(var a=this;a.parent;)a=
a.parent;a=(a=a.editorView)&&a.state.doc;let b=this.posAtStart;return a?a.slice(b,b+this.length):V.empty}domAtPos(a){return 0==a?oa.before(this.dom):oa.after(this.dom,a==this.length)}domBoundsAround(){return null}coordsAt(a,b){let c=this.dom.getClientRects(),d;if(!c.length)return ig;for(let f=0<a?c.length-1:0;!(d=c[f],0<a?0==f:f==c.length-1||d.top<d.bottom);f+=0<a?-1:1);return 0==a&&0<b||a==this.length&&0>=b?d:Jc(d,0==a)}get isEditable(){return!1}destroy(){super.destroy();this.dom&&this.widget.destroy(this.dom)}},
ug=class extends Ab{domAtPos(a){let {topView:b,text:c}=this.widget;return b?Yd(a,0,b,c,(d,f)=>d.domAtPos(f),d=>new oa(c,Math.min(d,c.nodeValue.length))):new oa(c,Math.min(a,c.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(a,b){let {topView:c,text:d}=this.widget;return c?jg(a,b,c,d):Math.min(b,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(a,b){let {topView:c,text:d}=this.widget;return c?Yd(a,b,c,d,(f,g,k)=>f.coordsAt(g,k),(f,g)=>Xd(d,
f,g)):Xd(d,a,b)}destroy(){var a;super.destroy();null===(a=this.widget.topView)||void 0===a?void 0:a.destroy()}get isEditable(){return!0}},nc=class extends da{constructor(a){super();this.side=a}get length(){return 0}merge(){return!1}become(a){return a instanceof nc&&a.side==this.side}split(){return new nc(this.side)}sync(){if(!this.dom){let a=document.createElement("img");a.className="cm-widgetBuffer";a.setAttribute("aria-hidden","true");this.setDOM(a)}}getSide(){return this.side}domAtPos(a){return oa.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(a){a=
this.dom.getBoundingClientRect();a:{var b=0<this.side?-1:1;let d=this.parent,f=d?d.children.indexOf(this):-1;for(;d&&0<=f;)if(0>b?0<f:f<d.children.length){var c=d.children[f+b];if(c instanceof zb&&(c=c.coordsAt(0>b?c.length:0,b))){b=c;break a}f+=b}else if(d instanceof Xa&&d.parent)f=d.parent.children.indexOf(d)+(0>b?0:1),d=d.parent;else{if((b=d.dom.lastChild)&&"BR"==b.nodeName){b=b.getClientRects()[0];break a}break}b=void 0}return b&&b.top<a.bottom&&b.bottom>a.top?{left:a.left,right:a.right,top:b.top,
bottom:b.bottom}:a}get overrideDOMText(){return V.empty}};zb.prototype.children=Ab.prototype.children=nc.prototype.children=Pe;var kb=class{eq(a){return!1}updateDOM(a){return!1}compare(a){return this==a||this.constructor==a.constructor&&this.eq(a)}get estimatedHeight(){return-1}ignoreEvent(a){return!0}get customView(){return null}destroy(a){}},X=function(a){a[a.Text=0]="Text";a[a.WidgetBefore=1]="WidgetBefore";a[a.WidgetAfter=2]="WidgetAfter";a[a.WidgetRange=3]="WidgetRange";return a}(X||={}),H=class extends xb{constructor(a,
b,c,d){super();this.startSide=a;this.endSide=b;this.widget=c;this.spec=d}get heightRelevant(){return!1}static mark(a){return new Ue(a)}static widget(a){let b=a.side||0,c=!!a.block;b+=c?0<b?3E8:-4E8:0<b?1E8:-1E8;return new Sb(a,b,b,c,a.widget||null,!1)}static replace(a){let b=!!a.block,c,d;if(a.isBlockGap)c=-5E8,d=4E8;else{let {start:f,end:g}=ng(a,b);c=(f?b?-3E8:-1:5E8)-1;d=(g?b?2E8:1:-6E8)+1}return new Sb(a,c,d,b,a.widget||null,!0)}static line(a){return new sd(a)}static set(a,b=!1){return W.of(a,
b)}hasHeight(){return this.widget?-1<this.widget.estimatedHeight:!1}};H.none=W.empty;var Ue=class extends H{constructor(a){let {start:b,end:c}=ng(a);super(b?-1:5E8,c?1:-6E8,null,a);this.tagName=a.tagName||"span";this.class=a.class||"";this.attrs=a.attributes||null}eq(a){return this==a||a instanceof Ue&&this.tagName==a.tagName&&this.class==a.class&&$d(this.attrs,a.attrs)}range(a,b=a){if(a>=b)throw new RangeError("Mark decorations may not be empty");return super.range(a,b)}};Ue.prototype.point=!1;var sd=
class extends H{constructor(a){super(-2E8,-2E8,null,a)}eq(a){return a instanceof sd&&$d(this.spec.attributes,a.spec.attributes)}range(a,b=a){if(b!=a)throw new RangeError("Line decoration ranges must be zero-length");return super.range(a,b)}};sd.prototype.mapMode=xa.TrackBefore;sd.prototype.point=!0;var Sb=class extends H{constructor(a,b,c,d,f,g){super(b,c,f,a);this.block=d;this.isReplace=g;this.mapMode=d?0>=b?xa.TrackBefore:xa.TrackAfter:xa.TrackDel}get type(){return this.startSide<this.endSide?X.WidgetRange:
0>=this.startSide?X.WidgetBefore:X.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&5<=this.widget.estimatedHeight}eq(a){var b;if(b=a instanceof Sb){b=this.widget;var c=a.widget;b=b==c||!!(b&&c&&b.compare(c))}return b&&this.block==a.block&&this.startSide==a.startSide&&this.endSide==a.endSide}range(a,b=a){if(this.isReplace&&(a>b||a==b&&0<this.startSide&&0>=this.endSide))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&b!=a)throw new RangeError("Widget decorations can only have zero-length ranges");
return super.range(a,b)}};Sb.prototype.point=!0;var wa=class extends da{constructor(){super(...arguments);this.children=[];this.length=0;this.prevAttrs=void 0;this.attrs=null;this.breakAfter=0}merge(a,b,c,d,f,g){if(c){if(!(c instanceof wa))return!1;this.dom||c.transferDOM(this)}d&&this.setDeco(c?c.attrs:null);hg(this,a,b,c?c.children:[],f,g);return!0}split(a){let b=new wa;b.breakAfter=this.breakAfter;if(0==this.length)return b;let {i:c,off:d}=this.childPos(a);d&&(b.append(this.children[c].split(d),
0),this.children[c].merge(d,this.children[c].length,null,!1,0,0),c++);for(let f=c;f<this.children.length;f++)b.append(this.children[f],0);for(;0<c&&0==this.children[c-1].length;)this.children[--c].destroy();this.children.length=c;this.markDirty();this.length=a;return b}transferDOM(a){this.dom&&(this.markDirty(),a.setDOM(this.dom),a.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(a){$d(this.attrs,a)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),
this.attrs=a)}append(a,b){lg(this,a,b)}addLineDeco(a){let b=a.spec.attributes;a=a.spec.class;b&&(this.attrs=Zd(b,this.attrs||{}));a&&(this.attrs=Zd({class:a},this.attrs||{}))}domAtPos(a){return kg(this.dom,this.children,a)}reuseDOM(a){"DIV"==a.nodeName&&(this.setDOM(a),this.dirty|=6)}sync(a){var b;this.dom?this.dirty&4&&(eg(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?
null:void 0);void 0!==this.prevAttrs&&(ae(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0);super.sync(a);for(a=this.dom.lastChild;a&&da.get(a)instanceof Xa;)a=a.lastChild;a&&this.length&&("BR"==a.nodeName||0!=(null===(b=da.get(a))||void 0===b?void 0:b.isEditable)||D.ios&&this.children.some(c=>c instanceof zb))||(b=document.createElement("BR"),b.cmIgnore=!0,this.dom.appendChild(b))}measureTextSize(){if(0==this.children.length||20<this.length)return null;
let a=0;for(let b of this.children){if(!(b instanceof zb))return null;let c=$b(b.dom);if(1!=c.length)return null;a+=c[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:a/this.length}}coordsAt(a,b){return mg(this,a,b)}become(a){return!1}get type(){return X.Text}static find(a,b){for(let c=0,d=0;c<a.children.length;c++){let f=a.children[c],g=d+f.length;if(g>=b){if(f instanceof wa)return f;if(g>b)break}d=g+f.breakAfter}return null}},Tb=class extends da{constructor(a,b,c){super();
this.widget=a;this.length=b;this.type=c;this.breakAfter=0;this.prevWidget=null}merge(a,b,c,d,f,g){if(c&&(!(c instanceof Tb&&this.widget.compare(c.widget))||0<a&&0>=f||b<this.length&&0>=g))return!1;this.length=a+(c?c.length:0)+(this.length-b);return!0}domAtPos(a){return 0==a?oa.before(this.dom):oa.after(this.dom,a==this.length)}split(a){let b=this.length-a;this.length=a;a=new Tb(this.widget,b,this.type);a.breakAfter=this.breakAfter;return a}get children(){return Pe}sync(){this.dom&&this.widget.updateDOM(this.dom)||
(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):V.empty}domBoundsAround(){return null}become(a){return a instanceof Tb&&a.type==this.type&&a.widget.constructor==this.widget.constructor?(a.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),
this.widget=a.widget,this.length=a.length,this.breakAfter=a.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(a){return this.widget.ignoreEvent(a)}destroy(){super.destroy();this.dom&&this.widget.destroy(this.dom)}},Pi=class{constructor(a,b,c,d){this.doc=a;this.pos=b;this.end=c;this.disallowBlockEffectsFor=d;this.content=[];this.curLine=null;this.pendingBuffer=this.breakAtStart=0;this.atCursorPos=!0;this.openEnd=this.openStart=-1;this.text="";this.textOff=0;this.cursor=a.iter();this.skip=b}posCovered(){if(0==
this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let a=this.content[this.content.length-1];return!a.breakAfter&&!(a instanceof Tb&&a.type==X.WidgetBefore)}getLine(){this.curLine||(this.content.push(this.curLine=new wa),this.atCursorPos=!0);return this.curLine}flushBuffer(a){this.pendingBuffer&&(this.curLine.append(Kc(new nc(-1),a),a.length),this.pendingBuffer=0)}addBlockWidget(a){this.flushBuffer([]);this.curLine=null;this.content.push(a)}finish(a){a?this.pendingBuffer=
0:this.flushBuffer([]);this.posCovered()||this.getLine()}buildText(a,b,c){for(;0<a;){if(this.textOff==this.text.length){let {value:f,lineBreak:g,done:k}=this.cursor.next(this.skip);this.skip=0;if(k)throw Error("Ran out of text content when drawing inline views");if(g){this.posCovered()||this.getLine();this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1;this.flushBuffer([]);this.curLine=null;a--;continue}else this.text=f,this.textOff=0}let d=Math.min(this.text.length-
this.textOff,a,512);this.flushBuffer(b.slice(0,c));this.getLine().append(Kc(new zb(this.text.slice(this.textOff,this.textOff+d)),b),c);this.atCursorPos=!0;this.textOff+=d;a-=d;c=0}}span(a,b,c,d){this.buildText(b-a,c,d);this.pos=b;0>this.openStart&&(this.openStart=d)}point(a,b,c,d,f,g){if(this.disallowBlockEffectsFor[g]&&c instanceof Sb){if(c.block)throw new RangeError("Block decorations may not be specified via plugins");if(b>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins");
}g=b-a;if(c instanceof Sb)if(c.block)({type:a}=c),a!=X.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new Tb(c.widget||new Oi("div"),g,a));else{let k=Ab.create(c.widget||new Oi("span"),g,c.startSide),l=this.atCursorPos&&!k.isEditable&&f<=d.length&&(a<b||0<c.startSide);c=!k.isEditable&&(a<b||0>=c.startSide);let m=this.getLine();2!=this.pendingBuffer||l||(this.pendingBuffer=0);this.flushBuffer(d);l&&(m.append(Kc(new nc(1),d),f),f=d.length+Math.max(0,f-d.length));m.append(Kc(k,d),
f);this.pendingBuffer=(this.atCursorPos=c)?a<b?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(c);g&&(this.textOff+g<=this.text.length?this.textOff+=g:(this.skip+=g-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=b);0>this.openStart&&(this.openStart=f)}static build(a,b,c,d,f){a=new Pi(a,b,c,f);a.openEnd=W.spans(d,b,c,a);0>a.openStart&&(a.openStart=a.openEnd);a.finish(a.openEnd);return a}},Oi=class extends kb{constructor(a){super();this.tag=a}eq(a){return a.tag==
this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(a){return a.nodeName.toLowerCase()==this.tag}},Qi=E.define(),Ri=E.define(),Si=E.define(),og=E.define(),Ve=E.define(),Rg=E.define(),Ti=E.define({combine:a=>a.some(b=>b)}),We=class{constructor(a,b="nearest",c="nearest",d=5,f=5){this.range=a;this.y=b;this.x=c;this.yMargin=d;this.xMargin=f}map(a){return a.empty?this:new We(this.range.map(a),this.y,this.x,this.yMargin,this.xMargin)}},Ui=K.define({map:(a,b)=>a.map(b)}),dc=E.define({combine:a=>
a.length?a[0]:!0}),Rm=0,oc=E.define(),fa=class{constructor(a,b,c,d){this.id=a;this.create=b;this.domEventHandlers=c;this.extension=d(this)}static define(a,b){const {eventHandlers:c,provide:d,decorations:f}=b||{};return new fa(Rm++,a,c,g=>{let k=[oc.of(g)];f&&k.push(pc.of(l=>(l=l.plugin(g))?f(l):H.none));d&&k.push(d(g));return k})}static fromClass(a,b){return fa.define(c=>new a(c),b)}},Xe=class{constructor(a){this.spec=a;this.value=this.mustUpdate=null}update(a){if(!this.value){if(this.spec)try{this.value=
this.spec.create(a)}catch(b){za(a.state,b,"CodeMirror plugin crashed"),this.deactivate()}}else if(this.mustUpdate&&(a=this.mustUpdate,this.mustUpdate=null,this.value.update))try{this.value.update(a)}catch(b){za(a.state,b,"CodeMirror plugin crashed");if(this.value.destroy)try{this.value.destroy()}catch(c){}this.deactivate()}return this}destroy(a){var b;if(null===(b=this.value)||void 0===b?0:b.destroy)try{this.value.destroy()}catch(c){za(a.state,c,"CodeMirror plugin crashed")}}deactivate(){this.spec=
this.value=null}},Vi=E.define(),Wi=E.define(),pc=E.define(),Cg=E.define(),Xi=E.define(),qc=E.define(),lb=class{constructor(a,b,c,d){this.fromA=a;this.toA=b;this.fromB=c;this.toB=d}join(a){return new lb(Math.min(this.fromA,a.fromA),Math.max(this.toA,a.toA),Math.min(this.fromB,a.fromB),Math.max(this.toB,a.toB))}addToSet(a){let b=a.length,c=this;for(;0<b;b--){let d=a[b-1];if(!(d.fromA>c.toA)){if(d.toA<c.fromA)break;c=c.join(d);a.splice(b-1,1)}}a.splice(b,0,c);return a}static extendWithRanges(a,b){if(0==
b.length)return a;let c=[];for(let d=0,f=0,g=0,k=0;;d++){let l=d==a.length?null:a[d],m=g-k,n=l?l.fromB:1E9;for(;f<b.length&&b[f]<n;){let p=b[f+1],q=Math.max(k,b[f]),r=Math.min(n,p);q<=r&&(new lb(q+m,r+m,q,r)).addToSet(c);if(p>n)break;else f+=2}if(!l)return c;(new lb(l.fromA,l.toA,l.fromB,l.toB)).addToSet(c);g=l.toA;k=l.toB}}},Ye=class{constructor(a,b,c){this.view=a;this.state=b;this.transactions=c;this.flags=0;this.startState=a.state;this.changes=ia.empty(this.startState.doc.length);for(let f of c)this.changes=
this.changes.compose(f.changes);let d=[];this.changes.iterChangedRanges((f,g,k,l)=>d.push(new lb(f,g,k,l)));this.changedRanges=d;b=a.hasFocus;b!=a.inputState.notifiedFocused&&(a.inputState.notifiedFocused=b,this.flags|=1)}static create(a,b,c){return new Ye(a,b,c)}get viewportChanged(){return 0<(this.flags&4)}get heightChanged(){return 0<(this.flags&2)}get geometryChanged(){return this.docChanged||0<(this.flags&10)}get focusChanged(){return 0<(this.flags&1)}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(a=>
a.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}},ca=function(a){a[a.LTR=0]="LTR";a[a.RTL=1]="RTL";return a}(ca||={}),Ze=ca.LTR,Sm=ca.RTL,Tm=pg("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Um=pg("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),
$e=Object.create(null),Ka=[];for(let a of["()","[]","{}"]){let b=a.charCodeAt(0),c=a.charCodeAt(1);$e[b]=c;$e[c]=-b}var Vm=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,rb=class{constructor(a,b,c){this.from=a;this.to=b;this.level=c}get dir(){return this.level%2?Sm:Ze}side(a,b){return this.dir==b==a?this.to:this.from}static find(a,b,c,d){let f=-1;for(let g=0;g<a.length;g++){let k=a[g];if(k.from<=b&&k.to>=b){if(k.level==c)return g;if(0>f||(0!=d?0>d?k.from<b:k.to>b:a[f].level>k.level))f=g}}if(0>f)throw new RangeError("Index out of range");
return f}},ba=[],Bg="",tg=class{constructor(a,b){this.points=a;this.text="";this.lineSeparator=b.facet(R.lineSeparator)}append(a){this.text+=a}lineBreak(){this.text+="\uffff"}readRange(a,b){if(!a)return this;let c=a.parentNode;for(;;){this.findPointBefore(c,a);this.readNode(a);let d=a.nextSibling;if(d==b)break;let f=da.get(a),g=da.get(d);(f&&g?f.breakAfter:(f?f.breakAfter:qg(a))||qg(d)&&("BR"!=a.nodeName||a.cmIgnore))&&this.lineBreak();a=d}this.findPointBefore(c,b);return this}readTextNode(a){let b=
a.nodeValue;for(var c of this.points)c.node==a&&(c.pos=this.text.length+Math.min(c.offset,b.length));for(let d=0,f=this.lineSeparator?null:/\r\n?|\n/g;;){c=-1;let g=1,k;if(this.lineSeparator)c=b.indexOf(this.lineSeparator,d),g=this.lineSeparator.length;else if(k=f.exec(b))c=k.index,g=k[0].length;this.append(b.slice(d,0>c?b.length:c));if(0>c)break;this.lineBreak();if(1<g)for(let l of this.points)l.node==a&&l.pos>this.text.length&&(l.pos-=g-1);d=c+g}}readNode(a){if(!a.cmIgnore){var b=da.get(a);b=b&&
b.overrideDOMText;if(null!=b)for(this.findPointInside(a,b.length),a=b.iter();!a.next().done;)a.lineBreak?this.lineBreak():this.append(a.value);else 3==a.nodeType?this.readTextNode(a):"BR"==a.nodeName?a.nextSibling&&this.lineBreak():1==a.nodeType&&this.readRange(a.firstChild,null)}}findPointBefore(a,b){for(let c of this.points)c.node==a&&a.childNodes[c.offset]==b&&(c.pos=this.text.length)}findPointInside(a,b){for(let c of this.points)if(3==a.nodeType?c.node==a:a.contains(c.node))c.pos=this.text.length+
Math.min(b,c.offset)}},Sg=class{constructor(a,b){this.node=a;this.offset=b;this.pos=-1}},Zi=class extends da{constructor(a){super();this.view=a;this.compositionDeco=H.none;this.decorations=[];this.dynamicDecorationMap=[];this.minWidthTo=this.minWidthFrom=this.minWidth=0;this.impreciseHead=this.impreciseAnchor=null;this.forceSelection=!1;this.lastUpdate=Date.now();this.setDOM(a.contentDOM);this.children=[new wa];this.children[0].setParent(this);this.updateDeco();this.updateInner([new lb(0,0,0,a.state.doc.length)],
0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(a){let b=a.changedRanges;0<this.minWidth&&b.length&&(b.every(({fromA:f,toA:g})=>g<this.minWidthFrom||f>this.minWidthTo)?(this.minWidthFrom=a.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=a.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);if(0>this.view.inputState.composing)this.compositionDeco=H.none;else if(a.transactions.length||this.dirty)this.compositionDeco=
Nk(this.view,a.changes);(D.ie||D.chrome)&&!this.compositionDeco.size&&a&&a.state.doc.lines!=a.startState.doc.lines&&(this.forceSelection=!0);var c=this.decorations;let d=this.updateDeco();c=Pk(c,d,a.changes);b=lb.extendWithRanges(b,c);if(0==this.dirty&&0==b.length)return!1;this.updateInner(b,a.startState.doc.length);a.transactions.length&&(this.lastUpdate=Date.now());return!0}updateInner(a,b){this.view.viewState.mustMeasureContent=!0;this.updateChildren(a,b);let {observer:c}=this.view;c.ignore(()=>
{this.dom.style.height=this.view.viewState.contentHeight+"px";this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let d=D.chrome||D.ios?{node:c.selectionRange.focusNode,written:!1}:void 0;this.sync(d);this.dirty=0;d&&(d.written||c.selectionRange.focusNode!=d.node)&&(this.forceSelection=!0);this.dom.style.height=""});a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let d of this.children)d instanceof Tb&&d.widget instanceof Yi&&a.push(d.dom);c.updateGaps(a)}updateChildren(a,
b){b=this.childCursor(b);for(let c=a.length-1;;c--){let d=0<=c?a[c]:null;if(!d)break;let {fromA:f,toA:g,fromB:k,toB:l}=d,{content:m,breakAtStart:n,openStart:p,openEnd:q}=Pi.build(this.view.state.doc,k,l,this.decorations,this.dynamicDecorationMap),{i:r,off:t}=b.findPos(g,1),{i:v,off:C}=b.findPos(f,-1);gg(this,v,C,r,t,m,n,p,q)}}updateSelection(a=!1,b=!1){a&&this.view.observer.readSelectionRange();if(!(!b&&!this.mayControlSelection()||D.ios&&this.view.inputState.rapidCompositionStart)){a=this.forceSelection;
this.forceSelection=!1;var c=this.view.state.selection.main,d=this.domAtPos(c.anchor),f=c.empty?d:this.domAtPos(c.head);if(D.gecko&&c.empty&&1==d.node.nodeType&&d.node.firstChild&&(0==d.offset||"false"==d.node.childNodes[d.offset-1].contentEditable)&&(d.offset==d.node.childNodes.length||"false"==d.node.childNodes[d.offset].contentEditable)){let k=document.createTextNode("");this.view.observer.ignore(()=>d.node.insertBefore(k,d.node.childNodes[d.offset]||null));d=f=new oa(k,0);a=!0}var g=this.view.observer.selectionRange;
!a&&g.focusNode&&Hc(d.node,d.offset,g.anchorNode,g.anchorOffset)&&Hc(f.node,f.offset,g.focusNode,g.focusOffset)||(this.view.observer.ignore(()=>{var k;if(k=D.android&&D.chrome&&this.dom.contains(g.focusNode))a:{for(k=g.focusNode;k&&k!=this.dom;k=k.assignedSlot||k.parentNode)if(1==k.nodeType&&"false"==k.contentEditable){k=!0;break a}k=!1}k&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));k=Gc(this.root);if(c.empty){if(D.gecko){var l=d.node;var m=d.offset;l=1!=l.nodeType?0:(m&&"false"==l.childNodes[m-
1].contentEditable?1:0)|(m<l.childNodes.length&&"false"==l.childNodes[m].contentEditable?2:0);l&&3!=l&&(m=sg(d.node,d.offset,1==l?1:-1))&&(d=new oa(m,1==l?0:m.nodeValue.length))}k.collapse(d.node,d.offset);null!=c.bidiLevel&&null!=g.cursorBidiLevel&&(g.cursorBidiLevel=c.bidiLevel)}else k.extend?(k.collapse(d.node,d.offset),k.extend(f.node,f.offset)):(l=document.createRange(),c.anchor>c.head&&([d,f]=[f,d]),l.setEnd(f.node,f.offset),l.setStart(d.node,d.offset),k.removeAllRanges(),k.addRange(l))}),this.view.observer.setSelectionRange(d,
f));this.impreciseAnchor=d.precise?null:new oa(g.anchorNode,g.anchorOffset);this.impreciseHead=f.precise?null:new oa(g.focusNode,g.focusOffset)}}enforceCursorAssoc(){if(!this.compositionDeco.size){var a=this.view.state.selection.main,b=Gc(this.root);if(a.empty&&a.assoc&&b.modify){var c=wa.find(this,a.head);if(c){var d=c.posAtStart;a.head!=d&&a.head!=d+c.length&&(c=this.coordsAt(a.head,-1),d=this.coordsAt(a.head,1),!c||!d||c.bottom>d.top||(c=this.domAtPos(a.head+a.assoc),b.collapse(c.node,c.offset),
b.modify("move",0>a.assoc?"forward":"backward","lineboundary")))}}}}mayControlSelection(){return this.view.state.facet(dc)?this.root.activeElement==this.dom:Vd(this.dom,this.view.observer.selectionRange)}nearest(a){for(;a;){let b=da.get(a);if(b&&b.rootView==this)return b;a=a.parentNode}return null}posFromDOM(a,b){let c=this.nearest(a);if(!c)throw new RangeError("Trying to find position for a DOM position outside of the document");return c.localPosFromDOM(a,b)+c.posAtStart}domAtPos(a){let {i:b,off:c}=
this.childCursor().findPos(a,-1);for(;b<this.children.length-1;){a=this.children[b];if(c<a.length||a instanceof wa)break;b++;c=0}return this.children[b].domAtPos(c)}coordsAt(a,b){for(let c=this.length,d=this.children.length-1;;d--){let f=this.children[d],g=c-f.breakAfter-f.length;if(a>g||a==g&&f.type!=X.WidgetBefore&&f.type!=X.WidgetAfter&&(!d||2==b||this.children[d-1].breakAfter||this.children[d-1].type==X.WidgetBefore&&-2<b))return f.coordsAt(a-g,b);c=g}}measureVisibleLineHeights(a){let b=[],{from:c,
to:d}=a;a=this.view.contentDOM.clientWidth;let f=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,g=-1,k=this.view.textDirection==ca.LTR;for(let n=0,p=0;p<this.children.length;p++){let q=this.children[p],r=n+q.length;if(r>d)break;if(n>=c){var l=q.dom.getBoundingClientRect();b.push(l.height);if(f){var m=q.dom.lastChild;m=m?$b(m):[];m.length&&(m=m[m.length-1],l=k?m.right-l.left:l.right-m.left,l>g&&(g=l,this.minWidth=a,this.minWidthFrom=n,this.minWidthTo=r))}}n=r+q.breakAfter}return b}textDirectionAt(a){({i:a}=
this.childPos(a,1));return"rtl"==getComputedStyle(this.children[a].dom).direction?ca.RTL:ca.LTR}measureTextSize(){for(let d of this.children)if(d instanceof wa){let f=d.measureTextSize();if(f)return f}let a=document.createElement("div"),b,c;a.className="cm-line";a.textContent="abc def ghi jkl mno pqr stu";this.view.observer.ignore(()=>{this.dom.appendChild(a);let d=$b(a.firstChild)[0];b=a.getBoundingClientRect().height;c=d?d.width/27:7;a.remove()});return{lineHeight:b,charWidth:c}}childCursor(a=this.length){let b=
this.children.length;b&&(a-=this.children[--b].length);return new Ii(this.children,a,b)}computeBlockGapDeco(){let a=[],b=this.view.viewState;for(let c=0,d=0;;d++){let f=d==b.viewports.length?null:b.viewports[d],g=f?f.from-1:this.length;if(g>c){let k=b.lineBlockAt(g).bottom-b.lineBlockAt(c).top;a.push(H.replace({widget:new Yi(k),block:!0,inclusive:!0,isBlockGap:!0}).range(c,g))}if(!f)break;c=f.to+1}return H.set(a)}updateDeco(){let a=this.view.state.facet(pc).map((b,c)=>(this.dynamicDecorationMap[c]=
"function"==typeof b)?b(this.view):b);for(let b=a.length;b<a.length+3;b++)this.dynamicDecorationMap[b]=!1;return this.decorations=[...a,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(a){let {range:b}=a,c=this.coordsAt(b.head,b.empty?b.assoc:b.head>b.anchor?-1:1);var d;if(c){!b.empty&&(d=this.coordsAt(b.anchor,b.anchor>b.head?-1:1))&&(c={left:Math.min(c.left,d.left),top:Math.min(c.top,d.top),right:Math.max(c.right,d.right),bottom:Math.max(c.bottom,d.bottom)});
var f=d=0,g=0,k=0;for(let l of this.view.state.facet(Xi).map(m=>m(this.view)))if(l){let {left:m,right:n,top:p,bottom:q}=l;null!=m&&(d=Math.max(d,m));null!=n&&(f=Math.max(f,n));null!=p&&(g=Math.max(g,p));null!=q&&(k=Math.max(k,q))}Kk(this.view.scrollDOM,{left:c.left-d,top:c.top-g,right:c.right+f,bottom:c.bottom+k},b.head<b.anchor?-1:1,a.x,a.y,a.xMargin,a.yMargin,this.view.textDirection==ca.LTR)}}},Yi=class extends kb{constructor(a){super();this.height=a}toDOM(){let a=document.createElement("div");
this.updateDOM(a);return a}eq(a){return a.height==this.height}updateDOM(a){a.style.height=this.height+"px";return!0}get estimatedHeight(){return this.height}},Ok=class extends kb{constructor(a,b,c){super();this.top=a;this.text=b;this.topView=c}eq(a){return this.top==a.top&&this.text==a.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return ug}},Qk=class{constructor(){this.changes=[]}compareRange(a,b){be(a,b,this.changes)}comparePoint(a,b){be(a,b,this.changes)}},Wm=class{constructor(a){this.lastKeyTime=
this.lastKeyCode=0;this.chromeScrollHack=-1;this.pendingIOSKey=void 0;this.lastSelectionOrigin=null;this.lastContextMenu=this.lastEscPress=this.lastSelectionTime=0;this.scrollHandlers=[];this.registeredEvents=[];this.customHandlers=[];this.composing=-1;this.compositionFirstChange=null;this.compositionEndedAt=0;this.rapidCompositionStart=!1;this.mouseSelection=null;for(let b in la){let c=la[b];a.contentDOM.addEventListener(b,d=>{!Dg(a,d)||this.ignoreDuringComposition(d)||"keydown"==b&&this.keydown(a,
d)||(this.mustFlushObserver(d)&&a.observer.forceFlush(),this.runCustomHandlers(b,a,d)?d.preventDefault():c(a,d))});this.registeredEvents.push(b)}D.chrome&&102<=D.chrome_version&&a.scrollDOM.addEventListener("wheel",()=>{0>this.chromeScrollHack?a.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack);this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1;a.contentDOM.style.pointerEvents=""},100)},{passive:!0});this.notifiedFocused=a.hasFocus;D.safari&&a.contentDOM.addEventListener("input",
()=>null)}setSelectionOrigin(a){this.lastSelectionOrigin=a;this.lastSelectionTime=Date.now()}ensureHandlers(a,b){var c;this.customHandlers=[];for(let d of b)if(b=null===(c=d.update(a).spec)||void 0===c?void 0:c.domEventHandlers){this.customHandlers.push({plugin:d.value,handlers:b});for(let f in b)0>this.registeredEvents.indexOf(f)&&"scroll"!=f&&(this.registeredEvents.push(f),a.contentDOM.addEventListener(f,g=>{Dg(a,g)&&this.runCustomHandlers(f,a,g)&&g.preventDefault()}))}}runCustomHandlers(a,b,c){for(let d of this.customHandlers){let f=
d.handlers[a];if(f)try{if(f.call(d.plugin,c,b)||c.defaultPrevented)return!0}catch(g){za(b.state,g)}}return!1}runScrollHandlers(a,b){for(let c of this.customHandlers){let d=c.handlers.scroll;if(d)try{d.call(c.plugin,b,a)}catch(f){za(a.state,f)}}}keydown(a,b){this.lastKeyCode=b.keyCode;this.lastKeyTime=Date.now();if(9==b.keyCode&&Date.now()<this.lastEscPress+2E3)return!0;if(D.android&&D.chrome&&!b.synthetic&&(13==b.keyCode||8==b.keyCode))return a.observer.delayAndroidKey(b.key,b.keyCode),!0;let c;return!D.ios||
!(c=$i.find(d=>d.keyCode==b.keyCode))||b.ctrlKey||b.altKey||b.metaKey||b.synthetic?!1:(this.pendingIOSKey=c,setTimeout(()=>this.flushIOSKey(a),250),!0)}flushIOSKey(a){let b=this.pendingIOSKey;if(!b)return!1;this.pendingIOSKey=void 0;return bc(a.contentDOM,b.key,b.keyCode)}ignoreDuringComposition(a){return/^key/.test(a.type)?0<this.composing?!0:D.safari&&100>Date.now()-this.compositionEndedAt?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(a){return"keydown"==a.type&&229!=a.keyCode||"compositionend"==
a.type&&!D.ios}startMouseSelection(a){this.mouseSelection&&this.mouseSelection.destroy();this.mouseSelection=a}update(a){this.mouseSelection&&this.mouseSelection.update(a);a.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}},$i=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Xg=[16,17,18,20,91,92,
224,225],Xm=class{constructor(a,b,c,d){this.view=a;this.style=c;this.mustSelect=d;this.lastEvent=b;c=a.contentDOM.ownerDocument;c.addEventListener("mousemove",this.move=this.move.bind(this));c.addEventListener("mouseup",this.up=this.up.bind(this));this.extend=b.shiftKey;if(c=a.state.facet(R.allowMultipleSelections))c=a.state.facet(Qi),c=c.length?c[0](b):D.mac?b.metaKey:b.ctrlKey;this.multiple=c;c=a.state.facet(Ri);this.dragMove=c.length?c[0](b):D.mac?!b.altKey:!b.ctrlKey;this.dragging=Tk(a,b)&&1==
ge(b)?null:!1;!1===this.dragging&&(b.preventDefault(),this.select(b))}move(a){if(0==a.buttons)return this.destroy();!1===this.dragging&&this.select(this.lastEvent=a)}up(a){null==this.dragging&&this.select(this.lastEvent);this.dragging||a.preventDefault();this.destroy()}destroy(){let a=this.view.contentDOM.ownerDocument;a.removeEventListener("mousemove",this.move);a.removeEventListener("mouseup",this.up);this.view.inputState.mouseSelection=null}select(a){a=this.style.get(a,this.extend,this.multiple);
!this.mustSelect&&a.eq(this.view.state.selection)&&a.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:a,userEvent:"select.pointer",scrollIntoView:!0});this.mustSelect=!1}update(a){a.docChanged&&this.dragging&&(this.dragging=this.dragging.map(a.changes));this.style.update(a)&&setTimeout(()=>this.select(this.lastEvent),20)}},la=Object.create(null),aj=D.ie&&15>D.ie_version||D.ios&&604>D.webkit_version;la.keydown=(a,b)=>{a.inputState.setSelectionOrigin("select");27==b.keyCode?
a.inputState.lastEscPress=Date.now():0>Xg.indexOf(b.keyCode)&&(a.inputState.lastEscPress=0)};var bj=0;la.touchstart=(a,b)=>{bj=Date.now();a.inputState.setSelectionOrigin("select.pointer")};la.touchmove=a=>{a.inputState.setSelectionOrigin("select.pointer")};la.mousedown=(a,b)=>{a.observer.flush();if(!(bj>Date.now()-2E3&&1==ge(b))){var c=null;for(var d of a.state.facet(Si))if(c=d(a,b))break;c||0!=b.button||(c=Wk(a,b));c&&((d=a.root.activeElement!=a.contentDOM)&&a.observer.ignore(()=>dg(a.contentDOM)),
a.inputState.startMouseSelection(new Xm(a,b,c,d)))}};var Vk=D.ie&&11>=D.ie_version,Hg=null,Jg=0,Ig=0;la.dragstart=(a,b)=>{let {selection:{main:c}}=a.state,{mouseSelection:d}=a.inputState;d&&(d.dragging=c);b.dataTransfer&&(b.dataTransfer.setData("Text",a.state.sliceDoc(c.from,c.to)),b.dataTransfer.effectAllowed="copyMove")};la.drop=(a,b)=>{if(b.dataTransfer){if(a.state.readOnly)return b.preventDefault();var c=b.dataTransfer.files;if(c&&c.length){b.preventDefault();let d=Array(c.length),f=0,g=()=>{++f==
c.length&&Kg(a,b,d.filter(k=>null!=k).join(a.state.lineBreak),!1)};for(let k=0;k<c.length;k++){let l=new FileReader;l.onerror=g;l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(d[k]=l.result);g()};l.readAsText(c[k])}}else Kg(a,b,b.dataTransfer.getData("Text"),!0)}};la.paste=(a,b)=>{if(a.state.readOnly)return b.preventDefault();a.observer.flush();let c=aj?null:b.clipboardData;c?(Eg(a,c.getData("text/plain")),b.preventDefault()):Uk(a)};var fe=null;la.copy=la.cut=(a,b)=>{var c=a.state;let d=
[],f=[];var g=!1;for(var k of c.selection.ranges)k.empty||(d.push(c.sliceDoc(k.from,k.to)),f.push(k));if(!d.length){g=-1;for(let {from:p}of c.selection.ranges)k=c.doc.lineAt(p),k.number>g&&(d.push(k.text),f.push({from:k.from,to:Math.min(c.doc.length,k.to+1)})),g=k.number;g=!0}c={text:d.join(c.lineBreak),ranges:f,linewise:g};let {text:l,ranges:m,linewise:n}=c;if(l||n)fe=n?l:null,(c=aj?null:b.clipboardData)?(b.preventDefault(),c.clearData(),c.setData("text/plain",l)):Xk(a,l),"cut"!=b.type||a.state.readOnly||
a.dispatch({changes:m,scrollIntoView:!0,userEvent:"delete.cut"})};la.focus=Lg;la.blur=a=>{a.observer.clearSelectionRange();Lg(a)};la.compositionstart=la.compositionupdate=a=>{null==a.inputState.compositionFirstChange&&(a.inputState.compositionFirstChange=!0);0>a.inputState.composing&&(a.inputState.composing=0,a.docView.compositionDeco.size&&(a.observer.flush(),Mg(a,!0)))};la.compositionend=a=>{a.inputState.composing=-1;a.inputState.compositionEndedAt=Date.now();a.inputState.compositionFirstChange=
null;setTimeout(()=>{0>a.inputState.composing&&Mg(a,!1)},50)};la.contextmenu=a=>{a.inputState.lastContextMenu=Date.now()};la.beforeinput=(a,b)=>{var c;let d;if(D.chrome&&D.android&&(d=$i.find(f=>f.inputType==b.inputType))&&(a.observer.delayAndroidKey(d.key,d.keyCode),"Backspace"==d.key||"Delete"==d.key)){let f=(null===(c=window.visualViewport)||void 0===c?void 0:c.height)||0;setTimeout(()=>{var g;((null===(g=window.visualViewport)||void 0===g?void 0:g.height)||0)>f+10&&a.hasFocus&&(a.contentDOM.blur(),
a.focus())},100)}};var cj=["pre-wrap","normal","pre-line","break-spaces"],Ym=class{constructor(){this.doc=V.empty;this.lineWrapping=!1;this.heightSamples={};this.lineHeight=14;this.charWidth=7;this.lineLength=30;this.heightChanged=!1}heightForGap(a,b){let c=this.doc.lineAt(b).number-this.doc.lineAt(a).number+1;this.lineWrapping&&(c+=Math.ceil((b-a-c*this.lineLength*.5)/this.lineLength));return this.lineHeight*c}heightForLine(a){return this.lineWrapping?(1+Math.max(0,Math.ceil((a-this.lineLength)/
(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(a){this.doc=a;return this}mustRefreshForWrapping(a){return-1<cj.indexOf(a)!=this.lineWrapping}mustRefreshForHeights(a){let b=!1;for(let c=0;c<a.length;c++){let d=a[c];0>d?c++:this.heightSamples[Math.floor(10*d)]||(b=!0,this.heightSamples[Math.floor(10*d)]=!0)}return b}refresh(a,b,c,d,f){let g=-1<cj.indexOf(a);a=Math.round(b)!=Math.round(this.lineHeight)||this.lineWrapping!=g;this.lineWrapping=g;this.lineHeight=b;this.charWidth=c;this.lineLength=
d;if(a)for(this.heightSamples={},b=0;b<f.length;b++)c=f[b],0>c?b++:this.heightSamples[Math.floor(10*c)]=!0;return a}},Zm=class{constructor(a,b){this.from=a;this.heights=b;this.index=0}get more(){return this.index<this.heights.length}},sb=class{constructor(a,b,c,d,f){this.from=a;this.length=b;this.top=c;this.height=d;this.type=f}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(a){let b=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(a.type)?a.type:
[a]);return new sb(this.from,this.length+a.length,this.top,this.height+a.height,b)}},Z=function(a){a[a.ByPos=0]="ByPos";a[a.ByHeight=1]="ByHeight";a[a.ByPosNoHeight=2]="ByPosNoHeight";return a}(Z||={}),Da=class{constructor(a,b,c=2){this.length=a;this.height=b;this.flags=c}get outdated(){return 0<(this.flags&2)}set outdated(a){this.flags=(a?2:0)|this.flags&-3}setHeight(a,b){this.height!=b&&(.001<Math.abs(this.height-b)&&(a.heightChanged=!0),this.height=b)}replace(a,b,c){return Da.of(c)}decomposeLeft(a,
b){b.push(this)}decomposeRight(a,b){b.push(this)}applyChanges(a,b,c,d){let f=this;for(let k=d.length-1;0<=k;k--){let {fromA:l,toA:m,fromB:n,toB:p}=d[k];var g=f.lineAt(l,Z.ByPosNoHeight,b,0,0);let q=g.to>=m?g:f.lineAt(m,Z.ByPosNoHeight,b,0,0);p+=q.to-m;for(m=q.to;0<k&&g.from<=d[k-1].toA;)l=d[k-1].fromA,n=d[k-1].fromB,k--,l<g.from&&(g=f.lineAt(l,Z.ByPosNoHeight,b,0,0));n+=g.from-l;l=g.from;g=dj.build(c,a,n,p);f=f.replace(l,m,g)}return f.updateHeight(c,0)}static empty(){return new La(0,0)}static of(a){if(1==
a.length)return a[0];let b=0,c=a.length;var d=0;let f=0;for(;;)if(b==c)if(d>2*f){var g=a[b-1];g.break?a.splice(--b,1,g.left,null,g.right):a.splice(--b,1,g.left,g.right);c+=1+g.break;d-=g.size}else if(f>2*d)g=a[c],g.break?a.splice(c,1,g.left,null,g.right):a.splice(c,1,g.left,g.right),c+=2+g.break,f-=g.size;else break;else d<f?(g=a[b++])&&(d+=g.size):(g=a[--c])&&(f+=g.size);d=0;null==a[b-1]?(d=1,b--):null==a[b]&&(d=1,c++);return new $m(Da.of(a.slice(0,b)),d,Da.of(a.slice(c)))}};Da.prototype.size=1;
var ej=class extends Da{constructor(a,b,c){super(a,b);this.type=c}blockAt(a,b,c,d){return new sb(d,this.length,c,this.height,this.type)}lineAt(a,b,c,d,f){return this.blockAt(0,c,d,f)}forEachLine(a,b,c,d,f,g){a<=f+this.length&&b>=f&&g(this.blockAt(0,c,d,f))}updateHeight(a,b=0,c,d){d&&d.from<=b&&d.more&&this.setHeight(a,d.heights[d.index++]);this.outdated=!1;return this}toString(){return`block(${this.length})`}},La=class extends ej{constructor(a,b){super(a,b,X.Text);this.widgetHeight=this.collapsed=
0}replace(a,b,c){a=c[0];return 1==c.length&&(a instanceof La||a instanceof pa&&a.flags&4)&&10>Math.abs(this.length-a.length)?(a instanceof pa?a=new La(a.length,this.height):a.height=this.height,this.outdated||(a.outdated=!1),a):Da.of(c)}updateHeight(a,b=0,c=!1,d){d&&d.from<=b&&d.more?this.setHeight(a,d.heights[d.index++]):(c||this.outdated)&&this.setHeight(a,Math.max(this.widgetHeight,a.heightForLine(this.length-this.collapsed)));this.outdated=!1;return this}toString(){return`line(${this.length}${this.collapsed?
-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},pa=class extends Da{constructor(a){super(a,0)}lines(a,b){let c=a.lineAt(b).number;a=a.lineAt(b+this.length).number;return{firstLine:c,lastLine:a,lineHeight:this.height/(a-c+1)}}blockAt(a,b,c,d){let {firstLine:f,lastLine:g,lineHeight:k}=this.lines(b,d);a=Math.max(0,Math.min(g-f,Math.floor((a-c)/k)));let {from:l,length:m}=b.line(f+a);return new sb(l,m,c+k*a,k,X.Text)}lineAt(a,b,c,d,f){if(b==Z.ByHeight)return this.blockAt(a,c,d,f);
if(b==Z.ByPosNoHeight){let {from:p,to:q}=c.lineAt(a);return new sb(p,q-p,0,0,X.Text)}let {firstLine:g,lineHeight:k}=this.lines(c,f),{from:l,length:m,number:n}=c.lineAt(a);return new sb(l,m,d+k*(n-g),k,X.Text)}forEachLine(a,b,c,d,f,g){let {firstLine:k,lineHeight:l}=this.lines(c,f);for(let m=Math.max(a,f),n=Math.min(f+this.length,b);m<=n;)b=c.lineAt(m),m==a&&(d+=l*(b.number-k)),g(new sb(b.from,b.length,d,l,X.Text)),d+=l,m=b.to+1}replace(a,b,c){b=this.length-b;if(0<b){let d=c[c.length-1];d instanceof
pa?c[c.length-1]=new pa(d.length+b):c.push(null,new pa(b-1))}0<a&&(b=c[0],b instanceof pa?c[0]=new pa(a+b.length):c.unshift(new pa(a-1),null));return Da.of(c)}decomposeLeft(a,b){b.push(new pa(a-1),null)}decomposeRight(a,b){b.push(null,new pa(this.length-a-1))}updateHeight(a,b=0,c=!1,d){let f=b+this.length;if(d&&d.from<=b+this.length&&d.more){let k=[],l=Math.max(b,d.from);c=-1;let m=a.heightChanged;for(d.from>b&&k.push((new pa(d.from-b-1)).updateHeight(a,b));l<=f&&d.more;){let n=a.doc.lineAt(l).length;
k.length&&k.push(null);var g=d.heights[d.index++];-1==c?c=g:.001<=Math.abs(g-c)&&(c=-2);g=new La(n,g);g.outdated=!1;k.push(g);l+=n+1}l<=f&&k.push(null,(new pa(f-l)).updateHeight(a,l));d=Da.of(k);a.heightChanged=m||0>c||.001<=Math.abs(d.height-this.height)||.001<=Math.abs(c-this.lines(a.doc,b).lineHeight);return d}if(c||this.outdated)this.setHeight(a,a.heightForGap(b,b+this.length)),this.outdated=!1;return this}toString(){return`gap(${this.length})`}},$m=class extends Da{constructor(a,b,c){super(a.length+
b+c.length,a.height+c.height,b|(a.outdated||c.outdated?2:0));this.left=a;this.right=c;this.size=a.size+c.size}get break(){return this.flags&1}blockAt(a,b,c,d){let f=c+this.left.height;return a<f?this.left.blockAt(a,b,c,d):this.right.blockAt(a,b,f,d+this.left.length+this.break)}lineAt(a,b,c,d,f){let g=d+this.left.height,k=f+this.left.length+this.break,l=b==Z.ByHeight?a<g:a<k;a=l?this.left.lineAt(a,b,c,d,f):this.right.lineAt(a,b,c,g,k);if(this.break||(l?a.to<k:a.from>k))return a;b=b==Z.ByPosNoHeight?
Z.ByPosNoHeight:Z.ByPos;return l?a.join(this.right.lineAt(k,b,c,g,k)):this.left.lineAt(k,b,c,d,f).join(a)}forEachLine(a,b,c,d,f,g){let k=d+this.left.height,l=f+this.left.length+this.break;if(this.break)a<l&&this.left.forEachLine(a,b,c,d,f,g),b>=l&&this.right.forEachLine(a,b,c,k,l,g);else{let m=this.lineAt(l,Z.ByPos,c,d,f);a<m.from&&this.left.forEachLine(a,m.from-1,c,d,f,g);m.to>=a&&m.from<=b&&g(m);b>m.to&&this.right.forEachLine(m.to+1,b,c,k,l,g)}}replace(a,b,c){var d=this.left.length+this.break;if(b<
d)return this.balanced(this.left.replace(a,b,c),this.right);if(a>this.left.length)return this.balanced(this.left,this.right.replace(a-d,b-d,c));d=[];0<a&&this.decomposeLeft(a,d);let f=d.length;for(let g of c)d.push(g);0<a&&Ng(d,f-1);b<this.length&&(a=d.length,this.decomposeRight(b,d),Ng(d,a));return Da.of(d)}decomposeLeft(a,b){let c=this.left.length;if(a<=c)return this.left.decomposeLeft(a,b);b.push(this.left);this.break&&(c++,a>=c&&b.push(null));a>c&&this.right.decomposeLeft(a-c,b)}decomposeRight(a,
b){let c=this.left.length,d=c+this.break;if(a>=d)return this.right.decomposeRight(a-d,b);a<c&&this.left.decomposeRight(a,b);this.break&&a<d&&b.push(null);b.push(this.right)}balanced(a,b){if(a.size>2*b.size||b.size>2*a.size)return Da.of(this.break?[a,null,b]:[a,b]);this.left=a;this.right=b;this.height=a.height+b.height;this.outdated=a.outdated||b.outdated;this.size=a.size+b.size;this.length=a.length+this.break+b.length;return this}updateHeight(a,b=0,c=!1,d){let {left:f,right:g}=this,k=b+f.length+this.break,
l=null;d&&d.from<=b+f.length&&d.more?l=f=f.updateHeight(a,b,c,d):f.updateHeight(a,b,c);d&&d.from<=k+g.length&&d.more?l=g=g.updateHeight(a,k,c,d):g.updateHeight(a,k,c);if(l)return this.balanced(f,g);this.height=this.left.height+this.right.height;this.outdated=!1;return this}toString(){return this.left+(this.break?" ":"-")+this.right}},dj=class{constructor(a,b){this.pos=a;this.oracle=b;this.nodes=[];this.lineEnd=this.lineStart=-1;this.covering=null;this.writtenTo=a}get isCovered(){return this.covering&&
this.nodes[this.nodes.length-1]==this.covering}span(a,b){if(-1<this.lineStart){a=Math.min(b,this.lineEnd);let c=this.nodes[this.nodes.length-1];c instanceof La?c.length+=a-this.pos:(a>this.pos||!this.isCovered)&&this.nodes.push(new La(a-this.pos,-1));this.writtenTo=a;b>a&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=b}point(a,b,c){if(a<b||c.heightRelevant){let d=c.widget?c.widget.estimatedHeight:0;0>d&&(d=this.oracle.lineHeight);a=b-a;c.block?this.addBlock(new ej(a,d,c.type)):
(a||5<=d)&&this.addLineDeco(d,a)}else b>a&&this.span(a,b);-1<this.lineEnd&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(!(-1<this.lineStart)){var {from:a,to:b}=this.oracle.doc.lineAt(this.pos);this.lineStart=a;this.lineEnd=b;this.writtenTo<a&&((this.writtenTo<a-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,a-1)),this.nodes.push(null));this.pos>a&&this.nodes.push(new La(this.pos-a,-1));this.writtenTo=this.pos}}blankContent(a,
b){let c=new pa(b-a);this.oracle.doc.lineAt(a).to==b&&(c.flags|=4);return c}ensureLine(){this.enterLine();var a=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(a instanceof La)return a;a=new La(0,-1);this.nodes.push(a);return a}addBlock(a){this.enterLine();a.type!=X.WidgetAfter||this.isCovered||this.ensureLine();this.nodes.push(a);this.writtenTo=this.pos+=a.length;a.type!=X.WidgetBefore&&(this.covering=a)}addLineDeco(a,b){let c=this.ensureLine();c.length+=b;c.collapsed+=b;c.widgetHeight=
Math.max(c.widgetHeight,a);this.writtenTo=this.pos+=b}finish(a){let b=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(-1<this.lineStart)||b instanceof La||this.isCovered?(this.writtenTo<this.pos||null==b)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new La(0,-1));for(let c of this.nodes)c instanceof La&&c.updateHeight(this.oracle,a),a+=c?c.length:1;return this.nodes}static build(a,b,c,d){a=new dj(c,a);W.spans(b,c,d,a,0);return a.finish(c)}},Zk=class{constructor(){this.changes=
[]}compareRange(){}comparePoint(a,b,c,d){(a<b||c&&c.heightRelevant||d&&d.heightRelevant)&&be(a,b,this.changes,5)}},af=class{constructor(a,b,c){this.from=a;this.to=b;this.size=c}static same(a,b){if(a.length!=b.length)return!1;for(let c=0;c<a.length;c++){let d=a[c],f=b[c];if(d.from!=f.from||d.to!=f.to||d.size!=f.size)return!1}return!0}draw(a){return H.replace({widget:new an(this.size,a)}).range(this.from,this.to)}},an=class extends kb{constructor(a,b){super();this.size=a;this.vertical=b}eq(a){return a.size==
this.size&&a.vertical==this.vertical}toDOM(){let a=document.createElement("div");this.vertical?a.style.height=this.size+"px":(a.style.width=this.size+"px",a.style.height="2px",a.style.display="inline-block");return a}get estimatedHeight(){return this.vertical?this.size:-1}},gj=class{constructor(a){this.state=a;this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0};this.inView=!0;this.editorWidth=this.editorHeight=this.contentDOMHeight=this.contentDOMWidth=this.paddingBottom=this.paddingTop=
0;this.heightOracle=new Ym;this.scaler=fj;this.scrollTarget=null;this.printing=!1;this.mustMeasureContent=!0;this.defaultTextDirection=ca.RTL;this.visibleRanges=[];this.mustEnforceCursorAssoc=!1;this.stateDeco=a.facet(pc).filter(b=>"function"!=typeof b);this.heightMap=Da.empty().applyChanges(this.stateDeco,V.empty,this.heightOracle.setDoc(a.doc),[new lb(0,0,0,a.doc.length)]);this.viewport=this.getViewport(0,null);this.updateViewportLines();this.updateForViewport();this.lineGaps=this.ensureLineGaps([]);
this.lineGapDeco=H.set(this.lineGaps.map(b=>b.draw(!1)));this.computeVisibleRanges()}updateForViewport(){let a=[this.viewport],{main:b}=this.state.selection;for(let c=0;1>=c;c++){let d=c?b.head:b.anchor;if(!a.some(({from:f,to:g})=>d>=f&&d<=g)){let {from:f,to:g}=this.lineBlockAt(d);a.push(new td(f,g))}}this.viewports=a.sort((c,d)=>c.from-d.from);this.scaler=7E6>=this.heightMap.height?fj:new bn(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[];this.heightMap.forEachLine(this.viewport.from,
this.viewport.to,this.state.doc,0,0,a=>{this.viewportLines.push(1==this.scaler.scale?a:cc(a,this.scaler))})}update(a,b=null){this.state=a.state;var c=this.stateDeco;this.stateDeco=this.state.facet(pc).filter(f=>"function"!=typeof f);c=lb.extendWithRanges(a.changedRanges,Yk(c,this.stateDeco,a?a.changes:ia.empty(this.state.doc.length)));var d=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,a.startState.doc,this.heightOracle.setDoc(this.state.doc),c);this.heightMap.height!=
d&&(a.flags|=2);c=c.length?this.mapViewport(this.viewport,a.changes):this.viewport;if(b&&(b.range.head<c.from||b.range.head>c.to)||!this.viewportIsAppropriate(c))c=this.getViewport(0,b);d=!a.changes.empty||a.flags&2||c.from!=this.viewport.from||c.to!=this.viewport.to;this.viewport=c;this.updateForViewport();d&&this.updateViewportLines();(this.lineGaps.length||4E3<this.viewport.to-this.viewport.from)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,a.changes)));a.flags|=this.computeVisibleRanges();
b&&(this.scrollTarget=b);!this.mustEnforceCursorAssoc&&a.selectionSet&&a.view.lineWrapping&&a.state.selection.main.empty&&a.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(a){var b=a.contentDOM,c=window.getComputedStyle(b),d=this.heightOracle,f=c.whiteSpace;this.defaultTextDirection="rtl"==c.direction?ca.RTL:ca.LTR;let g=this.heightOracle.mustRefreshForWrapping(f);var k=g||this.mustMeasureContent||this.contentDOMHeight!=b.clientHeight;this.contentDOMHeight=b.clientHeight;this.mustMeasureContent=
!1;let l=0,m=0;var n=parseInt(c.paddingTop)||0;c=parseInt(c.paddingBottom)||0;if(this.paddingTop!=n||this.paddingBottom!=c)this.paddingTop=n,this.paddingBottom=c,l|=10;this.editorWidth!=a.scrollDOM.clientWidth&&(d.lineWrapping&&(k=!0),this.editorWidth=a.scrollDOM.clientWidth,l|=8);var p=(this.printing?al:$k)(b,this.paddingTop);n=p.top-this.pixelViewport.top;c=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;
p!=this.inView&&(this.inView=p)&&(k=!0);if(!this.inView)return 0;b=b.clientWidth;if(this.contentDOMWidth!=b||this.editorHeight!=a.scrollDOM.clientHeight)this.contentDOMWidth=b,this.editorHeight=a.scrollDOM.clientHeight,l|=8;if(k){k=a.docView.measureVisibleLineHeights(this.viewport);d.mustRefreshForHeights(k)&&(g=!0);if(g||d.lineWrapping&&Math.abs(b-this.contentDOMWidth)>d.charWidth){let {lineHeight:q,charWidth:r}=a.docView.measureTextSize();if(g=d.refresh(f,q,r,b/r,k))a.docView.minWidth=0,l|=8}0<
n&&0<c?m=Math.max(n,c):0>n&&0>c&&(m=Math.min(n,c));d.heightChanged=!1;for(let q of this.viewports)f=q.from==this.viewport.from?k:a.docView.measureVisibleLineHeights(q),this.heightMap=this.heightMap.updateHeight(d,0,g,new Zm(q.from,f));d.heightChanged&&(l|=2)}if(d=!this.viewportIsAppropriate(this.viewport,m)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to))this.viewport=this.getViewport(m,this.scrollTarget);this.updateForViewport();
(l&2||d)&&this.updateViewportLines();(this.lineGaps.length||4E3<this.viewport.to-this.viewport.from)&&this.updateLineGaps(this.ensureLineGaps(g?[]:this.lineGaps));l|=this.computeVisibleRanges();this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,a.docView.enforceCursorAssoc());return l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(a,b){var c=.5-Math.max(-.5,Math.min(.5,a/1E3/2));a=
this.heightMap;let d=this.state.doc,{visibleTop:f,visibleBottom:g}=this,k=new td(a.lineAt(f-1E3*c,Z.ByHeight,d,0,0).from,a.lineAt(g+1E3*(1-c),Z.ByHeight,d,0,0).to);if(b){let {head:l}=b.range;if(l<k.from||l>k.to){c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top);let m=a.lineAt(l,Z.ByPos,d,0,0);b="center"==b.y?(m.top+m.bottom)/2-c/2:"start"==b.y||"nearest"==b.y&&l<k.from?m.top:m.bottom-c;k=new td(a.lineAt(b-500,Z.ByHeight,d,0,0).from,a.lineAt(b+c+500,Z.ByHeight,d,0,0).to)}}return k}mapViewport(a,
b){let c=b.mapPos(a.from,-1);a=b.mapPos(a.to,1);return new td(this.heightMap.lineAt(c,Z.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(a,Z.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:a,to:b},c=0){if(!this.inView)return!0;let {top:d}=this.heightMap.lineAt(a,Z.ByPos,this.state.doc,0,0),{bottom:f}=this.heightMap.lineAt(b,Z.ByPos,this.state.doc,0,0),{visibleTop:g,visibleBottom:k}=this;return(0==a||d<=g-Math.max(10,Math.min(-c,250)))&&(b==this.state.doc.length||f>=k+Math.max(10,Math.min(c,
250)))&&d>g-2E3&&f<k+2E3}mapLineGaps(a,b){if(!a.length||b.empty)return a;let c=[];for(let d of a)b.touchesRange(d.from,d.to)||c.push(new af(b.mapPos(d.from),b.mapPos(d.to),d.size));return c}ensureLineGaps(a){let b=[];if(this.defaultTextDirection!=ca.LTR)return b;for(let g of this.viewportLines){if(4E3>g.length)continue;let k=bl(g.from,g.to,this.stateDeco);if(!(4E3>k.total)){var c=void 0,d=void 0;if(this.heightOracle.lineWrapping){var f=2E3/this.heightOracle.lineLength*this.heightOracle.lineHeight;
c=Lc(k,(this.visibleTop-g.top-f)/g.height);d=Lc(k,(this.visibleBottom-g.top+f)/g.height)}else f=k.total*this.heightOracle.charWidth,d=2E3*this.heightOracle.charWidth,c=Lc(k,(this.pixelViewport.left-d)/f),d=Lc(k,(this.pixelViewport.right+d)/f);f=[];c>g.from&&f.push({from:g.from,to:c});d<g.to&&f.push({from:d,to:g.to});c=this.state.selection.main;c.from>=g.from&&c.from<=g.to&&Pg(f,c.from-10,c.from+10);!c.empty&&c.to>=g.from&&c.to<=g.to&&Pg(f,c.to-10,c.to+10);for(let {from:l,to:m}of f)1E3<m-l&&b.push(cl(a,
n=>n.from>=g.from&&n.to<=g.to&&1E3>Math.abs(n.from-l)&&1E3>Math.abs(n.to-m))||new af(l,m,this.gapSize(g,l,m,k)))}}return b}gapSize(a,b,c,d){b=Og(d,c)-Og(d,b);return this.heightOracle.lineWrapping?a.height*b:d.total*this.heightOracle.charWidth*b}updateLineGaps(a){af.same(a,this.lineGaps)||(this.lineGaps=a,this.lineGapDeco=H.set(a.map(b=>b.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){var a=this.stateDeco;this.lineGaps.length&&(a=a.concat(this.lineGapDeco));let b=[];W.spans(a,this.viewport.from,
this.viewport.to,{span(c,d){b.push({from:c,to:d})},point(){}},20);a=b.length!=this.visibleRanges.length||this.visibleRanges.some((c,d)=>c.from!=b[d].from||c.to!=b[d].to);this.visibleRanges=b;return a?4:0}lineBlockAt(a){return a>=this.viewport.from&&a<=this.viewport.to&&this.viewportLines.find(b=>b.from<=a&&b.to>=a)||cc(this.heightMap.lineAt(a,Z.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(a){return cc(this.heightMap.lineAt(this.scaler.fromDOM(a),Z.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(a){return cc(this.heightMap.blockAt(this.scaler.fromDOM(a),
this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},td=class{constructor(a,b){this.from=a;this.to=b}},fj={toDOM(a){return a},fromDOM(a){return a},scale:1},bn=class{constructor(a,b,c){let d=0,f=0,g=0;this.viewports=c.map(({from:k,to:l})=>{let m=b.lineAt(k,Z.ByPos,a,0,0).top,n=b.lineAt(l,Z.ByPos,a,0,0).bottom;d+=n-m;return{from:k,to:l,top:m,bottom:n,domTop:0,domBottom:0}});this.scale=
(7E6-d)/(b.height-d);for(let k of this.viewports)k.domTop=g+(k.top-f)*this.scale,g=k.domBottom=k.domTop+(k.bottom-k.top),f=k.bottom}toDOM(a){for(let b=0,c=0,d=0;;b++){let f=b<this.viewports.length?this.viewports[b]:null;if(!f||a<f.top)return d+(a-c)*this.scale;if(a<=f.bottom)return f.domTop+(a-f.top);c=f.bottom;d=f.domBottom}}fromDOM(a){for(let b=0,c=0,d=0;;b++){let f=b<this.viewports.length?this.viewports[b]:null;if(!f||a<f.domTop)return c+(a-d)/this.scale;if(a<=f.domBottom)return f.top+(a-f.domTop);
c=f.bottom;d=f.domBottom}}},ud=E.define({combine:a=>a.join(" ")}),bf=E.define({combine:a=>-1<a.indexOf(!0)}),cf=eb.newName(),hj=eb.newName(),ij=eb.newName(),jj={"&light":"."+hj,"&dark":"."+ij},cn=he("."+cf,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",
overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",
padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},
"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},
"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",
minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",
overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",
border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},jj),dn={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},df=D.ie&&11>=D.ie_version,en=class{constructor(a,b,c){this.view=a;this.onChange=b;this.onScrollChanged=
c;this.active=!1;this.selectionRange=new Qm;this.selectionChanged=!1;this.resizeTimeout=this.delayedFlush=-1;this.queue=[];this.delayedAndroidKey=null;this.scrollTargets=[];this.resize=this.intersection=null;this.intersecting=!1;this.gapIntersection=null;this.gaps=[];this.parentCheck=-1;this.dom=a.contentDOM;this.observer=new MutationObserver(d=>{for(let f of d)this.queue.push(f);(D.ie&&11>=D.ie_version||D.ios&&a.composing)&&d.some(f=>"childList"==f.type&&f.removedNodes.length||"characterData"==f.type&&
f.oldValue.length>f.target.nodeValue.length)?this.flushSoon():this.flush()});df&&(this.onCharData=d=>{this.queue.push({target:d.target,type:"characterData",oldValue:d.prevValue});this.flushSoon()});this.onSelectionChange=this.onSelectionChange.bind(this);window.addEventListener("resize",this.onResize=this.onResize.bind(this));"function"==typeof ResizeObserver&&(this.resize=new ResizeObserver(()=>{if(this.view.docView.lastUpdate<Date.now()-75)this.onResize()}),this.resize.observe(a.scrollDOM));window.addEventListener("beforeprint",
this.onPrint=this.onPrint.bind(this));this.start();window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this));"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(d=>{0>this.parentCheck&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1E3));if(0<d.length&&0<d[d.length-1].intersectionRatio!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView))this.onScrollChanged(document.createEvent("Event"))},{}),
this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(d=>{if(0<d.length&&0<d[d.length-1].intersectionRatio)this.onScrollChanged(document.createEvent("Event"))},{}));this.listenForScroll();this.readSelectionRange();this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(a){this.intersecting&&this.flush(!1);this.onScrollChanged(a)}onResize(){0>this.resizeTimeout&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1;this.view.requestMeasure()},
50))}onPrint(){this.view.viewState.printing=!0;this.view.measure();setTimeout(()=>{this.view.viewState.printing=!1;this.view.requestMeasure()},500)}updateGaps(a){if(this.gapIntersection&&(a.length!=this.gaps.length||this.gaps.some((b,c)=>b!=a[c]))){this.gapIntersection.disconnect();for(let b of a)this.gapIntersection.observe(b);this.gaps=a}}onSelectionChange(a){if(this.readSelectionRange()&&!this.delayedAndroidKey){var {view:b}=this,c=this.selectionRange;if(b.state.facet(dc)?b.root.activeElement==
this.dom:Vd(b.dom,c)){var d=c.anchorNode&&b.docView.nearest(c.anchorNode);d&&d.ignoreEvent(a)||((D.ie&&11>=D.ie_version||D.android&&D.chrome)&&!b.state.selection.main.empty&&c.focusNode&&Hc(c.focusNode,c.focusOffset,c.anchorNode,c.anchorOffset)?this.flushSoon():this.flush(!1))}}}readSelectionRange(){var {root:a}=this.view,b=Gc(a);if(a=D.safari&&11==a.nodeType){for(a=document.activeElement;a&&a.shadowRoot;)a=a.shadowRoot.activeElement;a=a==this.view.contentDOM}b=a&&dl(this.view)||b;if(this.selectionRange.eq(b))return!1;
this.selectionRange.setRange(b);return this.selectionChanged=!0}setSelectionRange(a,b){this.selectionRange.set(a.node,a.offset,b.node,b.offset);this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let a=0,b=null;for(let c=this.dom;c;)if(1==c.nodeType)!b&&a<this.scrollTargets.length&&this.scrollTargets[a]==c?a++:b||=this.scrollTargets.slice(0,a),b&&b.push(c),c=c.assignedSlot||c.parentNode;else if(11==c.nodeType)c=c.host;else break;
a<this.scrollTargets.length&&!b&&(b=this.scrollTargets.slice(0,a));if(b){for(let c of this.scrollTargets)c.removeEventListener("scroll",this.onScroll);for(let c of this.scrollTargets=b)c.addEventListener("scroll",this.onScroll)}}ignore(a){if(!this.active)return a();try{return this.stop(),a()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,dn),df&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=
!1,this.observer.disconnect(),df&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords();this.queue.length=0;this.selectionChanged=!1}delayAndroidKey(a,b){this.delayedAndroidKey||requestAnimationFrame(()=>{let c=this.delayedAndroidKey;this.delayedAndroidKey=null;this.delayedFlush=-1;this.flush()||bc(this.view.contentDOM,c.key,c.keyCode)});this.delayedAndroidKey&&"Enter"!=a||(this.delayedAndroidKey={key:a,keyCode:b})}flushSoon(){0>this.delayedFlush&&
(this.delayedFlush=window.setTimeout(()=>{this.delayedFlush=-1;this.flush()},20))}forceFlush(){0<=this.delayedFlush&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){var a=this.queue;for(var b of this.observer.takeRecords())a.push(b);a.length&&(this.queue=[]);let c=b=-1,d=!1;for(let f of a)if(a=this.readMutation(f))a.typeOver&&(d=!0),-1==b?{from:b,to:c}=a:(b=Math.min(a.from,b),c=Math.max(a.to,c));return{from:b,to:c,typeOver:d}}flush(a=!0){if(!(0<=this.delayedFlush||
this.delayedAndroidKey)){a&&this.readSelectionRange();var {from:b,to:c,typeOver:d}=this.processRecords();a=this.selectionChanged&&Vd(this.dom,this.selectionRange);if(!(0>b)||a){this.selectionChanged=!1;a=this.view.state;var f=this.onChange(b,c,d);this.view.state==a&&this.view.update([]);return f}}}readMutation(a){let b=this.view.docView.nearest(a.target);if(!b||b.ignoreMutation(a))return null;b.markDirty("attributes"==a.type);"attributes"==a.type&&(b.dirty|=4);if("childList"==a.type){let c=Qg(b,a.previousSibling||
a.target.previousSibling,-1);a=Qg(b,a.nextSibling||a.target.nextSibling,1);return{from:c?b.posAfter(c):b.posAtStart,to:a?b.posBefore(a):b.posAtEnd,typeOver:!1}}return"characterData"==a.type?{from:b.posAtStart,to:b.posAtEnd,typeOver:a.target.nodeValue==a.oldValue}:null}destroy(){var a,b,c;this.stop();null===(a=this.intersection)||void 0===a?void 0:a.disconnect();null===(b=this.gapIntersection)||void 0===b?void 0:b.disconnect();null===(c=this.resize)||void 0===c?void 0:c.disconnect();for(let d of this.scrollTargets)d.removeEventListener("scroll",
this.onScroll);window.removeEventListener("scroll",this.onScroll);window.removeEventListener("resize",this.onResize);window.removeEventListener("beforeprint",this.onPrint);this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange);clearTimeout(this.parentCheck);clearTimeout(this.resizeTimeout)}},I=class{constructor(a={}){this.plugins=[];this.pluginMap=new Map;this.editorAttrs={};this.contentAttrs={};this.bidiCache=[];this.destroyed=!1;this.updateState=2;this.measureScheduled=
-1;this.measureRequests=[];this.contentDOM=document.createElement("div");this.scrollDOM=document.createElement("div");this.scrollDOM.tabIndex=-1;this.scrollDOM.className="cm-scroller";this.scrollDOM.appendChild(this.contentDOM);this.announceDOM=document.createElement("div");this.announceDOM.style.cssText="position: absolute; top: -10000px";this.announceDOM.setAttribute("aria-live","polite");this.dom=document.createElement("div");this.dom.appendChild(this.announceDOM);this.dom.appendChild(this.scrollDOM);
this._dispatch=a.dispatch||(b=>this.update([b]));this.dispatch=this.dispatch.bind(this);this.root=a.root||Mk(a.parent)||document;this.viewState=new gj(a.state||R.create());this.plugins=this.state.facet(oc).map(b=>new Xe(b));for(let b of this.plugins)b.update(this);this.observer=new en(this,(b,c,d)=>el(this,b,c,d),b=>{this.inputState.runScrollHandlers(this,b);this.observer.intersecting&&this.measure()});this.inputState=new Wm(this);this.inputState.ensureHandlers(this,this.plugins);this.docView=new Zi(this);
this.mountStyles();this.updateAttrs();this.updateState=0;this.requestMeasure();a.parent&&a.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return 0<this.inputState.composing}get compositionStarted(){return 0<=this.inputState.composing}dispatch(...a){this._dispatch(1==a.length&&a[0]instanceof ja?a[0]:this.state.update(...a))}update(a){if(0!=
this.updateState)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let b=!1,c=!1;var d=this.state;for(var f of a){if(f.startState!=d)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");d=f.state}if(this.destroyed)this.viewState.state=d;else{this.observer.clear();if(d.facet(R.phrases)!=this.state.facet(R.phrases))return this.setState(d);d=Ye.create(this,d,a);f=this.viewState.scrollTarget;try{this.updateState=
2;for(let g of a){f&&=f.map(g.changes);if(g.scrollIntoView){let {main:k}=g.state.selection;f=new We(k.empty?k:u.cursor(k.head,k.head>k.anchor?-1:1))}for(let k of g.effects)k.is(Ui)&&(f=k.value)}this.viewState.update(d,f);this.bidiCache=ef.update(this.bidiCache,d.changes);d.empty||(this.updatePlugins(d),this.inputState.update(d));b=this.docView.update(d);this.state.facet(qc)!=this.styleModules&&this.mountStyles();c=this.updateAttrs();this.showAnnouncements(a);this.docView.updateSelection(b,a.some(g=>
g.isUserEvent("select.pointer")))}finally{this.updateState=0}d.startState.facet(ud)!=d.state.facet(ud)&&(this.viewState.mustMeasureContent=!0);(b||c||f||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure();if(!d.empty)for(let g of this.state.facet(Ve))g(d)}}setState(a){if(0!=this.updateState)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)this.viewState.state=a;else{this.updateState=2;var b=this.hasFocus;
try{for(let c of this.plugins)c.destroy(this);this.viewState=new gj(a);this.plugins=a.facet(oc).map(c=>new Xe(c));this.pluginMap.clear();for(let c of this.plugins)c.update(this);this.docView=new Zi(this);this.inputState.ensureHandlers(this,this.plugins);this.mountStyles();this.updateAttrs();this.bidiCache=[]}finally{this.updateState=0}b&&this.focus();this.requestMeasure()}}updatePlugins(a){let b=a.startState.facet(oc);var c=a.state.facet(oc);if(b!=c){var d=[];for(let f of c)c=b.indexOf(f),0>c?d.push(new Xe(f)):
(c=this.plugins[c],c.mustUpdate=a,d.push(c));for(let f of this.plugins)f.mustUpdate!=a&&f.destroy(this);this.plugins=d;this.pluginMap.clear();this.inputState.ensureHandlers(this,this.plugins)}else for(d of this.plugins)d.mustUpdate=a;for(a=0;a<this.plugins.length;a++)this.plugins[a].update(this)}measure(a=!0){if(!this.destroyed){-1<this.measureScheduled&&cancelAnimationFrame(this.measureScheduled);this.measureScheduled=0;a&&this.observer.flush();a=null;try{for(let b=0;;b++){this.updateState=1;let c=
this.viewport,d=this.viewState.measure(this);if(!d&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(5<b){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let f=[];d&4||([this.measureRequests,f]=[f,this.measureRequests]);let g=f.map(n=>{try{return n.read(this)}catch(p){return za(this.state,p),kj}}),k=Ye.create(this,this.state,[]),l=!1,m=!1;k.flags|=d;a?a.flags|=d:a=k;this.updateState=2;k.empty||(this.updatePlugins(k),
this.inputState.update(k),this.updateAttrs(),l=this.docView.update(k));for(let n=0;n<f.length;n++)if(g[n]!=kj)try{let p=f[n];p.write&&p.write(g[n],this)}catch(p){za(this.state,p)}this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,m=!0);l&&this.docView.updateSelection(!0);if(this.viewport.from==c.from&&this.viewport.to==c.to&&!m&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(a&&!a.empty)for(let b of this.state.facet(Ve))b(a)}}get themeClasses(){return cf+
" "+(this.state.facet(bf)?ij:hj)+" "+this.state.facet(ud)}updateAttrs(){let a=Tg(this,Vi,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),b={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(dc)?"true":"false",class:"cm-content",style:`${D.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(b["aria-readonly"]="true");Tg(this,Wi,b);let c=this.observer.ignore(()=>{let d=ae(this.contentDOM,
this.contentAttrs,b),f=ae(this.dom,this.editorAttrs,a);return d||f});this.editorAttrs=a;this.contentAttrs=b;return c}showAnnouncements(a){let b=!0;for(let c of a)for(let d of c.effects)d.is(I.announce)&&(b&&(this.announceDOM.textContent=""),b=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=d.value)}mountStyles(){this.styleModules=this.state.facet(qc);eb.mount(this.root,this.styleModules.concat(cn).reverse())}readMeasured(){if(2==this.updateState)throw Error("Reading the editor layout isn't allowed during an update");
0==this.updateState&&-1<this.measureScheduled&&this.measure(!1)}requestMeasure(a){0>this.measureScheduled&&(this.measureScheduled=requestAnimationFrame(()=>this.measure()));if(a){if(null!=a.key)for(let b=0;b<this.measureRequests.length;b++)if(this.measureRequests[b].key===a.key){this.measureRequests[b]=a;return}this.measureRequests.push(a)}}plugin(a){let b=this.pluginMap.get(a);(void 0===b||b&&b.spec!=a)&&this.pluginMap.set(a,b=this.plugins.find(c=>c.spec==a)||null);return b&&b.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+
this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(a){this.readMeasured();return this.viewState.elementAtHeight(a)}lineBlockAtHeight(a){this.readMeasured();return this.viewState.lineBlockAtHeight(a)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(a){return this.viewState.lineBlockAt(a)}get contentHeight(){return this.viewState.contentHeight}moveByChar(a,b,c){return ee(this,a,Ag(this,a,b,
c))}moveByGroup(a,b){return ee(this,a,Ag(this,a,b,c=>Sk(this,a.head,c)))}moveToLineBoundary(a,b,c=!0){a:{let d=this.state.doc.lineAt(a.head);if(c=c&&this.lineWrapping?this.coordsAtPos(0>a.assoc&&a.head>d.from?a.head-1:a.head):null){let f=this.dom.getBoundingClientRect(),g=this.textDirectionAt(d.from);c=this.posAtCoords({x:b==(g==ca.LTR)?f.right-1:f.left+1,y:(c.top+c.bottom)/2});if(null!=c){b=u.cursor(c,b?-1:1);break a}}a=wa.find(this.docView,a.head);b=u.cursor(a?b?a.posAtEnd:a.posAtStart:b?d.to:d.from,
b?-1:1)}return b}moveVertically(a,b,c){a:{var d=a.head;let l=b?1:-1;if(d==(b?this.state.doc.length:0))d=u.cursor(d,a.assoc);else{b=a.goalColumn;var f=this.contentDOM.getBoundingClientRect(),g=this.coordsAtPos(d);var k=this.documentTop;g?(null==b&&(b=g.left-f.left),k=0>l?g.top:g.bottom):(g=this.viewState.lineBlockAt(d),null==b&&(b=Math.min(f.right-f.left,this.defaultCharacterWidth*(d-g.from))),k=(0>l?g.top:g.bottom)+k);g=f.left+b;c=null!==c&&void 0!==c?c:this.defaultLineHeight>>1;for(let m=0;;m+=10){let n=
k+(c+m)*l,p=yg(this,{x:g,y:n},!1,l);if(n<f.top||n>f.bottom||(0>l?p<d:p>d)){d=u.cursor(p,a.assoc,void 0,b);break a}}}}return ee(this,a,d)}domAtPos(a){return this.docView.domAtPos(a)}posAtDOM(a,b=0){return this.docView.posFromDOM(a,b)}posAtCoords(a,b=!0){this.readMeasured();return yg(this,a,b)}coordsAtPos(a,b=1){this.readMeasured();let c=this.docView.coordsAt(a,b);if(!c||c.left==c.right)return c;let d=this.state.doc.lineAt(a),f=this.bidiSpans(d);a=f[rb.find(f,a-d.from,-1,b)];return Jc(c,a.dir==ca.LTR==
0<b)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(a){if(!this.state.facet(Ti)||a<this.viewport.from||a>this.viewport.to)return this.textDirection;this.readMeasured();return this.docView.textDirectionAt(a)}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(a){if(a.length>fn)return[new rb(0,a.length,
0)];let b=this.textDirectionAt(a.from);for(var c of this.bidiCache)if(c.from==a.from&&c.dir==b)return c.order;var d=a.text;c=d.length;var f=b==Ze?1:2,g=b==Ze?2:1;if(!d||1==f&&!Vm.test(d))c=[new rb(0,c,0)];else{for(let n=0,p=f,q=f;n<c;n++){var k=d.charCodeAt(n);k=247>=k?Tm[k]:1424<=k&&1524>=k?2:1536<=k&&1785>=k?Um[k-1536]:1774<=k&&2220>=k?4:8192<=k&&8203>=k?256:8204==k?256:1;512==k?k=p:8==k&&4==q&&(k=16);ba[n]=4==k?2:k;k&7&&(q=k);p=k}for(let n=0,p=f,q=f;n<c;n++){k=ba[n];if(128==k)n<c-1&&p==ba[n+1]&&
p&24?k=ba[n]=p:ba[n]=256;else if(64==k){for(var l=n+1;l<c&&64==ba[l];)l++;var m=n&&8==p||l<c&&8==ba[l]?1==q?1:8:256;for(let r=n;r<l;r++)ba[r]=m;n=l-1}else 8==k&&1==q&&(ba[n]=1);p=k;k&7&&(q=k)}for(let n=0,p=0,q=0,r,t,v;n<c;n++)if(t=$e[r=d.charCodeAt(n)])if(0>t)for(k=p-3;0<=k;k-=3){if(Ka[k+1]==-t){l=Ka[k+2];(l=l&2?f:l&4?l&1?g:f:0)&&(ba[n]=ba[Ka[k]]=l);p=k;break}}else if(189==Ka.length)break;else Ka[p++]=n,Ka[p++]=r,Ka[p++]=q;else if(2==(v=ba[n])||1==v)for(q=(k=v==f)?0:1,l=p-3;0<=l;l-=3){m=Ka[l+2];if(m&
2)break;if(k)Ka[l+2]|=2;else{if(m&4)break;Ka[l+2]|=4}}for(g=0;g<c;g++)if(256==ba[g]){for(d=g+1;d<c&&256==ba[d];)d++;k=1==(g?ba[g-1]:f);for(k=k==(1==(d<c?ba[d]:f))?k?1:2:f;g<d;g++)ba[g]=k;g=d-1}d=[];if(1==f)for(f=0;f<c;){g=f;for(k=1!=ba[f++];f<c&&k==(1!=ba[f]);)f++;if(k)for(k=f;k>g;){l=k;for(m=2!=ba[--k];k>g&&m==(2!=ba[k-1]);)k--;d.push(new rb(k,l,m?2:1))}else d.push(new rb(g,f,0))}else for(f=0;f<c;){g=f;for(k=2==ba[f++];f<c&&k==(2==ba[f]);)f++;d.push(new rb(g,f,k?1:2))}c=d}this.bidiCache.push(new ef(a.from,
a.to,b,c));return c}get hasFocus(){var a;return(document.hasFocus()||D.safari&&(null===(a=this.inputState)||void 0===a?void 0:a.lastContextMenu)>Date.now()-3E4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{dg(this.contentDOM);this.docView.updateSelection()})}destroy(){for(let a of this.plugins)a.destroy(this);this.plugins=[];this.inputState.destroy();this.dom.remove();this.observer.destroy();-1<this.measureScheduled&&cancelAnimationFrame(this.measureScheduled);this.destroyed=
!0}static scrollIntoView(a,b={}){return Ui.of(new We("number"==typeof a?u.cursor(a):a,b.y,b.x,b.yMargin,b.xMargin))}static domEventHandlers(a){return fa.define(()=>({}),{eventHandlers:a})}static theme(a,b){let c=eb.newName();a=[ud.of(c),qc.of(he(`.${c}`,a))];b&&b.dark&&a.push(bf.of(!0));return a}static baseTheme(a){return lc.lowest(qc.of(he("."+cf,a,jj)))}};I.styleModule=qc;I.inputHandler=Rg;I.perLineTextDirection=Ti;I.exceptionSink=og;I.updateListener=Ve;I.editable=dc;I.mouseSelectionStyle=Si;I.dragMovesSelection=
Ri;I.clickAddsSelectionRange=Qi;I.decorations=pc;I.atomicRanges=Cg;I.scrollMargins=Xi;I.darkTheme=bf;I.contentAttributes=Wi;I.editorAttributes=Vi;I.lineWrapping=I.contentAttributes.of({"class":"cm-lineWrapping"});I.announce=K.define();var fn=4096,kj={},ef=class{constructor(a,b,c,d){this.from=a;this.to=b;this.dir=c;this.order=d}static update(a,b){if(b.empty)return a;let c=[],d=a.length?a[a.length-1].dir:ca.LTR;for(let f=Math.max(0,a.length-10);f<a.length;f++){let g=a[f];g.dir!=d||b.touchesRange(g.from,
g.to)||c.push(new ef(b.mapPos(g.from,1),b.mapPos(g.to,-1),g.dir,g.order))}return c}},jl=D.mac?"mac":D.windows?"win":D.linux?"linux":"key",gn=I.domEventHandlers({keydown(a,b){return Wg(Ug(b.state),a,b,"editor")}}),je=E.define({enables:gn}),Vg=new WeakMap,fb=null,kl=4E3,lj=!D.ios,rc=E.define({combine(a){return Wa(a,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(b,c)=>Math.min(b,c),drawRangeCursor:(b,c)=>b||c})}}),ah=class{constructor(a,b,c,d,f){this.left=a;this.top=b;this.width=c;this.height=
d;this.className=f}draw(){let a=document.createElement("div");a.className=this.className;this.adjust(a);return a}adjust(a){a.style.left=this.left+"px";a.style.top=this.top+"px";0<=this.width&&(a.style.width=this.width+"px");a.style.height=this.height+"px"}eq(a){return this.left==a.left&&this.top==a.top&&this.width==a.width&&this.height==a.height&&this.className==a.className}},hn=fa.fromClass(class{constructor(a){this.view=a;this.rangePieces=[];this.cursors=[];this.measureReq={read:this.readPos.bind(this),
write:this.drawSel.bind(this)};this.selectionLayer=a.scrollDOM.appendChild(document.createElement("div"));this.selectionLayer.className="cm-selectionLayer";this.selectionLayer.setAttribute("aria-hidden","true");this.cursorLayer=a.scrollDOM.appendChild(document.createElement("div"));this.cursorLayer.className="cm-cursorLayer";this.cursorLayer.setAttribute("aria-hidden","true");a.requestMeasure(this.measureReq);this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(rc).cursorBlinkRate+
"ms"}update(a){let b=a.startState.facet(rc)!=a.state.facet(rc);(b||a.selectionSet||a.geometryChanged||a.viewportChanged)&&this.view.requestMeasure(this.measureReq);a.transactions.some(c=>c.scrollIntoView)&&(this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink");b&&this.setBlinkRate()}readPos(){let {state:a}=this.view,b=a.facet(rc),c=a.selection.ranges.map(g=>g.empty?[]:ll(this.view,g)).reduce((g,k)=>g.concat(k)),d=[];for(let g of a.selection.ranges){var f=
g==a.selection.main;(g.empty?!f||lj:b.drawRangeCursor)&&(f=ml(this.view,g,f))&&d.push(f)}return{rangePieces:c,cursors:d}}drawSel({rangePieces:a,cursors:b}){if(a.length!=this.rangePieces.length||a.some((c,d)=>!c.eq(this.rangePieces[d]))){this.selectionLayer.textContent="";for(let c of a)this.selectionLayer.appendChild(c.draw());this.rangePieces=a}if(b.length!=this.cursors.length||b.some((c,d)=>!c.eq(this.cursors[d]))){let c=this.cursorLayer.children;if(c.length!==b.length){this.cursorLayer.textContent=
"";for(const d of b)this.cursorLayer.appendChild(d.draw())}else b.forEach((d,f)=>d.adjust(c[f]));this.cursors=b}}destroy(){this.selectionLayer.remove();this.cursorLayer.remove()}}),mj={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};lj&&(mj[".cm-line"].caretColor="transparent !important");var jn=lc.highest(I.theme(mj)),nj=K.define({map(a,b){return null==a?null:b.mapPos(a)}}),sc=na.define({create(){return null},update(a,
b){null!=a&&(a=b.changes.mapPos(a));return b.effects.reduce((c,d)=>d.is(nj)?d.value:c,a)}}),kn=fa.fromClass(class{constructor(a){this.view=a;this.cursor=null;this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(a){var b;let c=a.state.field(sc);null==c?null!=this.cursor&&(null===(b=this.cursor)||void 0===b?void 0:b.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),
(a.startState.field(sc)!=c||a.docChanged||a.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){var a=this.view.state.field(sc);a=null!=a&&this.view.coordsAtPos(a);if(!a)return null;let b=this.view.scrollDOM.getBoundingClientRect();return{left:a.left-b.left+this.view.scrollDOM.scrollLeft,top:a.top-b.top+this.view.scrollDOM.scrollTop,height:a.bottom-a.top}}drawCursor(a){this.cursor&&(a?(this.cursor.style.left=a.left+"px",this.cursor.style.top=a.top+"px",this.cursor.style.height=
a.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(a){this.view.state.field(sc)!=a&&this.view.dispatch({effects:nj.of(a)})}},{eventHandlers:{dragover(a){this.setDropPos(this.view.posAtCoords({x:a.clientX,y:a.clientY}))},dragleave(a){a.target!=this.view.contentDOM&&this.view.contentDOM.contains(a.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}}),ql=class{constructor(a){let {regexp:b,decoration:c,
boundary:d,maxLength:f=1E3}=a;if(!b.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=b;this.getDeco="function"==typeof c?c:()=>c;this.boundary=d;this.maxLength=f}createDeco(a){let b=new yb;for(let {from:c,to:d}of nl(a,this.maxLength))bh(a.state.doc,this.regexp,c,d,(f,g,k)=>b.add(f,g,this.getDeco(k,a,f)));return b.finish()}updateDeco(a,b){let c=1E9,d=-1;a.docChanged&&a.changes.iterChanges((f,g,k,l)=>{l>a.view.viewport.from&&k<a.view.viewport.to&&
(c=Math.min(k,c),d=Math.max(l,d))});return a.viewportChanged||1E3<d-c?this.createDeco(a.view):-1<d?this.updateRange(a.view,b.map(a.changes),c,d):b}updateRange(a,b,c,d){for(let g of a.visibleRanges){var f=Math.max(g.from,c);let k=Math.min(g.to,d);if(k>f){let l=a.state.doc.lineAt(f),m=l.to<k?a.state.doc.lineAt(k):l,n=Math.max(g.from,l.from),p=Math.min(g.to,m.to);if(this.boundary){for(;f>l.from;f--)if(this.boundary.test(l.text[f-1-l.from])){n=f;break}for(;k<m.to;k++)if(this.boundary.test(m.text[k-m.from])){p=
k;break}}let q=[],r;if(l==m)for(this.regexp.lastIndex=n-l.from;(r=this.regexp.exec(l.text))&&r.index<p-l.from;)f=r.index+l.from,q.push(this.getDeco(r,a,f).range(f,f+r[0].length));else bh(a.state.doc,this.regexp,n,p,(t,v,C)=>q.push(this.getDeco(C,a,t).range(t,v)));b=b.update({filterFrom:n,filterTo:p,filter:(t,v)=>t<n||v>p,add:q})}}return b}},ff=null!=/x/.unicode?"gu":"g",ln=RegExp("[\x00-\b\n-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\ufeff\ufff9-\ufffc]",ff),mn={0:"null",
7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},gf=null,Mc=E.define({combine(a){a=Wa(a,{render:null,specialChars:ln,addSpecialChars:null});var b;if(null==gf&&"undefined"!=
typeof document&&document.body){let c=document.body.style;gf=null!=(null!==(b=c.tabSize)&&void 0!==b?b:c.MozTabSize)}if(a.replaceTabs=!gf)a.specialChars=new RegExp("\t|"+a.specialChars.source,ff);a.addSpecialChars&&(a.specialChars=new RegExp(a.specialChars.source+"|"+a.addSpecialChars.source,ff));return a}}),pl=null,sl=class extends kb{constructor(a,b){super();this.options=a;this.code=b}eq(a){return a.code==this.code}toDOM(a){var b=this.code;b=32<=b?"\u2022":10==b?"\u2424":String.fromCharCode(9216+
b);a=a.state.phrase("Control character")+" "+(mn[this.code]||"0x"+this.code.toString(16));var c=this.options.render&&this.options.render(this.code,a,b);if(c)return c;c=document.createElement("span");c.textContent=b;c.title=a;c.setAttribute("aria-label",a);c.className="cm-specialChar";return c}ignoreEvent(){return!1}},rl=class extends kb{constructor(a){super();this.width=a}eq(a){return a.width==this.width}toDOM(){let a=document.createElement("span");a.textContent="\t";a.className="cm-tab";a.style.width=
this.width+"px";return a}ignoreEvent(){return!1}},nn=H.line({class:"cm-activeLine"}),on=fa.fromClass(class{constructor(a){this.decorations=this.getDeco(a)}update(a){if(a.docChanged||a.selectionSet)this.decorations=this.getDeco(a.view)}getDeco(a){let b=-1,c=[];for(let d of a.state.selection.ranges){if(!d.empty)return H.none;let f=a.lineBlockAt(d.head);f.from>b&&(c.push(nn.range(f.from)),b=f.from)}return H.set(c)}},{decorations:a=>a.decorations}),pn={Alt:[18,a=>a.altKey],Control:[17,a=>a.ctrlKey],Shift:[16,
a=>a.shiftKey],Meta:[91,a=>a.metaKey]},qn={style:"cursor: crosshair"},oj=class{constructor(a,b,c){this.facet=b;this.createTooltipView=c;this.input=a.state.facet(b);this.tooltips=this.input.filter(d=>d);this.tooltipViews=this.tooltips.map(c)}update(a){let b=a.state.facet(this.facet),c=b.filter(g=>g);if(b===this.input){for(var d of this.tooltipViews)d.update&&d.update(a);return!1}d=[];for(let g=0;g<c.length;g++){var f=c[g];let k=-1;if(f){for(let l=0;l<this.tooltips.length;l++){let m=this.tooltips[l];
m&&m.create==f.create&&(k=l)}0>k?d[g]=this.createTooltipView(f):(f=d[g]=this.tooltipViews[k],f.update&&f.update(a))}}for(let g of this.tooltipViews)0>d.indexOf(g)&&g.dom.remove();this.input=b;this.tooltips=c;this.tooltipViews=d;return!0}},hf=E.define({combine:a=>{var b,c,d;return{position:D.ios?"absolute":(null===(b=a.find(f=>f.position))||void 0===b?void 0:b.position)||"fixed",parent:(null===(c=a.find(f=>f.parent))||void 0===c?void 0:c.parent)||null,tooltipSpace:(null===(d=a.find(f=>f.tooltipSpace))||
void 0===d?void 0:d.tooltipSpace)||ul}}}),gi=fa.fromClass(class{constructor(a){var b;this.view=a;this.inView=!0;this.lastTransaction=0;this.measureTimeout=-1;let c=a.state.facet(hf);this.position=c.position;this.parent=c.parent;this.classes=a.themeClasses;this.createContainer();this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this};this.manager=new oj(a,jf,d=>this.createTooltip(d));this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(d=>
{Date.now()>this.lastTransaction-50&&0<d.length&&1>d[d.length-1].intersectionRatio&&this.measureSoon()},{threshold:[1]}):null;this.observeIntersection();null===(b=a.dom.ownerDocument.defaultView)||void 0===b?void 0:b.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this));this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):
this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let a of this.manager.tooltipViews)this.intersectionObserver.observe(a.dom)}}measureSoon(){0>this.measureTimeout&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1;this.maybeMeasure()},50))}update(a){a.transactions.length&&(this.lastTransaction=Date.now());var b=this.manager.update(a);b&&this.observeIntersection();b=b||a.geometryChanged;a=a.state.facet(hf);if(a.position!=
this.position){this.position=a.position;for(let c of this.manager.tooltipViews)c.dom.style.position=this.position;b=!0}if(a.parent!=this.parent){this.parent&&this.container.remove();this.parent=a.parent;this.createContainer();for(let c of this.manager.tooltipViews)this.container.appendChild(c.dom);b=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);b&&this.maybeMeasure()}createTooltip(a){let b=a.create(this.view);b.dom.classList.add("cm-tooltip");
a.arrow&&!b.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")&&(a=document.createElement("div"),a.className="cm-tooltip-arrow",b.dom.appendChild(a));b.dom.style.position=this.position;b.dom.style.top="-10000px";this.container.appendChild(b.dom);b.mount&&b.mount(this.view);return b}destroy(){var a,b;null===(a=this.view.dom.ownerDocument.defaultView)||void 0===a?void 0:a.removeEventListener("resize",this.measureSoon);for(let {dom:c}of this.manager.tooltipViews)c.remove();null===(b=this.intersectionObserver)||
void 0===b?void 0:b.disconnect();clearTimeout(this.measureTimeout)}readMeasure(){let a=this.view.dom.getBoundingClientRect();return{editor:a,parent:this.parent?this.container.getBoundingClientRect():a,pos:this.manager.tooltips.map((b,c)=>{c=this.manager.tooltipViews[c];return c.getCoords?c.getCoords(b.pos):this.view.coordsAtPos(b.pos)}),size:this.manager.tooltipViews.map(({dom:b})=>b.getBoundingClientRect()),space:this.view.state.facet(hf).tooltipSpace(this.view)}}writeMeasure(a){let {editor:b,space:c}=
a,d=[];for(let k=0;k<this.manager.tooltips.length;k++){var f=this.manager.tooltips[k];let l=this.manager.tooltipViews[k],{dom:m}=l,n=a.pos[k],p=a.size[k];if(!n||n.bottom<=Math.max(b.top,c.top)||n.top>=Math.min(b.bottom,c.bottom)||n.right<Math.max(b.left,c.left)-.1||n.left>Math.min(b.right,c.right)+.1){m.style.top="-10000px";continue}let q=f.arrow?l.dom.querySelector(".cm-tooltip-arrow"):null,r=q?7:0;var g=p.right-p.left;let t=p.bottom-p.top,v=l.offset||rn,C=this.view.textDirection==ca.LTR,F=p.width>
c.right-c.left?C?c.left:c.right-p.width:C?Math.min(n.left-(q?14:0)+v.x,c.right-g):Math.max(c.left,n.left-g+(q?14:0)-v.x),B=!!f.above;!f.strictSide&&(B?n.top-(p.bottom-p.top)-v.y<c.top:n.bottom+(p.bottom-p.top)+v.y>c.bottom)&&B==c.bottom-n.bottom>n.top-c.top&&(B=!B);f=B?n.top-t-r-v.y:n.bottom+r+v.y;g=F+g;if(!0!==l.overlap)for(let z of d)z.left<g&&z.right>F&&z.top<f+t&&z.bottom>f&&(f=B?z.top-t-2-r:z.bottom+r+2);"absolute"==this.position?(m.style.top=f-a.parent.top+"px",m.style.left=F-a.parent.left+
"px"):(m.style.top=f+"px",m.style.left=F+"px");q&&(q.style.left=`${n.left+(C?v.x:-v.x)-(F+14-7)}px`);!0!==l.overlap&&d.push({left:F,top:f,right:g,bottom:f+t});m.classList.toggle("cm-tooltip-above",B);m.classList.toggle("cm-tooltip-below",!B);l.positioned&&l.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let a of this.manager.tooltipViews)a.dom.style.top=
"-10000px"}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),sn=I.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",
borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),rn={x:0,y:0},jf=
E.define({enables:[gi,sn]}),Nc=E.define(),pj=class{constructor(a){this.view=a;this.mounted=!1;this.dom=document.createElement("div");this.dom.classList.add("cm-tooltip-hover");this.manager=new oj(a,Nc,b=>this.createHostedView(b))}static create(a){return new pj(a)}createHostedView(a){a=a.create(this.view);a.dom.classList.add("cm-tooltip-section");this.dom.appendChild(a.dom);this.mounted&&a.mount&&a.mount(this.view);return a}mount(a){for(let b of this.manager.tooltipViews)b.mount&&b.mount(a);this.mounted=
!0}positioned(){for(let a of this.manager.tooltipViews)a.positioned&&a.positioned()}update(a){this.manager.update(a)}},yl=jf.compute([Nc],a=>{a=a.facet(Nc).filter(b=>b);return 0===a.length?null:{pos:Math.min(...a.map(b=>b.pos)),end:Math.max(...a.filter(b=>null!=b.end).map(b=>b.end)),create:pj.create,above:a[0].above,arrow:a.some(b=>b.arrow)}}),xl=class{constructor(a,b,c,d,f){this.view=a;this.source=b;this.field=c;this.setHover=d;this.hoverTime=f;this.restartTimeout=this.hoverTimeout=-1;this.pending=
null;this.lastMove={x:0,y:0,target:a.dom,time:0};this.checkHover=this.checkHover.bind(this);a.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this));a.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){this.hoverTimeout=-1;if(!this.active){var a=Date.now()-
this.lastMove.time;a<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-a):this.startHover()}}startHover(){clearTimeout(this.restartTimeout);var {lastMove:a}=this;let b=this.view.contentDOM.contains(a.target)?this.view.posAtCoords(a):null;if(null!=b){var c=this.view.coordsAtPos(b);if(!(null==c||a.y<c.top||a.y>c.bottom||a.x<c.left-this.view.defaultCharacterWidth||a.x>c.right+this.view.defaultCharacterWidth)){var d=this.view.bidiSpans(this.view.state.doc.lineAt(b)).find(f=>f.from<=
b&&f.to>=b);d=d&&d.dir==ca.RTL?-1:1;a=this.source(this.view,b,a.x<c.left?-d:d);if(null===a||void 0===a?0:a.then){let f=this.pending={pos:b};a.then(g=>{this.pending==f&&(this.pending=null,g&&this.view.dispatch({effects:this.setHover.of(g)}))},g=>za(this.view.state,g,"hover tooltip"))}else a&&this.view.dispatch({effects:this.setHover.of(a)})}}}mousemove(a){var b;this.lastMove={x:a.clientX,y:a.clientY,target:a.target,time:Date.now()};0>this.hoverTimeout&&(this.hoverTimeout=setTimeout(this.checkHover,
this.hoverTime));var c=this.active,d;if(d=c){a:{for(d=this.lastMove.target;d;d=d.parentNode)if(1==d.nodeType&&d.classList.contains("cm-tooltip")){d=!0;break a}d=!1}d=!d}if(d||this.pending){({pos:d}=c||this.pending);var f=null!==(b=null===c||void 0===c?void 0:c.end)&&void 0!==b?b:d;if(d==f)a=this.view.posAtCoords(this.lastMove)!=d;else{a:{c=this.view;var g=d;b=a.clientX;a=a.clientY;d=document.createRange();g=c.domAtPos(g);c=c.domAtPos(f);d.setEnd(c.node,c.offset);d.setStart(g.node,g.offset);c=d.getClientRects();
d.detach();for(d=0;d<c.length;d++)if(g=c[d],6>=Math.max(g.top-a,a-g.bottom,g.left-b,b-g.right)){a=!0;break a}a=!1}a=!a}a&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout);this.hoverTimeout=-1;this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout);this.view.dom.removeEventListener("mouseleave",this.mouseleave);this.view.dom.removeEventListener("mousemove",this.mousemove)}},wl=
K.define(),qj=E.define({combine(a){let b,c;for(let d of a)b=b||d.topContainer,c=c||d.bottomContainer;return{topContainer:b,bottomContainer:c}}}),dh=fa.fromClass(class{constructor(a){this.input=a.state.facet(tc);this.specs=this.input.filter(c=>c);this.panels=this.specs.map(c=>c(a));let b=a.state.facet(qj);this.top=new vd(a,!0,b.topContainer);this.bottom=new vd(a,!1,b.bottomContainer);this.top.sync(this.panels.filter(c=>c.top));this.bottom.sync(this.panels.filter(c=>!c.top));for(let c of this.panels)c.dom.classList.add("cm-panel"),
c.mount&&c.mount()}update(a){var b=a.state.facet(qj);this.top.container!=b.topContainer&&(this.top.sync([]),this.top=new vd(a.view,!0,b.topContainer));this.bottom.container!=b.bottomContainer&&(this.bottom.sync([]),this.bottom=new vd(a.view,!1,b.bottomContainer));this.top.syncClasses();this.bottom.syncClasses();b=a.state.facet(tc);if(b!=this.input){var c=b.filter(l=>l);b=[];let f=[],g=[],k=[];for(let l of c){var d=this.specs.indexOf(l);0>d?(d=l(a.view),k.push(d)):(d=this.panels[d],d.update&&d.update(a));
b.push(d);(d.top?f:g).push(d)}this.specs=c;this.panels=b;this.top.sync(f);this.bottom.sync(g);for(let l of k)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(c of this.panels)c.update&&c.update(a)}destroy(){this.top.sync([]);this.bottom.sync([])}},{provide:a=>I.scrollMargins.of(b=>(b=b.plugin(a))&&{top:b.top.scrollMargin(),bottom:b.bottom.scrollMargin()})}),vd=class{constructor(a,b,c){this.view=a;this.top=b;this.container=c;this.dom=void 0;this.classes="";this.panels=[];this.syncClasses()}sync(a){for(let b of this.panels)b.destroy&&
0>a.indexOf(b)&&b.destroy();this.panels=a;this.syncDOM()}syncDOM(){if(0==this.panels.length)this.dom&&(this.dom.remove(),this.dom=void 0);else{if(!this.dom){this.dom=document.createElement("div");this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom";this.dom.style[this.top?"top":"bottom"]="0";var a=this.container||this.view.dom;a.insertBefore(this.dom,this.top?a.firstChild:null)}a=this.dom.firstChild;for(let b of this.panels)if(b.dom.parentNode==this.dom){for(;a!=b.dom;)a=
eh(a);a=a.nextSibling}else this.dom.insertBefore(b.dom,a);for(;a;)a=eh(a)}}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let a of this.classes.split(" "))a&&this.container.classList.remove(a);
for(let a of(this.classes=this.view.themeClasses).split(" "))a&&this.container.classList.add(a)}}},tc=E.define({enables:dh}),$a=class extends xb{compare(a){return this==a||this.constructor==a.constructor&&this.eq(a)}eq(a){return!1}destroy(a){}};$a.prototype.elementClass="";$a.prototype.toDOM=void 0;$a.prototype.mapMode=xa.TrackBefore;$a.prototype.startSide=$a.prototype.endSide=-1;$a.prototype.point=!0;var wd=E.define(),Al={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>W.empty,lineMarker:()=>
null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},fc=E.define(),ke=E.define({combine:a=>a.some(b=>b)}),Bl=fa.fromClass(class{constructor(a){this.view=a;this.prevViewport=a.viewport;this.dom=document.createElement("div");this.dom.className="cm-gutters";this.dom.setAttribute("aria-hidden","true");this.dom.style.minHeight=this.view.contentHeight+"px";this.gutters=a.state.facet(fc).map(b=>new rj(a,b));for(let b of this.gutters)this.dom.appendChild(b.dom);if(this.fixed=
!a.state.facet(ke))this.dom.style.position="sticky";this.syncGutters(!1);a.scrollDOM.insertBefore(this.dom,a.contentDOM)}update(a){if(this.updateGutters(a)){let b=this.prevViewport,c=a.view.viewport;this.syncGutters(Math.min(b.to,c.to)-Math.max(b.from,c.from)<.8*(c.to-c.from))}a.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px");this.view.state.facet(ke)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"");this.prevViewport=a.view.viewport}syncGutters(a){let b=
this.dom.nextSibling;a&&this.dom.remove();let c=W.iter(this.view.state.facet(wd),this.view.viewport.from),d=[],f=this.gutters.map(g=>new tn(g,this.view.viewport,-this.view.documentPadding.top));for(let g of this.view.viewportLineBlocks){let k;if(Array.isArray(g.type))for(let l of g.type){if(l.type==X.Text){k=l;break}}else k=g.type==X.Text?g:void 0;if(k){d.length&&(d=[]);hh(c,d,g.from);for(let l of f)l.line(this.view,k,d)}}for(let g of f)g.finish();a&&this.view.scrollDOM.insertBefore(this.dom,b)}updateGutters(a){let b=
a.startState.facet(fc);var c=a.state.facet(fc);let d=a.docChanged||a.heightChanged||a.viewportChanged||!W.eq(a.startState.facet(wd),a.state.facet(wd),a.view.viewport.from,a.view.viewport.to);if(b==c)for(var f of this.gutters)f.update(a)&&(d=!0);else{d=!0;f=[];for(let g of c)c=b.indexOf(g),0>c?f.push(new rj(this.view,g)):(this.gutters[c].update(a),f.push(this.gutters[c]));for(let g of this.gutters)g.dom.remove(),0>f.indexOf(g)&&g.destroy();for(let g of f)this.dom.appendChild(g.dom);this.gutters=f}return d}destroy(){for(let a of this.gutters)a.destroy();
this.dom.remove()}},{provide:a=>I.scrollMargins.of(b=>{let c=b.plugin(a);return c&&0!=c.gutters.length&&c.fixed?b.textDirection==ca.LTR?{left:c.dom.offsetWidth}:{right:c.dom.offsetWidth}:null})}),tn=class{constructor(a,b,c){this.gutter=a;this.height=c;this.localMarkers=[];this.i=0;this.cursor=W.iter(a.markers,b.from)}line(a,b,c){this.localMarkers.length&&(this.localMarkers=[]);hh(this.cursor,this.localMarkers,b.from);c=c.length?this.localMarkers.concat(c):this.localMarkers;var d=this.gutter.config.lineMarker(a,
b,c);d&&c.unshift(d);d=this.gutter;if(0!=c.length||d.config.renderEmptyElements){var f=b.top-this.height;this.i==d.elements.length?(a=new sj(a,b.height,f,c),d.elements.push(a),d.dom.appendChild(a.dom)):d.elements[this.i].update(a,b.height,f,c);this.height=b.bottom;this.i++}}finish(){let a=this.gutter;for(;a.elements.length>this.i;){let b=a.elements.pop();a.dom.removeChild(b.dom);b.destroy()}}},rj=class{constructor(a,b){this.view=a;this.config=b;this.elements=[];this.spacer=null;this.dom=document.createElement("div");
this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let c in b.domEventHandlers)this.dom.addEventListener(c,d=>{let f=a.lineBlockAtHeight(d.clientY-a.documentTop);b.domEventHandlers[c](a,f,d)&&d.preventDefault()});this.markers=gh(b.markers(a));b.initialSpacer&&(this.spacer=new sj(a,0,0,[b.initialSpacer(a)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(a){let b=this.markers;this.markers=gh(this.config.markers(a.view));
if(this.spacer&&this.config.updateSpacer){var c=this.config.updateSpacer(this.spacer.markers[0],a);c!=this.spacer.markers[0]&&this.spacer.update(a.view,0,0,[c])}c=a.view.viewport;return!W.eq(this.markers,b,c.from,c.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(a):!1)}destroy(){for(let a of this.elements)a.destroy()}},sj=class{constructor(a,b,c,d){this.height=-1;this.above=0;this.markers=[];this.dom=document.createElement("div");this.dom.className="cm-gutterElement";this.update(a,
b,c,d)}update(a,b,c,d){this.height!=b&&(this.dom.style.height=(this.height=b)+"px");this.above!=c&&(this.dom.style.marginTop=(this.above=c)?c+"px":"");a:if(b=this.markers,b.length!=d.length)b=!1;else{for(c=0;c<b.length;c++)if(!b[c].compare(d[c])){b=!1;break a}b=!0}b||this.setMarkers(a,d)}setMarkers(a,b){let c="cm-gutterElement",d=this.dom.firstChild;for(let g=0,k=0;;){let l=k,m=g<b.length?b[g++]:null,n=!1;if(m){var f=m.elementClass;f&&(c+=" "+f);for(f=k;f<this.markers.length;f++)if(this.markers[f].compare(m)){l=
f;n=!0;break}}else l=this.markers.length;for(;k<l;)f=this.markers[k++],f.toDOM&&(f.destroy(d),f=d.nextSibling,d.remove(),d=f);if(!m)break;m.toDOM&&(n?d=d.nextSibling:this.dom.insertBefore(m.toDOM(a),d));n&&k++}this.dom.className=c;this.markers=b}destroy(){this.setMarkers(null,[])}},un=E.define(),Hb=E.define({combine(a){return Wa(a,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(b,c){b=Object.assign({},b);for(let d in c){let f=b[d],g=c[d];b[d]=f?(k,l,m)=>f(k,l,m)||g(k,l,m):g}return b}})}}),
kf=class extends $a{constructor(a){super();this.number=a}eq(a){return this.number==a.number}toDOM(){return document.createTextNode(this.number)}},vn=fc.compute([Hb],a=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(b){return b.state.facet(un)},lineMarker(b,c,d){return d.some(f=>f.toDOM)?null:new kf(le(b,b.state.doc.lineAt(c.from).number))},lineMarkerChange:b=>b.startState.facet(Hb)!=b.state.facet(Hb),initialSpacer(b){return new kf(le(b,ih(b.state.doc.lines)))},updateSpacer(b,c){c=le(c.view,
ih(c.view.state.doc.lines));return c==b.number?b:new kf(c)},domEventHandlers:a.facet(Hb).domEventHandlers})),wn=new class extends $a{constructor(){super(...arguments);this.elementClass="cm-activeLineGutter"}},xn=wd.compute(["selection"],a=>{let b=[],c=-1;for(let d of a.selection.ranges)if(d.empty){let f=a.doc.lineAt(d.head).from;f>c&&(c=f,b.push(wn.range(f)))}return W.of(b)}),yn=0,lf=class{constructor(a,b){this.from=a;this.to=b}},P=class{constructor(a={}){this.id=yn++;this.perNode=!!a.perNode;this.deserialize=
a.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function");})}add(a){if(this.perNode)throw new RangeError("Can't add per-node props to node types");"function"!=typeof a&&(a=Ma.match(a));return b=>{b=a(b);return void 0===b?null:[this,b]}}};P.closedBy=new P({deserialize:a=>a.split(" ")});P.openedBy=new P({deserialize:a=>a.split(" ")});P.group=new P({deserialize:a=>a.split(" ")});P.contextHash=new P({perNode:!0});P.lookAhead=new P({perNode:!0});P.mounted=new P({perNode:!0});
var zn=Object.create(null),Ma=class{constructor(a,b,c,d=0){this.name=a;this.props=b;this.id=c;this.flags=d}static define(a){let b=a.props&&a.props.length?Object.create(null):zn,c=new Ma(a.name||"",b,a.id,(a.top?1:0)|(a.skipped?2:0)|(a.error?4:0)|(null==a.name?8:0));if(a.props)for(let d of a.props)if(Array.isArray(d)||(d=d(c)),d){if(d[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");b[d[0].id]=d[1]}return c}prop(a){return this.props[a.id]}get isTop(){return 0<(this.flags&
1)}get isSkipped(){return 0<(this.flags&2)}get isError(){return 0<(this.flags&4)}get isAnonymous(){return 0<(this.flags&8)}is(a){if("string"==typeof a){if(this.name==a)return!0;let b=this.prop(P.group);return b?-1<b.indexOf(a):!1}return this.id==a}static match(a){let b=Object.create(null);for(let c in a)for(let d of c.split(" "))b[d]=a[c];return c=>{for(let d=c.prop(P.group),f=-1;f<(d?d.length:0);f++){let g=b[0>f?c.name:d[f]];if(g)return g}}}};Ma.none=new Ma("",Object.create(null),0,8);var xd=new WeakMap,
tj=new WeakMap,ta;(function(a){a[a.ExcludeBuffers=1]="ExcludeBuffers";a[a.IncludeAnonymous=2]="IncludeAnonymous";a[a.IgnoreMounts=4]="IgnoreMounts";a[a.IgnoreOverlays=8]="IgnoreOverlays"})(ta||={});var ua=class{constructor(a,b,c,d,f){this.type=a;this.children=b;this.positions=c;this.length=d;this.props=null;if(f&&f.length){this.props=Object.create(null);for(let [g,k]of f)this.props["number"==typeof g?g:g.id]=k}}toString(){var a=this.prop(P.mounted);if(a&&!a.overlay)return a.tree.toString();a="";for(let b of this.children){let c=
b.toString();c&&(a&&(a+=","),a+=c)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(a.length?"("+a+")":""):a}cursor(a=0){return new yd(this.topNode,a)}cursorAt(a,b=0,c){c=xd.get(this)||this.topNode;c=new yd(c);c.moveTo(a,b);xd.set(this,c._tree);return c}get topNode(){return new gb(this,0,0,null)}resolve(a,b=0){a=Ib(xd.get(this)||this.topNode,a,b,!1);xd.set(this,a);return a}resolveInner(a,b=0){a=Ib(tj.get(this)||this.topNode,a,b,!0);
tj.set(this,a);return a}iterate(a){let {enter:b,leave:c,from:d=0,to:f=this.length}=a;for(a=this.cursor((a.mode||0)|ta.IncludeAnonymous);;){let g=!1;if(a.from<=f&&a.to>=d&&(a.type.isAnonymous||!1!==b(a))){if(a.firstChild())continue;g=!0}for(;;){g&&c&&!a.type.isAnonymous&&c(a);if(a.nextSibling())break;if(!a.parent())return;g=!0}}}prop(a){return a.perNode?this.props?this.props[a.id]:void 0:this.type.prop(a)}get propValues(){let a=[];if(this.props)for(let b in this.props)a.push([+b,this.props[b]]);return a}balance(a=
{}){return 8>=this.children.length?this:oe(Ma.none,this.children,this.positions,0,this.children.length,0,this.length,(b,c,d)=>new ua(this.type,b,c,d,this.propValues),a.makeTree||((b,c,d)=>new ua(Ma.none,b,c,d)))}static build(a){return Cl(a)}};ua.empty=new ua(Ma.none,[],[],0);var nh=class{constructor(a,b){this.buffer=a;this.index=b}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-
1]}get pos(){return this.index}next(){this.index-=4}fork(){return new nh(this.buffer,this.index)}},Jb=class{constructor(a,b,c){this.buffer=a;this.length=b;this.set=c}get type(){return Ma.none}toString(){let a=[];for(let b=0;b<this.buffer.length;)a.push(this.childString(b)),b=this.buffer[b+3];return a.join(",")}childString(a){let b=this.buffer[a+3];var c=this.set.types[this.buffer[a]];let d=c.name;/\W/.test(d)&&!c.isError&&(d=JSON.stringify(d));a+=4;if(b==a)return d;for(c=[];a<b;)c.push(this.childString(a)),
a=this.buffer[a+3];return d+"("+c.join(",")+")"}findChild(a,b,c,d,f){let {buffer:g}=this,k=-1;for(;a!=b&&!(jh(f,d,g[a+1],g[a+2])&&(k=a,0<c));a=g[a+3]);return k}slice(a,b,c,d){let f=this.buffer,g=new Uint16Array(b-a);for(let k=a,l=0;k<b;)g[l++]=f[k++],g[l++]=f[k++]-c,g[l++]=f[k++]-c,g[l++]=f[k++]-a;return new Jb(g,d-c,this.set)}},gb=class{constructor(a,b,c,d){this._tree=a;this.from=b;this.index=c;this._parent=d}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+
this._tree.length}nextChild(a,b,c,d,f=0){for(let g=this;;){for(let {children:k,positions:l}=g._tree,m=0<b?k.length:-1;a!=m;a+=b){let n=k[a],p=l[a]+g.from;if(jh(d,c,p,p+n.length))if(n instanceof Jb){if(f&ta.ExcludeBuffers)continue;let q=n.findChild(0,n.buffer.length,b,c-p,d);if(-1<q)return new Bb(new An(g,n,a,p),null,q)}else if(f&ta.IncludeAnonymous||!n.type.isAnonymous||me(n)){let q;if(!(f&ta.IgnoreMounts)&&n.props&&(q=n.prop(P.mounted))&&!q.overlay)return new gb(q.tree,p,a,g);a=new gb(n,p,a,g);return f&
ta.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(0>b?n.children.length-1:0,b,c,d)}}if(f&ta.IncludeAnonymous||!g.type.isAnonymous)return null;a=0<=g.index?g.index+b:0>b?-1:g._parent._tree.children.length;g=g._parent;if(!g)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(a){return this.nextChild(0,1,a,2)}childBefore(a){return this.nextChild(this._tree.children.length-1,-1,a,-2)}enter(a,b,c=0){let d;
if(!(c&ta.IgnoreOverlays)&&(d=this._tree.prop(P.mounted))&&d.overlay){let f=a-this.from;for(let {from:g,to:k}of d.overlay)if((0<b?g<=f:g<f)&&(0>b?k>=f:k>f))return new gb(d.tree,d.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,a,b,c)}nextSignificantParent(){let a=this;for(;a.type.isAnonymous&&a._parent;)a=a._parent;return a}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&0<=this.index?this._parent.nextChild(this.index+
1,1,0,4):null}get prevSibling(){return this._parent&&0<=this.index?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(a=0){return new yd(this,a)}get tree(){return this._tree}toTree(){return this._tree}resolve(a,b=0){return Ib(this,a,b,!1)}resolveInner(a,b=0){return Ib(this,a,b,!0)}enterUnfinishedNodesBefore(a){return kh(this,a)}getChild(a,b=null,c=null){a=Oc(this,a,b,c);return a.length?a[0]:null}getChildren(a,b=null,c=null){return Oc(this,a,b,c)}toString(){return this._tree.toString()}get node(){return this}matchContext(a){return Pc(this,
a)}},An=class{constructor(a,b,c,d){this.parent=a;this.buffer=b;this.index=c;this.start=d}},Bb=class{constructor(a,b,c){this.context=a;this._parent=b;this.index=c;this.type=a.buffer.set.types[a.buffer.buffer[c]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(a,b,c){let {buffer:d}=this.context;a=d.findChild(this.index+4,d.buffer[this.index+3],a,b-this.context.start,
c);return 0>a?null:new Bb(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(a){return this.child(1,a,2)}childBefore(a){return this.child(-1,a,-2)}enter(a,b,c=0){if(c&ta.ExcludeBuffers)return null;({buffer:c}=this.context);a=c.findChild(this.index+4,c.buffer[this.index+3],0<b?1:-1,a-this.context.start,b);return 0>a?null:new Bb(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(a){return this._parent?
null:this.context.parent.nextChild(this.context.index+a,a,0,4)}get nextSibling(){let {buffer:a}=this.context,b=a.buffer[this.index+3];return b<(this._parent?a.buffer[this._parent.index+3]:a.buffer.length)?new Bb(this.context,this._parent,b):this.externalSibling(1)}get prevSibling(){let {buffer:a}=this.context,b=this._parent?this._parent.index+4:0;return this.index==b?this.externalSibling(-1):new Bb(this.context,this._parent,a.findChild(b,this.index,-1,0,4))}cursor(a=0){return new yd(this,a)}get tree(){return null}toTree(){let a=
[],b=[],{buffer:c}=this.context,d=this.index+4,f=c.buffer[this.index+3];f>d&&(a.push(c.slice(d,f,c.buffer[this.index+1],c.buffer[this.index+2])),b.push(0));return new ua(this.type,a,b,this.to-this.from)}resolve(a,b=0){return Ib(this,a,b,!1)}resolveInner(a,b=0){return Ib(this,a,b,!0)}enterUnfinishedNodesBefore(a){return kh(this,a)}toString(){return this.context.buffer.childString(this.index)}getChild(a,b=null,c=null){a=Oc(this,a,b,c);return a.length?a[0]:null}getChildren(a,b=null,c=null){return Oc(this,
a,b,c)}get node(){return this}matchContext(a){return Pc(this,a)}},yd=class{constructor(a,b=0){this.mode=b;this.buffer=null;this.stack=[];this.index=0;this.bufferNode=null;if(a instanceof gb)this.yieldNode(a);else{this._tree=a.context.parent;this.buffer=a.context;for(b=a._parent;b;b=b._parent)this.stack.unshift(b.index);this.bufferNode=a;this.yieldBuf(a.index)}}get name(){return this.type.name}yieldNode(a){if(!a)return!1;this._tree=a;this.type=a.type;this.from=a.from;this.to=a.to;return!0}yieldBuf(a,
b){this.index=a;let {start:c,buffer:d}=this.buffer;this.type=b||d.set.types[d.buffer[a]];this.from=c+d.buffer[a+1];this.to=c+d.buffer[a+2];return!0}yield(a){if(!a)return!1;if(a instanceof gb)return this.buffer=null,this.yieldNode(a);this.buffer=a.context;return this.yieldBuf(a.index,a.type)}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(a,b,c){if(!this.buffer)return this.yield(this._tree.nextChild(0>a?this._tree._tree.children.length-1:0,
a,b,c,this.mode));let {buffer:d}=this.buffer;a=d.findChild(this.index+4,d.buffer[this.index+3],a,b-this.buffer.start,c);if(0>a)return!1;this.stack.push(this.index);return this.yieldBuf(a)}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(a){return this.enterChild(1,a,2)}childBefore(a){return this.enterChild(-1,a,-2)}enter(a,b,c=this.mode){return this.buffer?c&ta.ExcludeBuffers?!1:this.enterChild(1,a,b):this.yield(this._tree.enter(a,b,c))}parent(){if(!this.buffer)return this.yieldNode(this.mode&
ta.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let a=this.mode&ta.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();this.buffer=null;return this.yieldNode(a)}sibling(a){if(!this.buffer)return this._tree._parent?this.yield(0>this._tree.index?null:this._tree._parent.nextChild(this._tree.index+a,a,0,4,this.mode)):!1;let {buffer:b}=this.buffer,c=this.stack.length-1;if(0>a){var d=0>c?0:this.stack[c]+4;if(this.index!=
d)return this.yieldBuf(b.findChild(d,this.index,-1,0,4))}else if(d=b.buffer[this.index+3],d<(0>c?b.buffer.length:b.buffer[this.stack[c]+3]))return this.yieldBuf(d);return 0>c?this.yield(this.buffer.parent.nextChild(this.buffer.index+a,a,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(a){var b,c;({buffer:c}=this);if(c){if(0<a){if(this.index<c.buffer.buffer.length)return!1}else for(b=0;b<this.index;b++)if(c.buffer.buffer[b+3]<this.index)return!1;
({index:b,parent:c}=c)}else({index:b,_parent:c}=this._tree);for(;c;{index:b,_parent:c}=c)if(-1<b)for(let d=b+a,f=0>a?-1:c._tree.children.length;d!=f;d+=a)if(b=c._tree.children[d],this.mode&ta.IncludeAnonymous||b instanceof Jb||!b.type.isAnonymous||me(b))return!1;return!0}move(a,b){if(b&&this.enterChild(a,0,4))return!0;for(;;){if(this.sibling(a))return!0;if(this.atLastNode(a)||!this.parent())return!1}}next(a=!0){return this.move(1,a)}prev(a=!0){return this.move(-1,a)}moveTo(a,b=0){for(;(this.from==
this.to||(1>b?this.from>=a:this.from>a)||(-1<b?this.to<=a:this.to<a))&&this.parent(););for(;this.enterChild(1,a,b););return this}get node(){if(!this.buffer)return this._tree;var a=this.bufferNode;let b=null,c=0;if(a&&a.context==this.buffer)a:for(let d=this.index,f=this.stack.length;0<=f;){for(let g=a;g;g=g._parent)if(g.index==d){if(d==this.index)return g;b=g;c=f+1;break a}d=this.stack[--f]}for(a=c;a<this.stack.length;a++)b=new Bb(this.buffer,b,this.stack[a]);return this.bufferNode=new Bb(this.buffer,
b,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(a,b){for(let c=0;;){let d=!1;if(this.type.isAnonymous||!1!==a(this)){if(this.firstChild()){c++;continue}this.type.isAnonymous||(d=!0)}for(;;){d&&b&&b(this);if(this.nextSibling())break;if(!c)return;this.parent();c--;d=!0}}}matchContext(a){if(!this.buffer)return Pc(this.node,a);let {buffer:b}=this.buffer,{types:c}=b.set;for(let d=a.length-1,f=this.stack.length-1;0<=d;f--){if(0>f)return Pc(this.node,a,d);let g=c[b.buffer[this.stack[f]]];
if(!g.isAnonymous){if(a[d]&&a[d]!=g.name)return!1;d--}}return!0}},oh=new WeakMap,Kb=class{constructor(a,b,c,d,f=!1,g=!1){this.from=a;this.to=b;this.tree=c;this.offset=d;this.open=(f?1:0)|(g?2:0)}get openStart(){return 0<(this.open&1)}get openEnd(){return 0<(this.open&2)}static addTree(a,b=[],c=!1){c=[new Kb(0,a.length,a,0,!1,c)];for(let d of b)d.to>a.length&&c.push(d);return c}static applyChanges(a,b,c=128){if(!b.length)return a;let d=[],f=1,g=a.length?a[0]:null;for(let k=0,l=0,m=0;;k++){let n=k<
b.length?b[k]:null,p=n?n.fromA:1E9;if(p-l>=c)for(;g&&g.from<p;){let q=g;if(l>=q.from||p<=q.to||m){let r=Math.max(q.from,l)-m,t=Math.min(q.to,p)-m;q=r>=t?null:new Kb(r,t,q.tree,q.offset+m,0<k,!!n)}q&&d.push(q);if(g.to>p)break;g=f<a.length?a[f++]:null}if(!n)break;l=n.toA;m=n.toA-n.toB}return d}},Cn=class{startParse(a,b,c){"string"==typeof a&&(a=new Bn(a));c=c?c.length?c.map(d=>new lf(d.from,d.to)):[new lf(0,0)]:[new lf(0,a.length)];return this.createParse(a,b||[],c)}parse(a,b,c){for(a=this.startParse(a,
b,c);;)if(b=a.advance())return b}},Bn=class{constructor(a){this.string=a}get length(){return this.string.length}chunk(a){return this.string.slice(a)}get lineChunks(){return!1}read(a,b){return this.string.slice(a,b)}};new P({perNode:!0});var Dn=0,ab=class{constructor(a,b,c){this.set=a;this.base=b;this.modified=c;this.id=Dn++}static define(a){if(null===a||void 0===a?0:a.base)throw Error("Can not derive from a modified tag");let b=new ab([],null,[]);b.set.push(b);if(a)for(let c of a.set)b.set.push(c);
return b}static defineModifier(){let a=new mf;return b=>-1<b.modified.indexOf(a)?b:mf.get(b.base||b,b.modified.concat(a).sort((c,d)=>c.id-d.id))}},En=0,mf=class{constructor(){this.instances=[];this.id=En++}static get(a,b){if(!b.length)return a;var c=b[0].instances.find(g=>g.base==a&&El(b,g.modified));if(c)return c;c=[];let d=new ab(c,a,b);for(var f of b)f.instances.push(d);f=ph(b);for(let g of a.set)for(let k of f)c.push(mf.get(g,k));return d}},Eh=new P,Ul=class{constructor(a,b,c,d){this.tags=a;this.mode=
b;this.context=c;this.next=d}sort(a){if(!a||a.depth<this.depth)return this.next=a,this;a.next=this.sort(a.next);return a}get depth(){return this.context?this.context.length:0}},Hl=class{constructor(a,b,c){this.at=a;this.highlighters=b;this.span=c;this.class=""}startSpan(a,b){b!=this.class&&(this.flush(a),a>this.at&&(this.at=a),this.class=b)}flush(a){a>this.at&&this.class&&this.span(this.at,a,this.class)}highlightRange(a,b,c,d,f){let {type:g,from:k,to:l}=a;if(!(k>=c||l<=b)){g.isTop&&(f=this.highlighters.filter(t=>
!t.scope||t.scope(g)));for(var m=d,n=g.prop(Eh),p=!1;n;){if(!n.context||a.matchContext(n.context)){var q=Fl(f,n.tags);q&&(m&&(m+=" "),m+=q,1==n.mode?d+=(d?" ":"")+q:0==n.mode&&(p=!0));break}n=n.next}this.startSpan(a.from,m);if(!p){var r=a.tree&&a.tree.prop(P.mounted);if(r&&r.overlay){n=a.node.enter(r.overlay[0].from+k,1);p=this.highlighters.filter(t=>!t.scope||t.scope(r.tree.type));q=a.firstChild();for(let t=0,v=k;;t++){let C=t<r.overlay.length?r.overlay[t]:null,F=C?C.from+k:l,B=Math.max(b,v),z=Math.min(c,
F);if(B<z&&q)for(;a.from<z&&(this.highlightRange(a,B,z,d,f),this.startSpan(Math.min(c,a.to),m),!(a.to>=F)&&a.nextSibling()););if(!C||F>c)break;v=C.to+k;v>b&&(this.highlightRange(n.cursor(),Math.max(b,C.from+k),Math.min(c,v),d,p),this.startSpan(v,m))}q&&a.parent()}else if(a.firstChild()){do if(!(a.to<=b)){if(a.from>=c)break;this.highlightRange(a,b,c,d,f);this.startSpan(Math.min(c,a.to),m)}while(a.nextSibling());a.parent()}}}}},y=ab.define,zd=y(),mb=y(),uj=y(mb),vj=y(mb),nb=y(),Ad=y(nb),nf=y(nb),Sa=
y(),Cb=y(Sa),Ta=y(),Ua=y(),of=y(),uc=y(of),Bd=y(),A={comment:zd,lineComment:y(zd),blockComment:y(zd),docComment:y(zd),name:mb,variableName:y(mb),typeName:uj,tagName:y(uj),propertyName:vj,attributeName:y(vj),className:y(mb),labelName:y(mb),namespace:y(mb),macroName:y(mb),literal:nb,string:Ad,docString:y(Ad),character:y(Ad),attributeValue:y(Ad),number:nf,integer:y(nf),float:y(nf),bool:y(nb),regexp:y(nb),escape:y(nb),color:y(nb),url:y(nb),keyword:Ta,self:y(Ta),null:y(Ta),atom:y(Ta),unit:y(Ta),modifier:y(Ta),
operatorKeyword:y(Ta),controlKeyword:y(Ta),definitionKeyword:y(Ta),moduleKeyword:y(Ta),operator:Ua,derefOperator:y(Ua),arithmeticOperator:y(Ua),logicOperator:y(Ua),bitwiseOperator:y(Ua),compareOperator:y(Ua),updateOperator:y(Ua),definitionOperator:y(Ua),typeOperator:y(Ua),controlOperator:y(Ua),punctuation:of,separator:y(of),bracket:uc,angleBracket:y(uc),squareBracket:y(uc),paren:y(uc),brace:y(uc),content:Sa,heading:Cb,heading1:y(Cb),heading2:y(Cb),heading3:y(Cb),heading4:y(Cb),heading5:y(Cb),heading6:y(Cb),
contentSeparator:y(Sa),list:y(Sa),quote:y(Sa),emphasis:y(Sa),strong:y(Sa),link:y(Sa),monospace:y(Sa),strikethrough:y(Sa),inserted:y(),deleted:y(),changed:y(),invalid:y(),meta:Bd,documentMeta:y(Bd),annotation:y(Bd),processingInstruction:y(Bd),definition:ab.defineModifier(),constant:ab.defineModifier(),function:ab.defineModifier(),standard:ab.defineModifier(),local:ab.defineModifier(),special:ab.defineModifier()};qh([{tag:A.link,class:"tok-link"},{tag:A.heading,class:"tok-heading"},{tag:A.emphasis,
class:"tok-emphasis"},{tag:A.strong,class:"tok-strong"},{tag:A.keyword,class:"tok-keyword"},{tag:A.atom,class:"tok-atom"},{tag:A.bool,class:"tok-bool"},{tag:A.url,class:"tok-url"},{tag:A.labelName,class:"tok-labelName"},{tag:A.inserted,class:"tok-inserted"},{tag:A.deleted,class:"tok-deleted"},{tag:A.literal,class:"tok-literal"},{tag:A.string,class:"tok-string"},{tag:A.number,class:"tok-number"},{tag:[A.regexp,A.escape,A.special(A.string)],class:"tok-string2"},{tag:A.variableName,class:"tok-variableName"},
{tag:A.local(A.variableName),class:"tok-variableName tok-local"},{tag:A.definition(A.variableName),class:"tok-variableName tok-definition"},{tag:A.special(A.variableName),class:"tok-variableName2"},{tag:A.definition(A.propertyName),class:"tok-propertyName tok-definition"},{tag:A.typeName,class:"tok-typeName"},{tag:A.namespace,class:"tok-namespace"},{tag:A.className,class:"tok-className"},{tag:A.macroName,class:"tok-macroName"},{tag:A.propertyName,class:"tok-propertyName"},{tag:A.operator,class:"tok-operator"},
{tag:A.comment,class:"tok-comment"},{tag:A.meta,class:"tok-meta"},{tag:A.invalid,class:"tok-invalid"},{tag:A.punctuation,class:"tok-punctuation"}]);var pf,Sc=new P,Oa=class{constructor(a,b,c=[]){this.data=a;R.prototype.hasOwnProperty("tree")||Object.defineProperty(R.prototype,"tree",{get(){return ra(this)}});this.parser=b;this.extension=[hb.of(this),R.languageData.of((d,f,g)=>d.facet(rh(d,f,g)))].concat(c)}isActiveAt(a,b,c=-1){return rh(a,b,c)==this.data}findRegions(a){let b=a.facet(hb);if((null===
b||void 0===b?void 0:b.data)==this.data)return[{from:0,to:a.doc.length}];if(!b||!b.allowsNesting)return[];let c=[],d=(f,g)=>{if(f.prop(Sc)==this.data)c.push({from:g,to:g+f.length});else{var k=f.prop(P.mounted);if(k){if(k.tree.prop(Sc)==this.data){if(k.overlay)for(var l of k.overlay)c.push({from:l.from+g,to:l.to+g});else c.push({from:g,to:g+f.length});return}if(k.overlay&&(l=c.length,d(k.tree,k.overlay[0].from+g),c.length>l))return}for(k=0;k<f.children.length;k++)l=f.children[k],l instanceof ua&&d(l,
f.positions[k]+g)}};d(ra(a),0);return c}get allowsNesting(){return!0}};Oa.setState=K.define();var Fn=class{constructor(a,b=a.length){this.doc=a;this.length=b;this.cursorPos=0;this.string="";this.cursor=a.iter()}syncTo(a){this.string=this.cursor.next(a-this.cursorPos).value;this.cursorPos=a+this.string.length;return this.cursorPos-this.string.length}chunk(a){this.syncTo(a);return this.string}get lineChunks(){return!0}read(a,b){let c=this.cursorPos-this.string.length;return a<c||b>=this.cursorPos?this.doc.sliceString(a,
b):this.string.slice(a-c,b-c)}},vc=null,qf=class{constructor(a,b,c=[],d,f,g,k,l){this.parser=a;this.state=b;this.fragments=c;this.tree=d;this.treeLen=f;this.viewport=g;this.skipped=k;this.scheduleOn=l;this.parse=null;this.tempSkipped=[]}static create(a,b,c){return new qf(a,b,[],ua.empty,0,c,[],null)}startParse(){return this.parser.startParse(new Fn(this.state.doc),this.fragments)}work(a,b){null!=b&&b>=this.state.doc.length&&(b=void 0);return this.tree!=ua.empty&&this.isDone(null!==b&&void 0!==b?b:
this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var c;if("number"==typeof a){let d=Date.now()+a;a=()=>Date.now()>d}this.parse||(this.parse=this.startParse());for(null!=b&&(null==this.parse.stoppedAt||this.parse.stoppedAt>b)&&b<this.state.doc.length&&this.parse.stopAt(b);;){let d=this.parse.advance();if(d)if(this.fragments=this.withoutTempSkipped(Kb.addTree(d,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(c=this.parse.stoppedAt)&&void 0!==c?c:this.state.doc.length,
this.tree=d,this.parse=null,this.treeLen<(null!==b&&void 0!==b?b:this.state.doc.length))this.parse=this.startParse();else return!0;if(a())return!1}})}takeTree(){let a,b;this.parse&&(a=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>a)&&this.parse.stopAt(a),this.withContext(()=>{for(;!(b=this.parse.advance()););}),this.treeLen=a,this.tree=b,this.fragments=this.withoutTempSkipped(Kb.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(a){let b=vc;
vc=this;try{return a()}finally{vc=b}}withoutTempSkipped(a){for(let b;b=this.tempSkipped.pop();)a=sh(a,b.from,b.to);return a}changes(a,b){let {fragments:c,tree:d,treeLen:f,viewport:g,skipped:k}=this;this.takeTree();if(!a.empty){let l=[];a.iterChangedRanges((m,n,p,q)=>l.push({fromA:m,toA:n,fromB:p,toB:q}));c=Kb.applyChanges(c,l);d=ua.empty;f=0;g={from:a.mapPos(g.from,-1),to:a.mapPos(g.to,1)};if(this.skipped.length){k=[];for(let m of this.skipped){let n=a.mapPos(m.from,1),p=a.mapPos(m.to,-1);n<p&&k.push({from:n,
to:p})}}}return new qf(this.parser,b,c,d,f,g,k,this.scheduleOn)}updateViewport(a){if(this.viewport.from==a.from&&this.viewport.to==a.to)return!1;this.viewport=a;let b=this.skipped.length;for(let c=0;c<this.skipped.length;c++){let {from:d,to:f}=this.skipped[c];d<a.to&&f>a.from&&(this.fragments=sh(this.fragments,d,f),this.skipped.splice(c--,1))}if(this.skipped.length>=b)return!1;this.reset();return!0}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(a,b){this.skipped.push({from:a,
to:b})}static getSkippingParser(a){return new class extends Cn{createParse(b,c,d){let f=d[0].from,g=d[d.length-1].to;return{parsedPos:f,advance(){let k=vc;if(k){for(let l of d)k.tempSkipped.push(l);a&&(k.scheduleOn=k.scheduleOn?Promise.all([k.scheduleOn,a]):a)}this.parsedPos=g;return new ua(Ma.none,[],[],g-f)},stoppedAt:null,stopAt(){}}}}}isDone(a){a=Math.min(a,this.state.doc.length);let b=this.fragments;return this.treeLen>=a&&b.length&&0==b[0].from&&b[0].to>=a}static get(){return vc}},wc=class{constructor(a){this.context=
a;this.tree=a.tree}apply(a){if(!a.docChanged&&this.tree==this.context.tree)return this;let b=this.context.changes(a.changes,a.state);a=this.context.treeLen==a.startState.doc.length?void 0:Math.max(a.changes.mapPos(this.context.treeLen),b.viewport.to);b.work(20,a)||b.takeTree();return new wc(b)}static init(a){let b=Math.min(3E3,a.doc.length);a=qf.create(a.facet(hb).parser,a,{from:0,to:b});a.work(20,b)||a.takeTree();return new wc(a)}};Oa.state=na.define({create:wc.init,update(a,b){for(let c of b.effects)if(c.is(Oa.setState))return c.value;
return b.startState.facet(hb)!=b.state.facet(hb)?wc.init(b.state):a.apply(b)}});var wj=a=>{let b=setTimeout(()=>a(),500);return()=>clearTimeout(b)};"undefined"!=typeof requestIdleCallback&&(wj=a=>{let b=-1,c=setTimeout(()=>{b=requestIdleCallback(a,{timeout:400})},100);return()=>0>b?clearTimeout(c):cancelIdleCallback(b)});var rf="undefined"!=typeof navigator&&(null===(pf=navigator.scheduling)||void 0===pf?0:pf.isInputPending)?()=>navigator.scheduling.isInputPending():null,Gn=fa.fromClass(class{constructor(a){this.view=
a;this.working=null;this.workScheduled=0;this.chunkBudget=this.chunkEnd=-1;this.work=this.work.bind(this);this.scheduleWork()}update(a){let b=this.view.state.field(Oa.state).context;(b.updateViewport(a.view.viewport)||this.view.viewport.to>b.treeLen)&&this.scheduleWork();a.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork());this.checkAsyncSchedule(b)}scheduleWork(){if(!this.working){var {state:a}=this.view,b=a.field(Oa.state);b.tree==b.context.tree&&b.context.isDone(a.doc.length)||
(this.working=wj(this.work))}}work(a){this.working=null;let b=Date.now();this.chunkEnd<b&&(0>this.chunkEnd||this.view.hasFocus)&&(this.chunkEnd=b+3E4,this.chunkBudget=3E3);if(!(0>=this.chunkBudget)){var {state:c,viewport:{to:d}}=this.view,f=c.field(Oa.state);if(f.tree!=f.context.tree||!f.context.isDone(d+1E5)){var g=Date.now()+Math.min(this.chunkBudget,100,a&&!rf?Math.max(25,a.timeRemaining()-5):1E9);a=f.context.treeLen<d&&c.doc.length>d+1E3;var k=f.context.work(()=>rf&&rf()||Date.now()>g,d+(a?0:
1E5));this.chunkBudget-=Date.now()-b;if(k||0>=this.chunkBudget)f.context.takeTree(),this.view.dispatch({effects:Oa.setState.of(new wc(f.context))});0<this.chunkBudget&&(!k||a)&&this.scheduleWork();this.checkAsyncSchedule(f.context)}}}checkAsyncSchedule(a){a.scheduleOn&&(this.workScheduled++,a.scheduleOn.then(()=>this.scheduleWork()).catch(b=>za(this.view.state,b)).then(()=>this.workScheduled--),a.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||0<this.workScheduled)}},
{eventHandlers:{focus(){this.scheduleWork()}}}),hb=E.define({combine(a){return a.length?a[0]:null},enables:[Oa.state,Gn]}),Il=E.define(),pe=E.define({combine:a=>{if(!a.length)return"  ";if(!/^(?: +|\t+)$/.test(a[0]))throw Error("Invalid indent unit: "+JSON.stringify(a[0]));return a[0]}}),Uc=class{constructor(a,b={}){this.state=a;this.options=b;this.unit=Tc(a)}lineAt(a,b=1){let c=this.state.doc.lineAt(a),{simulateBreak:d,simulateDoubleBreak:f}=this.options;return null!=d&&d>=c.from&&d<=c.to?f&&d==
a?{text:"",from:a}:(0>b?d<a:d<=a)?{text:c.text.slice(d-c.from),from:d}:{text:c.text.slice(0,d-c.from),from:c.from}:c}textAfterPos(a,b=1){if(this.options.simulateDoubleBreak&&a==this.options.simulateBreak)return"";let {text:c,from:d}=this.lineAt(a,b);return c.slice(a-d,Math.min(c.length,a+100-d))}column(a,b=1){let {text:c,from:d}=this.lineAt(a,b);a=this.countColumn(c,a-d);b=this.options.overrideIndentation?this.options.overrideIndentation(d):-1;-1<b&&(a+=b-this.countColumn(c,c.search(/\S|$/)));return a}countColumn(a,
b=a.length){return Zb(a,this.state.tabSize,b)}lineIndent(a,b=1){let {text:c,from:d}=this.lineAt(a,b);if(a=this.options.overrideIndentation)if(a=a(d),-1<a)return a;return this.countColumn(c,c.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}},Kl=new P,uh=class extends Uc{constructor(a,b,c){super(a.state,a.options);this.base=a;this.pos=b;this.node=c}static create(a,b,c){return new uh(a,b,c)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let a=this.state.doc.lineAt(this.node.from);
for(;;){let c=this.node.resolve(a.from);for(;c.parent&&c.parent.from==c.from;)c=c.parent;var b;a:{for(b=this.node;b;b=b.parent)if(c==b){b=!0;break a}b=!1}if(b)break;a=this.state.doc.lineAt(c.from)}return this.lineIndent(a.from)}continue(){let a=this.node.parent;return a?th(a,this.pos,this.base):0}},Ml=E.define(),Nl=new P,Cd=K.define({map:vh}),xc=K.define({map:vh}),tb=na.define({create(){return H.none},update(a,b){a=a.map(b.changes);for(let c of b.effects)c.is(Cd)&&!Ol(a,c.value.from,c.value.to)?a=
a.update({add:[Hn.range(c.value.from,c.value.to)]}):c.is(xc)&&(a=a.update({filter:(d,f)=>c.value.from!=d||c.value.to!=f,filterFrom:c.value.from,filterTo:c.value.to}));if(b.selection){let c=!1,{head:d}=b.selection.main;a.between(d,d,(f,g)=>{f<d&&g>d&&(c=!0)});c&&(a=a.update({filterFrom:d,filterTo:d,filter:(f,g)=>g<=d||f>=d}))}return a},provide:a=>I.decorations.from(a)}),In={placeholderDOM:null,placeholderText:"\u2026"},Ah=E.define({combine(a){return Wa(a,In)}}),Hn=H.replace({widget:new class extends kb{toDOM(a){let {state:b}=
a,c=b.facet(Ah),d=g=>{var k=a.lineBlockAt(a.posAtDOM(g.target));(k=Wc(a.state,k.from,k.to))&&a.dispatch({effects:xc.of(k)});g.preventDefault()};if(c.placeholderDOM)return c.placeholderDOM(a,d);let f=document.createElement("span");f.textContent=c.placeholderText;f.setAttribute("aria-label",b.phrase("folded code"));f.title=b.phrase("unfold");f.className="cm-foldPlaceholder";f.onclick=d;return f}}}),Jn={openText:"\u2304",closedText:"\u203a",markerDOM:null,domEventHandlers:{}},sf=class extends $a{constructor(a,
b){super();this.config=a;this.open=b}eq(a){return this.config==a.config&&this.open==a.open}toDOM(a){if(this.config.markerDOM)return this.config.markerDOM(this.open);let b=document.createElement("span");b.textContent=this.open?this.config.openText:this.config.closedText;b.title=a.state.phrase(this.open?"Fold line":"Unfold line");return b}},Pl=I.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},
".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),tf=class{constructor(a,b){function c(k){let l=eb.newName();(d||=Object.create(null))["."+l]=k;return l}let d;const f="string"==typeof b.all?b.all:b.all?c(b.all):void 0,g=b.scope;this.scope=g instanceof Oa?k=>k.prop(Sc)==g.data:g?k=>k==g:void 0;this.style=qh(a.map(k=>({tag:k.tag,class:k.class||c(Object.assign({},k,{tag:null}))})),{all:f}).style;this.module=d?new eb(d):null;this.themeType=b.themeType}static define(a,b){return new tf(a,b||{})}},
se=E.define(),Bh=E.define({combine(a){return a.length?[a[0]]:null}}),Kn=lc.high(fa.fromClass(class{constructor(a){this.markCache=Object.create(null);this.tree=ra(a.state);this.decorations=this.buildDeco(a,re(a.state))}update(a){let b=ra(a.state),c=re(a.state),d=c!=re(a.startState);if(b.length<a.view.viewport.to&&!d&&b.type==this.tree.type)this.decorations=this.decorations.map(a.changes);else if(b!=this.tree||a.viewportChanged||d)this.tree=b,this.decorations=this.buildDeco(a.view,c)}buildDeco(a,b){if(!b||
!this.tree.length)return H.none;let c=new yb;for(let {from:d,to:f}of a.visibleRanges)Gl(this.tree,b,(g,k,l)=>{c.add(g,k,this.markCache[l]||(this.markCache[l]=H.mark({class:l})))},d,f);return c.finish()}},{decorations:a=>a.decorations})),Ln=tf.define([{tag:A.meta,color:"#7a757a"},{tag:A.link,textDecoration:"underline"},{tag:A.heading,textDecoration:"underline",fontWeight:"bold"},{tag:A.emphasis,fontStyle:"italic"},{tag:A.strong,fontWeight:"bold"},{tag:A.strikethrough,textDecoration:"line-through"},
{tag:A.keyword,color:"#708"},{tag:[A.atom,A.bool,A.url,A.contentSeparator,A.labelName],color:"#219"},{tag:[A.literal,A.inserted],color:"#164"},{tag:[A.string,A.deleted],color:"#a11"},{tag:[A.regexp,A.escape,A.special(A.string)],color:"#e40"},{tag:A.definition(A.variableName),color:"#00f"},{tag:A.local(A.variableName),color:"#30a"},{tag:[A.typeName,A.namespace],color:"#085"},{tag:A.className,color:"#167"},{tag:[A.special(A.variableName),A.macroName],color:"#256"},{tag:A.definition(A.propertyName),
color:"#00c"},{tag:A.comment,color:"#940"},{tag:A.invalid,color:"#f00"}]),Mn=I.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),xj=E.define({combine(a){return Wa(a,{afterCursor:!0,brackets:"()[]{}",maxScanDistance:1E4,renderMatch:Ql})}}),Rl=H.mark({class:"cm-matchingBracket"}),Sl=H.mark({class:"cm-nonmatchingBracket"}),Nn=[na.define({create(){return H.none},update(a,b){if(!b.docChanged&&!b.selection)return a;
a=[];let c=b.state.facet(xj);for(let d of b.state.selection.ranges){if(!d.empty)continue;let f=Pa(b.state,d.head,-1,c)||0<d.head&&Pa(b.state,d.head-1,1,c)||c.afterCursor&&(Pa(b.state,d.head,1,c)||d.head<b.state.doc.length&&Pa(b.state,d.head+1,-1,c));f&&(a=a.concat(c.renderMatch(f,b.state)))}return H.set(a,!0)},provide:a=>I.decorations.from(a)}),Mn],On=Object.create(null),Dh=[Ma.none],Ch=[],Pn=Object.create(null);for(let [a,b]of[["variable","variableName"],["variable-2","variableName.special"],["string-2",
"string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Pn[a]=Tl(On,b);var Qn=ve(function(a,b,c=b.selection.ranges){var d=[];let f=-1;for(let {from:l,to:m}of c){c=d.length;let n=1E9;for(var g=l;g<=m;){var k=b.doc.lineAt(g);if(k.from>f&&(l==m||m>k.from)){f=k.from;let p=we(b,g).line;if(!p)continue;g=/^\s*/.exec(k.text)[0].length;
let q=g==k.length,r=k.text.slice(g,g+p.length)==p?g:-1;g<k.text.length&&g<n&&(n=g);d.push({line:k,comment:r,token:p,indent:g,empty:q,single:!1})}g=k.to+1}if(1E9>n)for(k=c;k<d.length;k++)d[k].indent<d[k].line.text.length&&(d[k].indent=n);d.length==c+1&&(d[c].single=!0)}if(2!=a&&d.some(l=>0>l.comment&&(!l.empty||l.single))){a=[];for(let {line:l,token:m,indent:n,empty:p,single:q}of d)!q&&p||a.push({from:l.from+n,insert:m+" "});d=b.changes(a);return{changes:d,selection:b.selection.map(d,1)}}if(1!=a&&
d.some(l=>0<=l.comment)){b=[];for(let {line:l,comment:m,token:n}of d)0<=m&&(d=l.from+m,a=d+n.length," "==l.text[a-l.from]&&a++,b.push({from:d,to:a}));return{changes:b}}return null},0),Rn=ve(Fh,0),Sn=ve((a,b)=>{let c=[];for(let d of b.selection.ranges){let f=b.doc.lineAt(d.from),g=d.to<=f.to?f:b.doc.lineAt(d.to),k=c.length-1;0<=k&&c[k].to>f.from?c[k].to=g.to:c.push({from:f.from,to:g.to})}return Fh(a,b,c)},0),hc=50,Dd=wb.define(),Tn=wb.define(),Un=E.define(),yj=E.define({combine(a){return Wa(a,{minDepth:100,
newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}}),Gh=na.define({create(){return bb.empty},update(a,b){let c=b.state.facet(yj);var d=b.annotation(Dd);if(d){var f=b.docChanged?u.single(Wl(b.changes)):void 0;f=Aa.fromTransaction(b,f);var g=d.side;a=0==g?a.undone:a.done;a=f?Yc(a,a.length,c.minDepth,f):Ih(a,b.startState.selection);return new bb(0==g?d.rest:a,0==g?a:d.rest)}d=b.annotation(Tn);if("full"==d||"before"==d)a=a.isolate();if(!1===b.annotation(ja.addToHistory))return b.changes.empty?
a:a.addMapping(b.changes.desc);f=Aa.fromTransaction(b);g=b.annotation(ja.time);let k=b.annotation(ja.userEvent);f?a=a.addChanges(f,g,k,c.newGroupDelay,c.minDepth):b.selection&&(a=a.addSelection(b.startState.selection,g,k,c.newGroupDelay));if("full"==d||"after"==d)a=a.isolate();return a},toJSON(a){return{done:a.done.map(b=>b.toJSON()),undone:a.undone.map(b=>b.toJSON())}},fromJSON(a){return new bb(a.done.map(Aa.fromJSON),a.undone.map(Aa.fromJSON))}}),zj=Xc(0,!1),Aj=Xc(1,!1),Vn=Xc(0,!0),Wn=Xc(1,!0),
Aa=class{constructor(a,b,c,d,f){this.changes=a;this.effects=b;this.mapped=c;this.startSelection=d;this.selectionsAfter=f}setSelAfter(a){return new Aa(this.changes,this.effects,this.mapped,this.startSelection,a)}toJSON(){var a,b,c;return{changes:null===(a=this.changes)||void 0===a?void 0:a.toJSON(),mapped:null===(b=this.mapped)||void 0===b?void 0:b.toJSON(),startSelection:null===(c=this.startSelection)||void 0===c?void 0:c.toJSON(),selectionsAfter:this.selectionsAfter.map(d=>d.toJSON())}}static fromJSON(a){return new Aa(a.changes&&
ia.fromJSON(a.changes),[],a.mapped&&Va.fromJSON(a.mapped),a.startSelection&&u.fromJSON(a.startSelection),a.selectionsAfter.map(u.fromJSON))}static fromTransaction(a,b){let c=Ha;for(let d of a.startState.facet(Un)){let f=d(a);f.length&&(c=c.concat(f))}return!c.length&&a.changes.empty?null:new Aa(a.changes.invert(a.startState.doc),c,void 0,b||a.startState.selection,Ha)}static selection(a){return new Aa(void 0,Ha,void 0,void 0,a)}},Ha=[],Zl=200,Xn=/^(input\.type|delete)($|\.)/,bb=class{constructor(a,
b,c=0,d){this.done=a;this.undone=b;this.prevTime=c;this.prevUserEvent=d}isolate(){return this.prevTime?new bb(this.done,this.undone):this}addChanges(a,b,c,d,f){let g=this.done,k=g[g.length-1];g=k&&k.changes&&!k.changes.empty&&a.changes&&(!c||Xn.test(c))&&(!k.selectionsAfter.length&&b-this.prevTime<d&&Xl(k.changes,a.changes)||"input.type.compose"==c)?Yc(g,g.length-1,f,new Aa(a.changes.compose(k.changes),Hh(a.effects,k.effects),k.mapped,k.startSelection,Ha)):Yc(g,g.length,f,a);return new bb(g,Ha,b,
c)}addSelection(a,b,c,d){let f=this.done.length?this.done[this.done.length-1].selectionsAfter:Ha;return 0<f.length&&b-this.prevTime<d&&c==this.prevUserEvent&&c&&/^select($|\.)/.test(c)&&Yl(f[f.length-1],a)?this:new bb(Ih(this.done,a),this.undone,b,c)}addMapping(a){return new bb(xe(this.done,a),xe(this.undone,a),this.prevTime,this.prevUserEvent)}pop(a,b,c){var d=0==a?this.done:this.undone;if(0==d.length)return null;var f=d[d.length-1];if(c&&f.selectionsAfter.length){c=b.update;f=f.selectionsAfter[f.selectionsAfter.length-
1];var g=Dd.of;let k=d[d.length-1],l=d.slice();l[d.length-1]=k.setSelAfter(k.selectionsAfter.slice(0,k.selectionsAfter.length-1));return c.call(b,{selection:f,annotations:g.call(Dd,{side:a,rest:l}),userEvent:0==a?"select.undo":"select.redo",scrollIntoView:!0})}return f.changes?(d=1==d.length?Ha:d.slice(0,d.length-1),f.mapped&&(d=xe(d,f.mapped)),b.update({changes:f.changes,selection:f.startSelection,effects:f.effects,annotations:Dd.of({side:a,rest:d}),filter:!1,userEvent:0==a?"undo":"redo",scrollIntoView:!0})):
null}};bb.empty=new bb(Ha,Ha);var Yn=[{key:"Mod-z",run:zj,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Aj,preventDefault:!0},{key:"Mod-u",run:Vn,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Wn,preventDefault:!0}],Bj=a=>Jh(a,!Ia(a)),Cj=a=>Jh(a,Ia(a)),Dj=a=>Lh(a,!1),Ej=a=>Lh(a,!0),Fj=a=>Mh(a,!1),uf=a=>Mh(a,!0),Gj=a=>Ya(a,b=>$c(a,b,!0)),Hj=a=>Ya(a,b=>$c(a,b,!1)),Ij=a=>Nh(a,!Ia(a)),Jj=a=>Nh(a,Ia(a)),Kj=a=>Ph(a,!1),Lj=a=>Ph(a,!0),Mj=a=>Qh(a,!1),Nj=a=>Qh(a,!0),Oj=a=>Ra(a,b=>$c(a,b,!0)),
Pj=a=>Ra(a,b=>$c(a,b,!1)),Qj=({state:a,dispatch:b})=>{b(Qa(a,{anchor:0}));return!0},Rj=({state:a,dispatch:b})=>{b(Qa(a,{anchor:a.doc.length}));return!0},Sj=({state:a,dispatch:b})=>{b(Qa(a,{anchor:a.selection.main.anchor,head:0}));return!0},Tj=({state:a,dispatch:b})=>{b(Qa(a,{anchor:a.selection.main.anchor,head:a.doc.length}));return!0},Uj=(a,b)=>ad(a,c=>{var {state:d}=a,f=d.doc.lineAt(c),g;if(!b&&c>f.from&&c<f.from+200&&!/[^ \t]/.test(g=f.text.slice(0,c-f.from))){if("\t"==g[g.length-1])return c-1;
d=Zb(g,d.tabSize)%Tc(d)||Tc(d);for(f=0;f<d&&" "==g[g.length-1-f];f++)c--;g=c}else g=ya(f.text,c-f.from,b,b)+f.from,g==c&&f.number!=(b?d.doc.lines:1)&&(g+=b?1:-1);return bd(a,g,b)}),vf=a=>Uj(a,!1),Vj=a=>Uj(a,!0),Wj=(a,b)=>ad(a,c=>{let d=c,{state:f}=a,g=f.doc.lineAt(d),k=f.charCategorizer(d);for(let l=null;;){if(d==(b?g.to:g.from)){d==c&&g.number!=(b?f.doc.lines:1)&&(d+=b?1:-1);break}let m=ya(g.text,d-g.from,b)+g.from,n=g.text.slice(Math.min(d,m)-g.from,Math.max(d,m)-g.from),p=k(n);if(null!=l&&p!=l)break;
if(" "!=n||d!=c)l=p;d=m}return bd(a,d,b)}),Xj=a=>Wj(a,!1),Yj=a=>ad(a,b=>{let c=a.lineBlockAt(b).to;return bd(a,b<c?c:Math.min(a.state.doc.length,b+1),!0)}),Zn=Th(!1),$n=Th(!0),ao=[{key:"ArrowLeft",run:Bj,shift:Ij,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:a=>Kh(a,!Ia(a)),shift:a=>Oh(a,!Ia(a))},{mac:"Cmd-ArrowLeft",run:Hj,shift:Pj},{key:"ArrowRight",run:Cj,shift:Jj,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:a=>Kh(a,Ia(a)),shift:a=>Oh(a,Ia(a))},{mac:"Cmd-ArrowRight",
run:Gj,shift:Oj},{key:"ArrowUp",run:Dj,shift:Kj,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Qj,shift:Sj},{mac:"Ctrl-ArrowUp",run:Fj,shift:Mj},{key:"ArrowDown",run:Ej,shift:Lj,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Rj,shift:Tj},{mac:"Ctrl-ArrowDown",run:uf,shift:Nj},{key:"PageUp",run:Fj,shift:Mj},{key:"PageDown",run:uf,shift:Nj},{key:"Home",run:Hj,shift:Pj,preventDefault:!0},{key:"Mod-Home",run:Qj,shift:Sj},{key:"End",run:Gj,shift:Oj,preventDefault:!0},{key:"Mod-End",run:Rj,shift:Tj},{key:"Enter",
run:Zn},{key:"Mod-a",run:({state:a,dispatch:b})=>{b(a.update({selection:{anchor:0,head:a.doc.length},userEvent:"select"}));return!0}},{key:"Backspace",run:vf,shift:vf},{key:"Delete",run:Vj},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Xj},{key:"Mod-Delete",mac:"Alt-Delete",run:a=>Wj(a,!0)},{mac:"Mod-Backspace",run:a=>ad(a,b=>{let c=a.lineBlockAt(b).from;return bd(a,b>c?c:Math.max(0,b-1),!1)})},{mac:"Mod-Delete",run:Yj}].concat([{key:"Ctrl-b",run:Bj,shift:Ij,preventDefault:!0},{key:"Ctrl-f",run:Cj,
shift:Jj},{key:"Ctrl-p",run:Dj,shift:Kj},{key:"Ctrl-n",run:Ej,shift:Lj},{key:"Ctrl-a",run:a=>Ya(a,b=>u.cursor(a.lineBlockAt(b.head).from,1)),shift:a=>Ra(a,b=>u.cursor(a.lineBlockAt(b.head).from))},{key:"Ctrl-e",run:a=>Ya(a,b=>u.cursor(a.lineBlockAt(b.head).to,-1)),shift:a=>Ra(a,b=>u.cursor(a.lineBlockAt(b.head).to))},{key:"Ctrl-d",run:Vj},{key:"Ctrl-h",run:vf},{key:"Ctrl-k",run:Yj},{key:"Ctrl-Alt-h",run:Xj},{key:"Ctrl-o",run:({state:a,dispatch:b})=>{if(a.readOnly)return!1;let c=a.changeByRange(d=>
({changes:{from:d.from,to:d.to,insert:V.of(["",""])},range:u.cursor(d.from)}));b(a.update(c,{scrollIntoView:!0,userEvent:"input"}));return!0}},{key:"Ctrl-t",run:({state:a,dispatch:b})=>{if(a.readOnly)return!1;let c=a.changeByRange(d=>{if(!d.empty||0==d.from||d.from==a.doc.length)return{range:d};d=d.from;var f=a.doc.lineAt(d);let g=d==f.from?d-1:ya(f.text,d-f.from,!1)+f.from;f=d==f.to?d+1:ya(f.text,d-f.from,!0)+f.from;return{changes:{from:g,to:f,insert:a.doc.slice(d,f).append(a.doc.slice(g,d))},range:u.cursor(f)}});
if(c.changes.empty)return!1;b(a.update(c,{scrollIntoView:!0,userEvent:"move.character"}));return!0}},{key:"Ctrl-v",run:uf}].map(a=>({mac:a.key,run:a.run,shift:a.shift}))),bo=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:a=>Ya(a,b=>Zc(a.state,b,!Ia(a))),shift:a=>Ra(a,b=>Zc(a.state,b,!Ia(a)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:a=>Ya(a,b=>Zc(a.state,b,Ia(a))),shift:a=>Ra(a,b=>Zc(a.state,b,Ia(a)))},{key:"Alt-ArrowUp",run:({state:a,dispatch:b})=>Rh(a,b,!1)},{key:"Shift-Alt-ArrowUp",run:({state:a,
dispatch:b})=>Sh(a,b,!1)},{key:"Alt-ArrowDown",run:({state:a,dispatch:b})=>Rh(a,b,!0)},{key:"Shift-Alt-ArrowDown",run:({state:a,dispatch:b})=>Sh(a,b,!0)},{key:"Escape",run:({state:a,dispatch:b})=>{let c=a.selection,d=null;1<c.ranges.length?d=u.create([c.main]):c.main.empty||(d=u.create([u.cursor(c.main.head)]));if(!d)return!1;b(Qa(a,d));return!0}},{key:"Mod-Enter",run:$n},{key:"Alt-l",mac:"Ctrl-l",run:({state:a,dispatch:b})=>{let c=cd(a).map(({from:d,to:f})=>u.range(d,Math.min(f+1,a.doc.length)));
b(a.update({selection:u.create(c),userEvent:"select"}));return!0}},{key:"Mod-i",run:({state:a,dispatch:b})=>{let c=Lb(a.selection,d=>{var f;let g=ra(a).resolveInner(d.head,1);for(;!(g.from<d.from&&g.to>=d.to||g.to>d.to&&g.from<=d.from)&&(null===(f=g.parent)||void 0===f?0:f.parent);)g=g.parent;return u.range(g.to,g.from)});b(Qa(a,c));return!0},preventDefault:!0},{key:"Mod-[",run:({state:a,dispatch:b})=>{if(a.readOnly)return!1;b(a.update(ye(a,(c,d)=>{let f=/^\s*/.exec(c.text)[0];if(f){var g=Zb(f,a.tabSize),
k=0;for(g=gc(a,Math.max(0,g-Tc(a)));k<f.length&&k<g.length&&f.charCodeAt(k)==g.charCodeAt(k);)k++;d.push({from:c.from+k,to:c.from+f.length,insert:g.slice(k)})}}),{userEvent:"delete.dedent"}));return!0}},{key:"Mod-]",run:({state:a,dispatch:b})=>{if(a.readOnly)return!1;b(a.update(ye(a,(c,d)=>{d.push({from:c.from,insert:a.facet(pe)})}),{userEvent:"input.indent"}));return!0}},{key:"Mod-Alt-\\",run:({state:a,dispatch:b})=>{if(a.readOnly)return!1;let c=Object.create(null),d=new Uc(a,{overrideIndentation:g=>
{g=c[g];return null==g?-1:g}}),f=ye(a,(g,k,l)=>{let m=qe(d,g.from);if(null!=m){/\S/.test(g.text)||(m=0);var n=/^\s*/.exec(g.text)[0],p=gc(a,m);if(n!=p||l.from<g.from+n.length)c[g.from]=m,k.push({from:g.from,to:g.from+n.length,insert:p})}});f.changes.empty||b(a.update(f,{userEvent:"indent"}));return!0}},{key:"Shift-Mod-k",run:a=>{if(a.state.readOnly)return!1;let {state:b}=a,c=b.changes(cd(b).map(({from:f,to:g})=>{0<f?f--:g<b.doc.length&&g++;return{from:f,to:g}})),d=Lb(b.selection,f=>a.moveVertically(f,
!0)).map(c);a.dispatch({changes:c,selection:d,scrollIntoView:!0,userEvent:"delete.line"});return!0}},{key:"Shift-Mod-\\",run:({state:a,dispatch:b})=>am(a,b,!1)},{key:"Mod-/",run:a=>{let b=we(a.state);return b.line?Qn(a):b.block?Sn(a):!1}},{key:"Alt-A",run:Rn}].concat(ao),Zj="function"==typeof String.prototype.normalize?a=>a.normalize("NFKD"):a=>a,Mb=class{constructor(a,b,c=0,d=a.length,f){this.value={from:0,to:0};this.done=!1;this.matches=[];this.buffer="";this.bufferPos=0;this.iter=a.iterRange(c,
d);this.bufferStart=c;this.normalize=f?g=>f(Zj(g)):Zj;this.query=this.normalize(b)}peek(){if(this.bufferPos==this.buffer.length){this.bufferStart+=this.buffer.length;this.iter.next();if(this.iter.done)return-1;this.bufferPos=0;this.buffer=this.iter.value}return ma(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){var a=this.peek();if(0>a)return this.done=!0,this;let b=Kd(a),c=this.bufferStart+this.bufferPos;this.bufferPos+=
Fa(a);a=this.normalize(b);for(let d=0,f=c;;d++){let g=a.charCodeAt(d),k=this.match(g,f);if(k)return this.value=k,this;if(d==a.length-1)break;f==c&&d<b.length&&b.charCodeAt(d)==g&&f++}}}match(a,b){let c=null;for(let d=0;d<this.matches.length;d+=2){let f=this.matches[d],g=!1;this.query.charCodeAt(f)==a&&(f==this.query.length-1?c={from:this.matches[d+1],to:b+1}:(this.matches[d]++,g=!0));g||(this.matches.splice(d,2),d-=2)}this.query.charCodeAt(0)==a&&(1==this.query.length?c={from:b,to:b+1}:this.matches.push(1,
b));return c}};"undefined"!=typeof Symbol&&(Mb.prototype[Symbol.iterator]=function(){return this});var ak={from:-1,to:-1,match:/.*/.exec("")},wf="gm"+(null==/x/.unicode?"":"u"),Wh=class{constructor(a,b,c,d=0,f=a.length){this.to=f;this.curLine="";this.done=!1;this.value=ak;if(/\\[sWDnr]|\n|\r|\[\^/.test(b))return new bk(a,b,c,d,f);this.re=new RegExp(b,wf+((null===c||void 0===c?0:c.ignoreCase)?"i":""));this.iter=a.iter();this.curLineStart=a.lineAt(d).from;this.matchPos=d;this.getLine(this.curLineStart)}getLine(a){this.iter.next(a);
this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1;this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(var a=this.matchPos-this.curLineStart;;)if(this.re.lastIndex=a,a=this.matchPos<=this.to&&this.re.exec(this.curLine)){let b=this.curLineStart+a.index,c=b+a[0].length;this.matchPos=
c+(b==c?1:0);b==this.curLine.length&&this.nextLine();if(b<c||b>this.value.to)return this.value={from:b,to:c,match:a},this;a=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),a=0;else return this.done=!0,this}},xf=new WeakMap,yc=class{constructor(a,b){this.from=a;this.text=b}get to(){return this.from+this.text.length}static get(a,b,c){let d=xf.get(a);if(!d||d.from>=c||d.to<=b)return b=new yc(b,a.sliceString(b,c)),xf.set(a,b),b;if(d.from==b&&d.to==
c)return d;let {text:f,from:g}=d;g>b&&(f=a.sliceString(b,g)+f,g=b);d.to<c&&(f+=a.sliceString(d.to,c));xf.set(a,new yc(g,f));return new yc(b,f.slice(b-g,c-g))}},bk=class{constructor(a,b,c,d,f){this.text=a;this.to=f;this.done=!1;this.value=ak;this.matchPos=d;this.re=new RegExp(b,wf+((null===c||void 0===c?0:c.ignoreCase)?"i":""));this.flat=yc.get(a,d,this.chunkEnd(d+5E3))}chunkEnd(a){return a>=this.to?this.to:this.text.lineAt(a).to}next(){for(;;){var a=this.re.lastIndex=this.matchPos-this.flat.from;
let b=this.re.exec(this.flat.text);b&&!b[0]&&b.index==a&&(this.re.lastIndex=a+1,b=this.re.exec(this.flat.text));b&&this.flat.to<this.to&&b.index+b[0].length>this.flat.text.length-10&&(b=null);if(b){a=this.flat.from+b.index;let c=a+b[0].length;this.value={from:a,to:c,match:b};this.matchPos=c+(a==c?1:0);return this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=yc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}};"undefined"!=typeof Symbol&&(Wh.prototype[Symbol.iterator]=
bk.prototype[Symbol.iterator]=function(){return this});var dd=K.define(),ck=na.define({create(){return!0},update(a,b){for(let c of b.effects)c.is(dd)&&(a=c.value);return a},provide:a=>tc.from(a,b=>b?ze:null)}),co=I.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),eo={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},dk=E.define({combine(a){return Wa(a,eo,{highlightWordAroundCursor:(b,c)=>b||c,minSelectionLength:Math.min,maxMatches:Math.min})}}),
fo=H.mark({class:"cm-selectionMatch"}),go=H.mark({class:"cm-selectionMatch cm-selectionMatch-main"}),ho=fa.fromClass(class{constructor(a){this.decorations=this.getDeco(a)}update(a){if(a.selectionSet||a.docChanged||a.viewportChanged)this.decorations=this.getDeco(a.view)}getDeco(a){let b=a.state.facet(dk),{state:c}=a;var d=c.selection;if(1<d.ranges.length)return H.none;d=d.main;let f=null;if(d.empty){if(!b.highlightWordAroundCursor)return H.none;var g=c.wordAt(d.head);if(!g)return H.none;f=c.charCategorizer(d.head);
g=c.sliceDoc(g.from,g.to)}else{g=d.to-d.from;if(g<b.minSelectionLength||200<g)return H.none;if(b.wholeWords){g=c.sliceDoc(d.from,d.to);f=c.charCategorizer(d.head);var k;if(k=Vh(f,c,d.from,d.to)){k=f;var l=d.from,m=d.to;k=k(c.sliceDoc(l,l+1))==va.Word&&k(c.sliceDoc(m-1,m))==va.Word}if(!k)return H.none}else if(g=c.sliceDoc(d.from,d.to).trim(),!g)return H.none}k=[];for(let n of a.visibleRanges)for(a=new Mb(c.doc,g,n.from,n.to);!a.next().done;){let {from:p,to:q}=a.value;if(!f||Vh(f,c,p,q))if(d.empty&&
p<=d.from&&q>=d.to?k.push(go.range(p,q)):(p>=d.to||q<=d.from)&&k.push(fo.range(p,q)),k.length>b.maxMatches)return H.none}return H.set(k)}},{decorations:a=>a.decorations}),io=I.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),jo=({state:a,dispatch:b})=>{let {selection:c}=a,d=u.create(c.ranges.map(f=>a.wordAt(f.head)||u.cursor(f.head)),c.mainIndex);if(d.eq(c))return!1;b(a.update({selection:d}));return!0},Be=E.define({combine(a){var b;
return{top:a.reduce((c,d)=>null!==c&&void 0!==c?c:d.top,void 0)||!1,caseSensitive:a.reduce((c,d)=>null!==c&&void 0!==c?c:d.caseSensitive,void 0)||!1,createPanel:(null===(b=a.find(c=>c.createPanel))||void 0===b?void 0:b.createPanel)||(c=>new ko(c))}}}),Yh=class{constructor(a){this.search=a.search;this.caseSensitive=!!a.caseSensitive;this.regexp=!!a.regexp;this.replace=a.replace||"";var b;if((b=!!this.search)&&!(b=!this.regexp))try{new RegExp(this.search,wf),b=!0}catch(c){b=!1}this.valid=b;this.unquoted=
a.literal?this.search:this.search.replace(/\\([nrt\\])/g,(c,d)=>"n"==d?"\n":"r"==d?"\r":"t"==d?"\t":"\\")}eq(a){return this.search==a.search&&this.replace==a.replace&&this.caseSensitive==a.caseSensitive&&this.regexp==a.regexp}create(){return this.regexp?new lo(this):new mo(this)}getCursor(a,b=0,c=a.length){return this.regexp?Ob(this,a,b,c):Nb(this,a,b,c)}},ek=class{constructor(a){this.spec=a}},mo=class extends ek{constructor(a){super(a)}nextMatch(a,b,c){c=Nb(this.spec,a,c,a.length).nextOverlapping();
c.done&&(c=Nb(this.spec,a,0,b).nextOverlapping());return c.done?null:c.value}prevMatchInRange(a,b,c){for(;;){let d=Math.max(b,c-1E4-this.spec.unquoted.length),f=Nb(this.spec,a,d,c),g=null;for(;!f.nextOverlapping().done;)g=f.value;if(g)return g;if(d==b)return null;c-=1E4}}prevMatch(a,b,c){return this.prevMatchInRange(a,0,b)||this.prevMatchInRange(a,c,a.length)}getReplacement(a){return this.spec.replace}matchAll(a,b){a=Nb(this.spec,a,0,a.length);let c=[];for(;!a.next().done;){if(c.length>=b)return null;
c.push(a.value)}return c}highlight(a,b,c,d){for(a=Nb(this.spec,a,Math.max(0,b-this.spec.unquoted.length),Math.min(c+this.spec.unquoted.length,a.length));!a.next().done;)d(a.value.from,a.value.to)}},lo=class extends ek{nextMatch(a,b,c){c=Ob(this.spec,a,c,a.length).next();c.done&&(c=Ob(this.spec,a,0,b).next());return c.done?null:c.value}prevMatchInRange(a,b,c){for(let d=1;;d++){let f=Math.max(b,c-1E4*d),g=Ob(this.spec,a,f,c),k=null;for(;!g.next().done;)k=g.value;if(k&&(f==b||k.from>f+10))return k;if(f==
b)return null}}prevMatch(a,b,c){return this.prevMatchInRange(a,0,b)||this.prevMatchInRange(a,c,a.length)}getReplacement(a){return this.spec.replace.replace(/\$([$&\d+])/g,(b,c)=>"$"==c?"$":"&"==c?a.match[0]:"0"!=c&&+c<a.match.length?a.match[c]:b)}matchAll(a,b){a=Ob(this.spec,a,0,a.length);let c=[];for(;!a.next().done;){if(c.length>=b)return null;c.push(a.value)}return c}highlight(a,b,c,d){for(a=Ob(this.spec,a,Math.max(0,b-250),Math.min(c+250,a.length));!a.next().done;)d(a.value.from,a.value.to)}},
zc=K.define(),yf=K.define(),ib=na.define({create(a){return new zf(Ce(a).create(),null)},update(a,b){for(let c of b.effects)c.is(zc)?a=new zf(c.value.create(),a.panel):c.is(yf)&&(a=new zf(a.query,c.value?Ae:null));return a},provide:a=>tc.from(a,b=>b.panel)}),zf=class{constructor(a,b){this.query=a;this.panel=b}},no=H.mark({class:"cm-searchMatch"}),oo=H.mark({class:"cm-searchMatch cm-searchMatch-selected"}),po=fa.fromClass(class{constructor(a){this.view=a;this.decorations=this.highlight(a.state.field(ib))}update(a){let b=
a.state.field(ib);if(b!=a.startState.field(ib)||a.docChanged||a.selectionSet||a.viewportChanged)this.decorations=this.highlight(b)}highlight({query:a,panel:b}){if(!b||!a.spec.valid)return H.none;let {view:c}=this,d=new yb;for(let f=0,g=c.visibleRanges,k=g.length;f<k;f++){let {from:l,to:m}=g[f];for(;f<k-1&&m>g[f+1].from-500;)m=g[++f].to;a.highlight(c.state.doc,l,m,(n,p)=>{let q=c.state.selection.ranges.some(r=>r.from==n&&r.to==p);d.add(n,p,q?oo:no)})}return d.finish()}},{decorations:a=>a.decorations}),
Ed=ic((a,{query:b})=>{let {from:c,to:d}=a.state.selection.main;b=b.nextMatch(a.state.doc,c,d);if(!b||b.from==c&&b.to==d)return!1;a.dispatch({selection:{anchor:b.from,head:b.to},scrollIntoView:!0,effects:De(a,b),userEvent:"select.search"});return!0}),Fd=ic((a,{query:b})=>{let {state:c}=a,{from:d,to:f}=c.selection.main;b=b.prevMatch(c.doc,d,f);if(!b)return!1;a.dispatch({selection:{anchor:b.from,head:b.to},scrollIntoView:!0,effects:De(a,b),userEvent:"select.search"});return!0}),qo=ic((a,{query:b})=>
{b=b.matchAll(a.state.doc,1E3);if(!b||!b.length)return!1;a.dispatch({selection:u.create(b.map(c=>u.range(c.from,c.to))),userEvent:"select.search.matches"});return!0}),fk=ic((a,{query:b})=>{let {state:c}=a,{from:d,to:f}=c.selection.main;if(c.readOnly)return!1;let g=b.nextMatch(c.doc,d,d);if(!g)return!1;let k=[],l,m;g.from==d&&g.to==f&&(m=c.toText(b.getReplacement(g)),k.push({from:g.from,to:g.to,insert:m}),g=b.nextMatch(c.doc,g.from,g.to));g&&(b=0==k.length||k[0].from>=g.to?0:g.to-g.from-m.length,l=
{anchor:g.from-b,head:g.to-b});a.dispatch({changes:k,selection:l,scrollIntoView:!!l,effects:g?De(a,g):void 0,userEvent:"input.replace"});return!0}),ro=ic((a,{query:b})=>{if(a.state.readOnly)return!1;let c=b.matchAll(a.state.doc,1E9).map(d=>{let {from:f,to:g}=d;return{from:f,to:g,insert:b.getReplacement(d)}});if(!c.length)return!1;a.dispatch({changes:c,userEvent:"input.replace.all"});return!0}),Xh=a=>{var b=a.state.field(ib,!1);if(b&&b.panel){var c=ec(a,Ae);if(!c)return!1;c=c.dom.querySelector("[name=search]");
c!=a.root.activeElement&&(b=Ce(a.state,b.query.spec),b.valid&&a.dispatch({effects:zc.of(b)}),c.focus(),c.select())}else a.dispatch({effects:[yf.of(!0),b?zc.of(Ce(a.state,b.query.spec)):K.appendConfig.of(so)]});return!0},gk=a=>{var b=a.state.field(ib,!1);if(!b||!b.panel)return!1;(b=ec(a,Ae))&&b.dom.contains(a.root.activeElement)&&a.focus();a.dispatch({effects:yf.of(!1)});return!0},to=[{key:"Mod-f",run:Xh,scope:"editor search-panel"},{key:"F3",run:Ed,shift:Fd,scope:"editor search-panel",preventDefault:!0},
{key:"Mod-g",run:Ed,shift:Fd,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:gk,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:a,dispatch:b})=>{var c=a.selection;if(1<c.ranges.length||c.main.empty)return!1;let {from:d,to:f}=c.main;c=[];let g=0;for(let k=new Mb(a.doc,a.sliceDoc(d,f));!k.next().done;){if(1E3<c.length)return!1;k.value.from==d&&(g=c.length);c.push(u.range(k.value.from,k.value.to))}b(a.update({selection:u.create(c,g),userEvent:"select.search.matches"}));return!0}},
{key:"Alt-g",run:a=>{var b=ec(a,ze);b||(b=[dd.of(!0)],null==a.state.field(ck,!1)&&b.push(K.appendConfig.of([ck,co])),a.dispatch({effects:b}),b=ec(a,ze));b&&b.dom.querySelector("input").focus();return!0}},{key:"Mod-d",run:({state:a,dispatch:b})=>{var {ranges:c}=a.selection;if(c.some(f=>f.from===f.to))return jo({state:a,dispatch:b});let d=a.sliceDoc(c[0].from,c[0].to);if(a.selection.ranges.some(f=>a.sliceDoc(f.from,f.to)!=d))return!1;c=bm(a,d);if(!c)return!1;b(a.update({selection:a.selection.addRange(u.range(c.from,
c.to),!1),effects:I.scrollIntoView(c.to)}));return!0},preventDefault:!0}],ko=class{constructor(a){function b(d,f,g){return Y("button",{class:"cm-button",name:d,onclick:f,type:"button"},g)}this.view=a;let c=this.query=a.state.field(ib).query.spec;this.commit=this.commit.bind(this);this.searchField=Y("input",{value:c.search,placeholder:a.state.phrase("Find"),"aria-label":a.state.phrase("Find"),class:"cm-textfield",name:"search",onchange:this.commit,onkeyup:this.commit});this.replaceField=Y("input",
{value:c.replace,placeholder:a.state.phrase("Replace"),"aria-label":a.state.phrase("Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit});this.caseField=Y("input",{type:"checkbox",name:"case",checked:c.caseSensitive,onchange:this.commit});this.reField=Y("input",{type:"checkbox",name:"re",checked:c.regexp,onchange:this.commit});this.dom=Y("div",{onkeydown:d=>this.keydown(d),class:"cm-search"},[this.searchField,b("next",()=>Ed(a),[a.state.phrase("next")]),b("prev",
()=>Fd(a),[a.state.phrase("previous")]),b("select",()=>qo(a),[a.state.phrase("all")]),Y("label",null,[this.caseField,a.state.phrase("match case")]),Y("label",null,[this.reField,a.state.phrase("regexp")]),...(a.state.readOnly?[]:[Y("br"),this.replaceField,b("replace",()=>fk(a),[a.state.phrase("replace")]),b("replaceAll",()=>ro(a),[a.state.phrase("replace all")]),Y("button",{name:"close",onclick:()=>gk(a),"aria-label":a.state.phrase("close"),type:"button"},["\u00d7"])])])}commit(){let a=new Yh({search:this.searchField.value,
caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});a.eq(this.query)||(this.query=a,this.view.dispatch({effects:zc.of(a)}))}keydown(a){var b=this.view;Wg(Ug(b.state),a,b,"search-panel")?a.preventDefault():13==a.keyCode&&a.target==this.searchField?(a.preventDefault(),(a.shiftKey?Fd:Ed)(this.view)):13==a.keyCode&&a.target==this.replaceField&&(a.preventDefault(),fk(this.view))}update(a){for(let b of a.transactions)for(let c of b.effects)c.is(zc)&&!c.value.eq(this.query)&&
this.setQuery(c.value)}setQuery(a){this.query=a;this.searchField.value=a.search;this.replaceField.value=a.replace;this.caseField.checked=a.caseSensitive;this.reField.checked=a.regexp}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Be).top}},ed=30,fd=/[\s\.,:;?!]/,uo=I.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",
padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),so=[ib,lc.lowest(po),uo],hk=class{constructor(a,b,c){this.state=a;this.pos=b;this.explicit=c;this.abortListeners=
[]}tokenBefore(a){let b=ra(this.state).resolveInner(this.pos,-1);for(;b&&0>a.indexOf(b.name);)b=b.parent;return b?{from:b.from,to:this.pos,text:this.state.sliceDoc(b.from,this.pos),type:b.type}:null}matchBefore(a){var b=this.state.doc.lineAt(this.pos);let c=Math.max(b.from,this.pos-250);b=b.text.slice(c-b.from,this.pos-b.from);a=b.search($h(a,!1));return 0>a?null:{from:c+a,to:this.pos,text:b.slice(a)}}get aborted(){return null==this.abortListeners}addEventListener(a,b){"abort"==a&&this.abortListeners&&
this.abortListeners.push(b)}},ei=class{constructor(a,b,c){this.completion=a;this.source=b;this.match=c}},bi=new WeakMap,km=class{constructor(a){this.pattern=a;this.chars=[];this.folded=[];this.any=[];this.precise=[];this.byWord=[];for(let c=0;c<a.length;){var b=ma(a,c);let d=Fa(b);this.chars.push(b);b=a.slice(c,c+d);let f=b.toUpperCase();this.folded.push(ma(f==b?b.toLowerCase():f,0));c+=d}this.astral=a.length!=this.chars.length}match(a){if(0==this.pattern.length)return[0];if(a.length<this.pattern.length)return null;
let {chars:b,folded:c,any:d,precise:f,byWord:g}=this;if(1==b.length)return a=ma(a,0),a==b[0]?[0,0,Fa(a)]:a==c[0]?[-200,0,Fa(a)]:null;let k=a.indexOf(this.pattern);if(0==k)return[0,0,this.pattern.length];let l=b.length;var m=0;if(0>k){for(let F=0,B=Math.min(a.length,200);F<B&&m<l;){var n=ma(a,F);if(n==b[m]||n==c[m])d[m++]=F;F+=Fa(n)}if(m<l)return null}n=m=0;let p=!1,q=0,r=-1,t=-1,v=/[a-z]/.test(a),C=!0;for(let F=0,B=Math.min(a.length,200),z=0;F<B&&n<l;){let G=ma(a,F);0>k&&(m<l&&G==b[m]&&(f[m++]=F),
q<l&&(G==b[q]||G==c[q]?(0==q&&(r=F),t=F+1,q++):q=0));let T,M=255>G?48<=G&&57>=G||97<=G&&122>=G?2:65<=G&&90>=G?1:0:(T=Kd(G))!=T.toLowerCase()?1:T!=T.toUpperCase()?2:0;if(!F||1==M&&v||0==z&&0!=M)b[n]==G||c[n]==G&&(p=!0)?g[n++]=F:g.length&&(C=!1);z=M;F+=Fa(G)}return n==l&&0==g[0]&&C?this.result(-100+(p?-200:0),g,a):q==l&&0==r?[-200-a.length,0,t]:-1<k?[-700-a.length,k,k+this.pattern.length]:q==l?[-900-a.length,r,t]:n==l?this.result((p?-200:0)+-800+(C?0:-1100),g,a):2==b.length?null:this.result((d[0]?-700:
0)+-1300,d,a)}result(a,b,c){a=[a-c.length];let d=1;for(let f of b)b=f+(this.astral?Fa(ma(c,f)):1),1<d&&a[d-1]==f?a[d-1]=b:(a[d++]=f,a[d++]=b);return a}},ob=E.define({combine(a){return Wa(a,{activateOnTyping:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(b,c)=>b&&c,closeOnBlur:(b,c)=>b&&c,icons:(b,c)=>b&&c,optionClass:(b,c)=>d=>{var f=b(d);d=c(d);return f?d?f+" "+d:f:d},addToOptions:(b,c)=>b.concat(c)})}}),
im=class{constructor(a,b){this.view=a;this.stateField=b;this.info=null;this.placeInfo={read:()=>this.measureInfo(),write:g=>this.positionInfo(g),key:this};b=a.state.field(b);let {options:c,selected:d}=b.open,f=a.state.facet(ob);this.optionContent=gm(f);this.optionClass=f.optionClass;this.range=ci(c.length,d,f.maxRenderedOptions);this.dom=document.createElement("div");this.dom.className="cm-tooltip-autocomplete";this.dom.addEventListener("mousedown",g=>{for(let k=g.target,l;k&&k!=this.dom;k=k.parentNode)if("LI"==
k.nodeName&&(l=/-(\d+)$/.exec(k.id))&&+l[1]<c.length){ai(a,c[+l[1]]);g.preventDefault();break}});this.list=this.dom.appendChild(this.createListBox(c,b.id,this.range));this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(a){a.state.field(this.stateField)!=a.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let a=this.view.state.field(this.stateField);
var b=a.open;if(b.selected<this.range.from||b.selected>=this.range.to)this.range=ci(b.options.length,b.selected,this.view.state.facet(ob).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(b.options,a.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)});if(this.updateSelectedOption(b.selected)){this.info&&(this.info.remove(),this.info=null);({completion:b}=b.options[b.selected]);let {info:c}=b;c&&(b="string"===
typeof c?document.createTextNode(c):c(b))&&("then"in b?b.then(d=>{d&&this.view.state.field(this.stateField,!1)==a&&this.addInfoPane(d)}).catch(d=>za(this.view.state,d,"completion info")):this.addInfoPane(b))}}addInfoPane(a){let b=this.info=document.createElement("div");b.className="cm-tooltip cm-completionInfo";b.appendChild(a);this.dom.appendChild(b);this.view.requestMeasure(this.placeInfo)}updateSelectedOption(a){let b=null;for(let d=this.list.firstChild,f=this.range.from;d;d=d.nextSibling,f++)f==
a?d.hasAttribute("aria-selected")||(d.setAttribute("aria-selected","true"),b=d):d.hasAttribute("aria-selected")&&d.removeAttribute("aria-selected");if(b){a=this.list;var c=b;let d=a.getBoundingClientRect();c=c.getBoundingClientRect();c.top<d.top?a.scrollTop-=d.top-c.top:c.bottom>d.bottom&&(a.scrollTop+=c.bottom-d.bottom)}return b}measureInfo(){var a=this.dom.querySelector("[aria-selected]");if(!a||!this.info)return null;var b=this.dom.getBoundingClientRect();let c=this.info.getBoundingClientRect();
a=a.getBoundingClientRect();if(a.top>Math.min(innerHeight,b.bottom)-10||a.bottom<Math.max(0,b.top)+10)return null;a=Math.max(0,Math.min(a.top,innerHeight-c.height))-b.top;let d=this.view.textDirection==ca.RTL,f=b.left;b=innerWidth-b.right;d&&f<Math.min(c.width,b)?d=!1:!d&&b<Math.min(c.width,f)&&(d=!0);return{top:a,left:d}}positionInfo(a){this.info&&(this.info.style.top=(a?a.top:-1E6)+"px",a&&(this.info.classList.toggle("cm-completionInfo-left",a.left),this.info.classList.toggle("cm-completionInfo-right",
!a.left)))}createListBox(a,b,c){const d=document.createElement("ul");d.id=b;d.setAttribute("role","listbox");d.setAttribute("aria-expanded","true");d.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let g=c.from;g<c.to;g++){let {completion:k,match:l}=a[g];const m=d.appendChild(document.createElement("li"));m.id=b+"-"+g;m.setAttribute("role","option");var f=this.optionClass(k);f&&(m.className=f);for(let n of this.optionContent)(f=n(k,this.view.state,l))&&m.appendChild(f)}c.from&&
d.classList.add("cm-completionListIncompleteTop");c.to<a.length&&d.classList.add("cm-completionListIncompleteBottom");return d}},Gd=class{constructor(a,b,c,d,f){this.options=a;this.attrs=b;this.tooltip=c;this.timestamp=d;this.selected=f}setSelected(a,b){return a==this.selected||a>=this.options.length?this:new Gd(this.options,fi(b,a),this.tooltip,this.timestamp,a)}static build(a,b,c,d,f){b=jm(a,b);if(!b.length)return null;let g=0;if(d&&d.selected){let k=d.options[d.selected].completion;for(let l=0;l<
b.length;l++)if(b[l].completion==k){g=l;break}}return new Gd(b,fi(c,g),{pos:a.reduce((k,l)=>l.hasResult()?Math.min(k,l.from):k,1E8),create:hm(Ja),above:f.aboveCursor},d?d.timestamp:Date.now(),g)}map(a){return new Gd(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:a.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}},Af=class{constructor(a,b,c){this.active=a;this.id=b;this.open=c}static start(){return new Af(vo,"cm-ac-"+Math.floor(2E6*Math.random()).toString(36),null)}update(a){var {state:b}=
a;let c=b.facet(ob),d=(c.override||b.languageDataAt("autocomplete",jb(b)).map(fm)).map(f=>(this.active.find(g=>g.source==f)||new Ea(f,this.active.some(g=>0!=g.state)?1:0)).update(a,c));d.length==this.active.length&&d.every((f,g)=>f==this.active[g])&&(d=this.active);b=a.selection||d.some(f=>f.hasResult()&&a.changes.touchesRange(f.from,f.to))||!mm(d,this.active)?Gd.build(d,b,this.id,this.open,c):this.open&&a.docChanged?this.open.map(a.changes):this.open;!b&&d.every(f=>1!=f.state)&&d.some(f=>f.hasResult())&&
(d=d.map(f=>f.hasResult()?new Ea(f.source,0):f));for(let f of a.effects)f.is(hi)&&(b=b&&b.setSelected(f.value,this.id));return d==this.active&&b==this.open?this:new Af(d,this.id,b)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:wo}},wo={"aria-autocomplete":"list"},vo=[],Ea=class{constructor(a,b,c=-1){this.source=a;this.state=b;this.explicitPos=c}hasResult(){return!1}update(a,b){let c=Ee(a),d=this;c?d=d.handleUserEvent(a,c,b):a.docChanged?d=d.handleChange(a):
a.selection&&0!=d.state&&(d=new Ea(d.source,0));for(let f of a.effects)if(f.is(Bf))d=new Ea(d.source,1,f.value?jb(a.state):-1);else if(f.is(Hd))d=new Ea(d.source,0);else if(f.is(ik))for(let g of f.value)g.source==d.source&&(d=g);return d}handleUserEvent(a,b,c){return"delete"!=b&&c.activateOnTyping?new Ea(this.source,1):this.map(a.changes)}handleChange(a){return a.changes.touchesRange(jb(a.startState))?new Ea(this.source,0):this.map(a.changes)}map(a){return a.empty||0>this.explicitPos?this:new Ea(this.source,
this.state,a.mapPos(this.explicitPos))}},Id=class extends Ea{constructor(a,b,c,d,f){super(a,2,b);this.result=c;this.from=d;this.to=f}hasResult(){return!0}handleUserEvent(a,b,c){var d;let f=a.changes.mapPos(this.from),g=a.changes.mapPos(this.to,1),k=jb(a.state);if((0>this.explicitPos?k<=f:k<this.from)||k>g||"delete"==b&&jb(a.startState)==this.from)return new Ea(this.source,"input"==b&&c.activateOnTyping?1:0);b=0>this.explicitPos?-1:a.changes.mapPos(this.explicitPos);let l;c=this.result.validFor;var m=
a.state;if(c){var n=m.sliceDoc(f,g);c="function"==typeof c?c(n,f,g,m):$h(c,!0).test(n)}else c=!1;return c?new Id(this.source,b,this.result,f,g):this.result.update&&(l=this.result.update(this.result,f,g,new hk(a.state,k,0<=b)))?new Id(this.source,b,l,l.from,null!==(d=l.to)&&void 0!==d?d:jb(a.state)):new Ea(this.source,1,b)}handleChange(a){return a.changes.touchesRange(this.from,this.to)?new Ea(this.source,0):this.map(a.changes)}map(a){return a.empty?this:new Id(this.source,0>this.explicitPos?-1:a.mapPos(this.explicitPos),
this.result,a.mapPos(this.from),a.mapPos(this.to,1))}},Bf=K.define(),Hd=K.define(),ik=K.define({map(a,b){return a.map(c=>c.map(b))}}),hi=K.define(),Ja=na.define({create(){return Af.start()},update(a,b){return a.update(b)},provide:a=>[jf.from(a,b=>b.tooltip),I.contentAttributes.from(a,b=>b.attrs)]}),xo=class{constructor(a,b){this.active=a;this.context=b;this.time=Date.now();this.updates=[];this.done=void 0}},yo=fa.fromClass(class{constructor(a){this.view=a;this.debounceUpdate=-1;this.running=[];this.debounceAccept=
-1;this.composing=0;for(let b of a.state.field(Ja).active)1==b.state&&this.startQuery(b)}update(a){let b=a.state.field(Ja);if(a.selectionSet||a.docChanged||a.startState.field(Ja)!=b){var c=a.transactions.some(d=>(d.selection||d.docChanged)&&!Ee(d));for(let d=0;d<this.running.length;d++){let f=this.running[d];if(c||50<f.updates.length+a.transactions.length&&1E3<Date.now()-f.time){for(let g of f.context.abortListeners)try{g()}catch(k){za(this.view.state,k)}f.context.abortListeners=null;this.running.splice(d--,
1)}else f.updates.push(...a.transactions)}-1<this.debounceUpdate&&clearTimeout(this.debounceUpdate);this.debounceUpdate=b.active.some(d=>1==d.state&&!this.running.some(f=>f.active.source==d.source))?setTimeout(()=>this.startUpdate(),50):-1;if(0!=this.composing)for(let d of a.transactions)"input"==Ee(d)?this.composing=2:2==this.composing&&d.selection&&(this.composing=3)}}startUpdate(){this.debounceUpdate=-1;var {state:a}=this.view;a=a.field(Ja);for(let b of a.active)1!=b.state||this.running.some(c=>
c.active.source==b.source)||this.startQuery(b)}startQuery(a){var {state:b}=this.view;let c=jb(b);b=new hk(b,c,a.explicitPos==c);let d=new xo(a,b);this.running.push(d);Promise.resolve(a.source(b)).then(f=>{d.context.aborted||(d.done=f||null,this.scheduleAccept())},f=>{this.view.dispatch({effects:Hd.of(null)});za(this.view.state,f)})}scheduleAccept(){this.running.every(a=>void 0!==a.done)?this.accept():0>this.debounceAccept&&(this.debounceAccept=setTimeout(()=>this.accept(),50))}accept(){var a;-1<this.debounceAccept&&
clearTimeout(this.debounceAccept);this.debounceAccept=-1;let b=[],c=this.view.state.facet(ob);for(let f=0;f<this.running.length;f++){let g=this.running[f];if(void 0!==g.done){this.running.splice(f--,1);if(g.done){var d=new Id(g.active.source,g.active.explicitPos,g.done,g.done.from,null!==(a=g.done.to)&&void 0!==a?a:jb(g.updates.length?g.updates[0].startState:this.view.state));for(let k of g.updates)d=d.update(k,c);if(d.hasResult()){b.push(d);continue}}if((d=this.view.state.field(Ja).active.find(k=>
k.source==g.active.source))&&1==d.state)if(null==g.done){d=new Ea(g.active.source,0);for(let k of g.updates)d=d.update(k,c);1!=d.state&&b.push(d)}else this.startQuery(d)}}b.length&&this.view.dispatch({effects:ik.of(b)})}},{eventHandlers:{blur(){let a=this.view.state.field(Ja,!1);a&&a.tooltip&&this.view.state.facet(ob).closeOnBlur&&this.view.dispatch({effects:Hd.of(null)})},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:Bf.of(!1)}),
20);this.composing=0}}}),zo=I.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",
color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\u00b7\u00b7\u00b7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},
".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25cb'"}},
".cm-completionIcon-interface":{"&:after":{content:"'\u25cc'"}},".cm-completionIcon-variable":{"&:after":{content:"'\ud835\udc65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\ud835\udc36'"}},".cm-completionIcon-type":{"&:after":{content:"'\ud835\udc61'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222a'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25a1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\ud83d\udd11\ufe0e'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25a2'"}},
".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Ac={brackets:["(","[","{","'",'"'],before:")]}:;>"},ub=K.define({map(a,b){a=b.mapPos(a,-1,xa.TrackAfter);return null==a?void 0:a}}),Fe=K.define({map(a,b){return b.mapPos(a)}}),Cf=new class extends xb{};Cf.startSide=1;Cf.endSide=-1;var ki=na.define({create(){return W.empty},update(a,b){if(b.selection){let c=b.state.doc.lineAt(b.selection.main.head).from,d=b.startState.doc.lineAt(b.startState.selection.main.head).from;
c!=b.changes.mapPos(d,-1)&&(a=W.empty)}a=a.map(b.changes);for(let c of b.effects)c.is(ub)?a=a.update({add:[Cf.range(c.value,c.value+1)]}):c.is(Fe)&&(a=a.update({filter:d=>d!=c.value}));return a}}),Ao="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),Bo=I.inputHandler.of((a,b,c,d)=>{if((Ao?a.composing:a.compositionStarted)||a.state.readOnly)return!1;var f=a.state.selection.main;if(2<d.length||2==d.length&&1==Fa(ma(d,0))||b!=f.from||c!=f.to)return!1;a:{b=a.state;c=b.languageDataAt("closeBrackets",
b.selection.main.head)[0]||Ac;f=c.brackets||Ac.brackets;for(let g of f){let k=ii(ma(g,0));if(d==g){d=k==g?pm(b,g,-1<f.indexOf(g+g+g)):nm(b,g,k,c.before||Ac.before);break a}if(d==k&&ji(b,b.selection.main.from)){d=om(b,g,k);break a}}d=null}if(!d)return!1;a.dispatch(d);return!0}),jk=[{key:"Ctrl-Space",run:a=>{if(!a.state.field(Ja,!1))return!1;a.dispatch({effects:Bf.of(!0)});return!0}},{key:"Escape",run:a=>{let b=a.state.field(Ja,!1);if(!b||!b.active.some(c=>0!=c.state))return!1;a.dispatch({effects:Hd.of(null)});
return!0}},{key:"ArrowDown",run:gd(!0)},{key:"ArrowUp",run:gd(!1)},{key:"PageDown",run:gd(!0,"page")},{key:"PageUp",run:gd(!1,"page")},{key:"Enter",run:a=>{let b=a.state.field(Ja,!1);if(a.state.readOnly||!b||!b.open||75>Date.now()-b.open.timestamp)return!1;ai(a,b.open.options[b.open.selected]);return!0}}],Co=lc.highest(je.computeN([ob],a=>a.facet(ob).defaultKeymap?[jk]:[])),qm=class{constructor(a,b,c){this.from=a;this.to=b;this.diagnostic=c}},Ub=class{constructor(a,b,c){this.diagnostics=a;this.panel=
b;this.selected=c}static init(a,b,c){let d=c.facet(Qb).markerFilter;d&&(a=d(a));a=H.set(a.map(f=>f.from==f.to||f.from==f.to-1&&c.doc.lineAt(f.from).to==f.from?H.widget({widget:new Do(f),diagnostic:f}).range(f.from):H.mark({attributes:{class:"cm-lintRange cm-lintRange-"+f.severity},diagnostic:f}).range(f.from,f.to)),!0);return new Ub(a,b,Pb(a))}},Ge=K.define(),Df=K.define(),kk=K.define(),Ba=na.define({create(){return new Ub(H.none,null,null)},update(a,b){if(b.docChanged){let d=a.diagnostics.map(b.changes);
var c=null;a.selected&&(c=b.changes.mapPos(a.selected.from,1),c=Pb(d,a.selected.diagnostic,c)||Pb(d,null,c));a=new Ub(d,a.panel,c)}for(let d of b.effects)d.is(Ge)?a=Ub.init(d.value,a.panel,b.state):d.is(Df)?a=new Ub(a.diagnostics,d.value?Ef.open:null,a.selected):d.is(kk)&&(a=new Ub(a.diagnostics,a.panel,d.value));return a},provide:a=>[tc.from(a,b=>b.panel),I.decorations.from(a,b=>b.diagnostics)]}),sm=H.mark({class:"cm-lintRange cm-lintRange-active"}),lk=a=>{let b=a.state.field(Ba,!1);if(!b||!b.panel)return!1;
a.dispatch({effects:Df.of(!1)});return!0},Eo=fa.fromClass(class{constructor(a){this.view=a;this.timeout=-1;this.set=!0;({delay:a}=a.state.facet(Qb));this.lintTime=Date.now()+a;this.run=this.run.bind(this);this.timeout=setTimeout(this.run,a)}run(){var a=Date.now();if(a<this.lintTime-10)setTimeout(this.run,this.lintTime-a);else{this.set=!1;let {state:b}=this.view;({sources:a}=b.facet(Qb));Promise.all(a.map(c=>Promise.resolve(c(this.view)))).then(c=>{c=c.reduce((d,f)=>d.concat(f));this.view.state.doc==
b.doc&&this.view.dispatch({effects:mi(this.view.state,[Ge.of(c)])})},c=>{za(this.view.state,c)})}}update(a){let b=a.state.facet(Qb);if(a.docChanged||b!=a.startState.facet(Qb))this.lintTime=Date.now()+b.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,b.delay))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Qb=E.define({combine(a){return Object.assign({sources:a.map(b=>b.source)},Wa(a.map(b=>b.config),{delay:750,markerFilter:null,tooltipFilter:null}))},
enables:Eo}),Do=class extends kb{constructor(a){super();this.diagnostic=a}eq(a){return a.diagnostic==this.diagnostic}toDOM(){return Y("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}},mk=class{constructor(a,b){this.diagnostic=b;this.id="item_"+Math.floor(4294967295*Math.random()).toString(16);this.dom=ni(a,b,!0);this.dom.id=this.id;this.dom.setAttribute("role","option")}},Ef=class{constructor(a){this.view=a;this.items=[];this.list=Y("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),
onkeydown:b=>{if(27==b.keyCode)lk(this.view),this.view.focus();else if(38==b.keyCode||33==b.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==b.keyCode||34==b.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==b.keyCode)this.moveSelection(0);else if(35==b.keyCode)this.moveSelection(this.items.length-1);else if(13==b.keyCode)this.view.focus();else if(65<=b.keyCode&&90>=b.keyCode&&0<=this.selectedIndex){let {diagnostic:c}=
this.items[this.selectedIndex],d=oi(c.actions);for(let f=0;f<d.length;f++)if(d[f].toUpperCase().charCodeAt(0)==b.keyCode){let g=Pb(this.view.state.field(Ba).diagnostics,c);g&&c.actions[f].apply(a,g.from,g.to)}}else return;b.preventDefault()},onclick:b=>{for(let c=0;c<this.items.length;c++)this.items[c].dom.contains(b.target)&&this.moveSelection(c)}});this.dom=Y("div",{class:"cm-panel-lint"},this.list,Y("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>lk(this.view)},
"\u00d7"));this.update()}get selectedIndex(){let a=this.view.state.field(Ba).selected;if(!a)return-1;for(let b=0;b<this.items.length;b++)if(this.items[b].diagnostic==a.diagnostic)return b;return-1}update(){let {diagnostics:a,selected:b}=this.view.state.field(Ba),c=0,d=!1,f=null;for(a.between(0,this.view.state.doc.length,(g,k,{spec:l})=>{g=-1;for(k=c;k<this.items.length;k++)if(this.items[k].diagnostic==l.diagnostic){g=k;break}0>g?(l=new mk(this.view,l.diagnostic),this.items.splice(c,0,l),d=!0):(l=
this.items[g],g>c&&(this.items.splice(c,g-c),d=!0));b&&l.diagnostic==b.diagnostic?l.dom.hasAttribute("aria-selected")||(l.dom.setAttribute("aria-selected","true"),f=l):l.dom.hasAttribute("aria-selected")&&l.dom.removeAttribute("aria-selected");c++});c<this.items.length&&!(1==this.items.length&&0>this.items[0].diagnostic.from);)d=!0,this.items.pop();0==this.items.length&&(this.items.push(new mk(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),d=!0);f?(this.list.setAttribute("aria-activedescendant",
f.id),this.view.requestMeasure({key:this,read:()=>({sel:f.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:g,panel:k})=>{g.top<k.top?this.list.scrollTop-=k.top-g.top:g.bottom>k.bottom&&(this.list.scrollTop+=g.bottom-k.bottom)}})):0>this.selectedIndex&&this.list.removeAttribute("aria-activedescendant");d&&this.sync()}sync(){function a(){let c=b;b=c.nextSibling;c.remove()}let b=this.list.firstChild;for(let c of this.items)if(c.dom.parentNode==this.list){for(;b!=c.dom;)a();
b=c.dom.nextSibling}else this.list.insertBefore(c.dom,b);for(;b;)a()}moveSelection(a){if(!(0>this.selectedIndex)){var b=this.view.state.field(Ba);(a=Pb(b.diagnostics,this.items[a].diagnostic))&&this.view.dispatch({selection:{anchor:a.from,head:a.to},scrollIntoView:!0,effects:kk.of(a)})}}static open(a){return new Ef(a)}},um=I.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},
".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:He("#d11")},".cm-lintRange-warning":{backgroundImage:He("orange")},".cm-lintRange-info":{backgroundImage:He("#999")},
".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto",
"& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Fo=[function(a={}){return[Hb.of(a),fh(),vn]}(),xn,function(a={}){return[Mc.of(a),ol()]}(),function(a={}){return[Gh,
yj.of(a),I.domEventHandlers({beforeinput(b,c){let d="historyUndo"==b.inputType?zj:"historyRedo"==b.inputType?Aj:null;if(!d)return!1;b.preventDefault();return d(c)}})]}(),function(a={}){let b=Object.assign(Object.assign({},Jn),a),c=new sf(b,!0),d=new sf(b,!1),f=fa.fromClass(class{constructor(k){this.from=k.viewport.from;this.markers=this.buildMarkers(k)}update(k){if(k.docChanged||k.viewportChanged||k.startState.facet(hb)!=k.state.facet(hb)||k.startState.field(tb,!1)!=k.state.field(tb,!1)||ra(k.startState)!=
ra(k.state))this.markers=this.buildMarkers(k.view)}buildMarkers(k){let l=new yb;for(let m of k.viewportLineBlocks){let n=Wc(k.state,m.from,m.to)?d:Vc(k.state,m.from,m.to)?c:null;n&&l.add(m.from,m.from,n)}return l.finish()}}),{domEventHandlers:g}=b;return[f,zl({class:"cm-foldGutter",markers(k){var l;return(null===(l=k.plugin(f))||void 0===l?void 0:l.markers)||W.empty},initialSpacer(){return new sf(b,!1)},domEventHandlers:Object.assign(Object.assign({},g),{click:(k,l,m)=>g.click&&g.click(k,l,m)?!0:
(m=Wc(k.state,l.from,l.to))?(k.dispatch({effects:xc.of(m)}),!0):(l=Vc(k.state,l.from,l.to))?(k.dispatch({effects:Cd.of(l)}),!0):!1})}),yh()]}(),function(a={}){return[rc.of(a),hn,jn]}(),[sc,kn],R.allowMultipleSelections.of(!0),function(){return R.transactionFilter.of(a=>{if(!a.docChanged||!a.isUserEvent("input.type")&&!a.isUserEvent("input.complete"))return a;var b=a.startState.languageDataAt("indentOnInput",a.startState.selection.main.head);if(!b.length)return a;var c=a.newDoc,{head:d}=a.newSelection.main,
f=c.lineAt(d);if(d>f.from+200)return a;let g=c.sliceString(f.from,d);if(!b.some(l=>l.test(g)))return a;({state:b}=a);c=-1;d=[];for(let {head:l}of b.selection.ranges){f=b.doc.lineAt(l);if(f.from==c)continue;c=f.from;var k=qe(b,f.from);if(null==k)continue;let m=/^\s*/.exec(f.text)[0];k=gc(b,k);m!=k&&d.push({from:f.from,to:f.from+m.length,insert:k})}return d.length?[a,{changes:d,sequential:!0}]:a})}(),function(a,b){let c=[Kn],d;a instanceof tf&&(a.module&&c.push(I.styleModule.of(a.module)),d=a.themeType);
(null===b||void 0===b?0:b.fallback)?c.push(Bh.of(a)):d?c.push(se.computeN([I.darkTheme],f=>f.facet(I.darkTheme)==("dark"==d)?[a]:[])):c.push(se.of(a));return c}(Ln,{fallback:!0}),function(a={}){return[xj.of(a),Nn]}(),[Bo,ki],function(a={}){return[Ja,ob.of(a),yo,Co,zo]}(),function(a){let b=(null===a||void 0===a?void 0:a.eventFilter)||(c=>c.altKey&&0==c.button);return I.mouseSelectionStyle.of((c,d)=>b(d)?tl(c,d):null)}(),function(a={}){let [b,c]=pn[a.key||"Alt"],d=fa.fromClass(class{constructor(f){this.view=
f;this.isDown=!1}set(f){this.isDown!=f&&(this.isDown=f,this.view.update([]))}},{eventHandlers:{keydown(f){this.set(f.keyCode==b||c(f))},keyup(f){f.keyCode!=b&&c(f)||this.set(!1)}}});return[d,I.contentAttributes.of(f=>{var g;return(null===(g=f.plugin(d))||void 0===g?0:g.isDown)?qn:null})]}(),on,function(a){let b=[io,ho];a&&b.push(dk.of(a));return b}(),je.of([{key:"Backspace",run:({state:a,dispatch:b})=>{if(a.readOnly)return!1;let c=(a.languageDataAt("closeBrackets",a.selection.main.head)[0]||Ac).brackets||
Ac.brackets,d=null,f=a.changeByRange(g=>{if(g.empty){var k=g.head;k=a.doc.sliceString(k-2,k);k=Fa(ma(k,0))==k.length?k:k.slice(1);for(let l of c)if(l==k&&hd(a.doc,g.head)==ii(ma(l,0)))return{changes:{from:g.head-l.length,to:g.head+l.length},range:u.cursor(g.head-l.length),userEvent:"delete.backward"}}return{range:d=g}});d||b(a.update(f,{scrollIntoView:!0}));return!d}},...bo,...to,...Yn,{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:a=>{for(let b of wh(a)){let c=Vc(a.state,b.from,b.to);if(c)return a.dispatch({effects:xh(a.state,
[Cd.of(c),zh(a,c)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:a=>{if(!a.state.field(tb,!1))return!1;let b=[];for(let c of wh(a)){let d=Wc(a.state,c.from,c.to);d&&b.push(xc.of(d),zh(a,d,!1))}b.length&&a.dispatch({effects:b});return 0<b.length}},{key:"Ctrl-Alt-[",run:a=>{let {state:b}=a,c=[];for(var d=0;d<b.doc.length;){d=a.lineBlockAt(d);let f=Vc(b,d.from,d.to);f&&c.push(Cd.of(f));d=(f?a.lineBlockAt(f.to):d).to+1}c.length&&a.dispatch({effects:xh(a.state,c)});return!!c.length}},{key:"Ctrl-Alt-]",
run:a=>{let b=a.state.field(tb,!1);if(!b||!b.size)return!1;let c=[];b.between(0,a.state.doc.length,(d,f)=>{c.push(xc.of({from:d,to:f}))});a.dispatch({effects:c});return!0}},...jk,{key:"Mod-Shift-m",run:a=>{let b=a.state.field(Ba,!1);b&&b.panel||a.dispatch({effects:mi(a.state,[Df.of(!0)])});(a=ec(a,Ef.open))&&a.dom.querySelector(".cm-panel-lint ul").focus();return!0}},{key:"F8",run:a=>{let b=a.state.field(Ba,!1);if(!b)return!1;let c=a.state.selection.main,d=b.diagnostics.iter(c.to+1);if(!d.value&&
(d=b.diagnostics.iter(0),!d.value||d.from==c.from&&d.to==c.to))return!1;a.dispatch({selection:{anchor:d.from,head:d.to},scrollIntoView:!0});return!0}}])],Jd=Jf("code-module");Jd.render(a=>{var b=a.getAttribute("src");console.log(b);({file:b}=Jd.read());if(!a.view){const c={extensions:[Fo,I.updateListener.of(xm(a,Jd,{}))]};b=R.create({...c,doc:b});a.view=new I({parent:a,state:b})}});Jd.style("\n  & {\n\t\tdisplay: block;\n    max-height: 60vh;\n    overflow: scroll;\n  }\n")})();
